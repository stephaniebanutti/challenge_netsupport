"use strict";function ownKeys(o,e){var a=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),a.push.apply(a,t)}return a}function _objectSpread(o){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(o,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(a,e))})}return o}function _defineProperty(e,o,a){return o in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a,e}function _slicedToArray(e,o){return _arrayWithHoles(e)||_iterableToArrayLimit(e,o)||_unsupportedIterableToArray(e,o)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,o){if(e){if("string"==typeof e)return _arrayLikeToArray(e,o);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,o):void 0}}function _arrayLikeToArray(e,o){(null==o||o>e.length)&&(o=e.length);for(var a=0,t=new Array(o);a<o;a++)t[a]=e[a];return t}function _iterableToArrayLimit(e,o){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],t=!0,r=!1,i=void 0;try{for(var n,l=e[Symbol.iterator]();!(t=(n=l.next()).done)&&(a.push(n.value),!o||a.length!==o);t=!0);}catch(e){r=!0,i=e}finally{try{t||null==l.return||l.return()}finally{if(r)throw i}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var Tawk_API=Tawk_API||{},Tawk_LoadStart=new Date,app=angular.module("portal",["ngRoute","angular.filter","ngFileUpload","multi-select","ngSanitize","ui.select","daterangepicker","ng.deviceDetector"]);app.config(["$routeProvider","$locationProvider",function(e,o){e.when("/avaliacao",{templateUrl:"/views/avaliacao/avaliacao.html",controller:"avaliacao"}),e.when("/banco",{templateUrl:"/views/banco/lista.html",controller:"banco"}),e.when("/banco/adiciona",{templateUrl:"/views/banco/form.html",controller:"banco"}),e.when("/banco/:id_banco",{templateUrl:"/views/banco/form.html",controller:"banco"}),e.when("/banco_ns",{templateUrl:"/views/banco_ns/lista.html",controller:"banco_ns"}),e.when("/banco_ns/adiciona",{templateUrl:"/views/banco_ns/form.html",controller:"banco_ns"}),e.when("/banco_ns/:id_banco",{templateUrl:"/views/banco_ns/form.html",controller:"banco_ns"}),e.when("/base_custo",{templateUrl:"/views/base_custo/lista.html",controller:"base_custo"}),e.when("/base_custo/adiciona",{templateUrl:"/views/base_custo/form.html",controller:"base_custo"}),e.when("/base_custo/:id_base_custo",{templateUrl:"/views/base_custo/form.html",controller:"base_custo"}),e.when("/candidato_supporter/candidata",{templateUrl:"/views/candidato_doutor/candidata.html",controller:"candidato_doutor"}),e.when("/candidato_supporter/token/:token",{templateUrl:"/views/candidato_doutor/cadastra.html",controller:"candidato_doutor"}),e.when("/candidato_supporter",{templateUrl:"/views/candidato_doutor/lista.html",controller:"candidato_doutor"}),e.when("/candidato_supporter/adiciona",{templateUrl:"/views/candidato_doutor/adiciona.html",controller:"candidato_doutor"}),e.when("/cliente/meus_dados",{templateUrl:"/views/cliente/form_detalha_cliente.html",controller:"cliente"}),e.when("/cliente/integracao",{templateUrl:"/views/cliente_integracao/lista.html",controller:"cliente_integracao"}),e.when("/cliente/integracao/adiciona",{templateUrl:"/views/cliente_integracao/form.html",controller:"cliente_integracao"}),e.when("/cliente/integracao/verifica_autorizacao",{templateUrl:"/views/cliente_integracao/form_autorizacao.html",controller:"cliente_integracao"}),e.when("/cliente/integracao/:id_integracao",{templateUrl:"/views/cliente_integracao/form.html",controller:"cliente_integracao"}),e.when("/cliente/cidade_cliente",{templateUrl:"/views/cliente/cidade_cliente.html",controller:"cliente"}),e.when("/cidade_brasil",{templateUrl:"/views/cidade_brasil/lista.html",controller:"cidade_brasil"}),e.when("/cidade_brasil/adiciona",{templateUrl:"/views/cidade_brasil/form.html",controller:"cidade_brasil"}),e.when("/cidade_brasil/:id_cidade",{templateUrl:"/views/cidade_brasil/form.html",controller:"cidade_brasil"}),e.when("/cliente",{templateUrl:"/views/cliente/lista.html",controller:"cliente"}),e.when("/cliente/adiciona/:tipo_pessoa",{templateUrl:"/views/cliente/form_cliente.html",controller:"cliente"}),e.when("/cliente/job",{templateUrl:"/views/cliente/job_lista.html",controller:"job"}),e.when("/cliente/job/adiciona",{templateUrl:"/views/cliente/job_form.html",controller:"job"}),e.when("/cliente/job/detalha/:id",{templateUrl:"/views/cliente/job_detalha.html",controller:"job"}),e.when("/cliente/job/acompanhamento_atendimentos",{templateUrl:"/views/cliente/atendimento_lista.html",controller:"job"}),e.when("/cliente/:id_cliente",{templateUrl:"/views/cliente/form_cliente.html",controller:"cliente"}),e.when("/cliente/:id_cliente/usuario/adiciona",{templateUrl:"/views/cliente/form_usuario.html",controller:"cliente"}),e.when("/cliente/:id_cliente/usuario/:id_usuario",{templateUrl:"/views/cliente/form_usuario.html",controller:"cliente"}),e.when("/cliente/:id_cliente/operacao/adiciona",{templateUrl:"/views/cliente/form_operacao.html",controller:"cliente"}),e.when("/cliente/:id_cliente/operacao/:id_operacao",{templateUrl:"/views/cliente/form_operacao.html",controller:"cliente"}),e.when("/cliente_cliente",{templateUrl:"/views/cliente_cliente/lista.html",controller:"cliente_cliente"}),e.when("/cliente_cliente/adiciona",{templateUrl:"/views/cliente_cliente/form.html",controller:"cliente_cliente"}),e.when("/cliente_cliente/:id_cliente_cliente",{templateUrl:"/views/cliente_cliente/form.html",controller:"cliente_cliente"}),e.when("/supporter/dashboard",{templateUrl:"/views/doutor/dashboard.html",controller:"dashboard"}),e.when("/supporter/slack",{templateUrl:"/views/doutor/slack.html",controller:"doutor"}),e.when("/supporter/competencia",{templateUrl:"/views/doutor/competencia.html",controller:"doutor"}),e.when("/supporter/dados_pessoais",{templateUrl:"/views/doutor/dados_pessoais.html",controller:"doutor"}),e.when("/supporter/termo",{templateUrl:"/views/doutor/termo.html",controller:"doutor"}),e.when("/contrato",{templateUrl:"/views/doutor/termo.html",controller:"doutor"}),e.when("/supporter/regras",{templateUrl:"/views/doutor/regras_conduta.html",controller:"doutor"}),e.when("/supporter/candidato_job",{templateUrl:"/views/doutor/candidato_job.html",controller:"doutor"}),e.when("/supporter/candidato_job/token/:token",{templateUrl:"/views/doutor/form_candidato_job.html",controller:"doutor"}),e.when("/supporter/upload",{templateUrl:"/views/doutor/upload.html",controller:"doutor"}),e.when("/supporter/minhas_pendencias",{templateUrl:"/views/doutor/lista_pendencia_doutor.html",controller:"doutor"}),e.when("/supporter/cidade_atendimento",{templateUrl:"/views/doutor/cidade_doutor.html",controller:"doutor"}),e.when("/supporter/extrato/pagamento",{templateUrl:"/views/doutor/extrato_pagamento.html",controller:"relatorio"}),e.when("/supporter",{templateUrl:"/views/doutor/lista.html",controller:"doutor"}),e.when("/supporter/adiciona",{templateUrl:"/views/doutor/form.html",controller:"doutor"}),e.when("/supporter/pendencia",{templateUrl:"/views/doutor/lista_pendencia.html",controller:"doutor"}),e.when("/supporter/validacao",{templateUrl:"/views/doutor/lista_pendencia_validacao.html",controller:"doutor"}),e.when("/supporter/job",{templateUrl:"/views/doutor/job_lista.html",controller:"job"}),e.when("/supporter/job/lista/status_simplificado/:status_simplificado",{templateUrl:"/views/doutor/job_lista.html",controller:"job"}),e.when("/supporter/job/detalha/:id",{templateUrl:"/views/doutor/job_detalha.html",controller:"job"}),e.when("/supporter/desativa_conta",{templateUrl:"/views/doutor/desativa_conta.html",controller:"doutor"}),e.when("/supporter/:id_doutor",{templateUrl:"/views/doutor/form.html",controller:"doutor"}),e.when("/supporter/pendencia/adiciona",{templateUrl:"/views/doutor/form_pendencia.html",controller:"doutor"}),e.when("/supporter/pendencia/:id_pendencia",{templateUrl:"/views/doutor/form_pendencia.html",controller:"doutor"}),e.when("/supporter/:id_doutor/validacao",{templateUrl:"/views/doutor/detalha_doutor_pendencia.html",controller:"doutor"}),e.when("/especialidade",{templateUrl:"/views/especialidade/lista.html",controller:"especialidade"}),e.when("/especialidade/adiciona",{templateUrl:"/views/especialidade/form_especialidade.html",controller:"especialidade"}),e.when("/especialidade/:id_especialidade",{templateUrl:"/views/especialidade/form_especialidade.html",controller:"especialidade"}),e.when("/especialidade/area/adiciona",{templateUrl:"/views/especialidade/form_area.html",controller:"especialidade"}),e.when("/especialidade/area/:id_area",{templateUrl:"/views/especialidade/form_area.html",controller:"especialidade"}),e.when("/especialidade/competencia/adiciona",{templateUrl:"/views/especialidade/form_competencia.html",controller:"especialidade"}),e.when("/especialidade/competencia/:id_competencia",{templateUrl:"/views/especialidade/form_competencia.html",controller:"especialidade"}),e.when("/ferramenta/envia_email",{templateUrl:"/views/ferramenta/envia_email.html",controller:"ferramenta"}),e.when("/financeiro",{templateUrl:"/views/financeiro/dashboard.html",controller:"financeiro"}),e.when("/financeiro/importacao/retorno",{templateUrl:"/views/importa_retorno/lista.html",controller:"importa_retorno"}),e.when("/financeiro/importacao/retorno/pagamento",{templateUrl:"/views/importa_retorno/form_pagamento.html",controller:"importa_retorno"}),e.when("/financeiro/importacao/retorno/faturamento",{templateUrl:"/views/importa_retorno/form_faturamento.html",controller:"importa_retorno"}),e.when("/financeiro/extrato/faturamento",{templateUrl:"/views/financeiro/extrato_faturamento.html",controller:"financeiro"}),e.when("/financeiro/extrato/validacao_fechamento",{templateUrl:"/views/financeiro/extrato_validacao_fechamento.html",controller:"relatorio"}),e.when("/financeiro/extrato/validacao_faturamento",{templateUrl:"/views/relatorio/financeiro_extrato_validacao_faturamento.html",controller:"relatorio"}),e.when("/financeiro/extrato/analise_receita",{templateUrl:"/views/financeiro/extrato_analise_receita.html",controller:"financeiro"}),e.when("/financeiro/extrato/custos_ciclo",{templateUrl:"/views/financeiro/extrato_custos_ciclo.html",controller:"relatorio"}),e.when("/flag",{templateUrl:"/views/flag/lista.html",controller:"flag"}),e.when("/flag/adiciona",{templateUrl:"/views/flag/form.html",controller:"flag"}),e.when("/flag/:id_flag",{templateUrl:"/views/flag/form.html",controller:"flag"}),e.when("/funcionalidade",{templateUrl:"/views/funcionalidade/lista.html",controller:"funcionalidade"}),e.when("/funcionalidade/adiciona",{templateUrl:"/views/funcionalidade/form.html",controller:"funcionalidade"}),e.when("/funcionalidade/:id_funcionalidade",{templateUrl:"/views/funcionalidade/form.html",controller:"funcionalidade"}),e.when("/funcionario",{templateUrl:"/views/funcionario/lista.html",controller:"funcionario"}),e.when("/funcionario/adiciona",{templateUrl:"/views/funcionario/form.html",controller:"funcionario"}),e.when("/funcionario/:id_funcionario",{templateUrl:"/views/funcionario/form.html",controller:"funcionario"}),e.when("/cursos",{templateUrl:"/views/cursos/lista_cursos.html",controller:"cursos"}),e.when("/cursos/:id_curso",{templateUrl:"/views/cursos/curso.html",controller:"cursos"}),e.when("/grupo",{templateUrl:"/views/grupo/lista.html",controller:"grupo"}),e.when("/grupo/adiciona",{templateUrl:"/views/grupo/form.html",controller:"grupo"}),e.when("/grupo/:id_grupo",{templateUrl:"/views/grupo/form.html",controller:"grupo"}),e.when("/job",{templateUrl:"/views/job/lista.html",controller:"job"}),e.when("/job/lista/meus/:meus",{templateUrl:"/views/job/lista.html",controller:"job"}),e.when("/job/lista/meus/:meus/status_simplificado/:status_simplificado",{templateUrl:"/views/job/lista.html",controller:"job"}),e.when("/job/lista/meus/:meus/status_simplificado/:status_simplificado/sla_vencido/:sla_vencido",{templateUrl:"/views/job/lista.html",controller:"job"}),e.when("/job/adiciona",{templateUrl:"/views/job/form.html",controller:"job"}),e.when("/job/altera/:id",{templateUrl:"/views/job/form.html",controller:"job"}),e.when("/job/detalha/:id",{templateUrl:"/views/job/detalha.html",controller:"job"}),e.when("/loja/agendamento",{templateUrl:"/views/loja/agendamento.html",controller:"loja"}),e.when("/operacao/detalha",{templateUrl:"/views/operacao/detalha.html",controller:""}),e.when("/orientacao",{templateUrl:"/views/orientacao/lista.html",controller:"orientacao"}),e.when("/orientacao/adiciona",{templateUrl:"/views/orientacao/form.html",controller:"orientacao"}),e.when("/orientacao/:id_orientacao",{templateUrl:"/views/orientacao/form.html",controller:"orientacao"}),e.when("/orientacao_padrao",{templateUrl:"/views/orientacao_padrao/form.html",controller:"orientacao_padrao"}),e.when("/orientacao_padrao/:forma_atendimento",{templateUrl:"/views/orientacao_padrao/detalha.html",controller:"orientacao_padrao"}),e.when("/permissao/detalha/:id_grupo",{templateUrl:"/views/permissao/detalha.html",controller:"permissao"}),e.when("/pessoa",{templateUrl:"/views/pessoa/lista.html",controller:"pessoa"}),e.when("/pessoa/adiciona",{templateUrl:"/views/pessoa/form.html",controller:"pessoa"}),e.when("/pessoa/detalha/:id",{templateUrl:"/views/pessoa/form.html",controller:"pessoa"}),e.when("/tipo_servico",{templateUrl:"/views/tipo_servico/lista.html",controller:"tipo_servico"}),e.when("/tipo_servico/adiciona",{templateUrl:"/views/tipo_servico/form.html",controller:"tipo_servico"}),e.when("/tipo_servico/:id_tipo_servico",{templateUrl:"/views/tipo_servico/form.html",controller:"tipo_servico"}),e.when("/usuario",{templateUrl:"/views/usuario/lista.html",controller:"usuario"}),e.when("/usuario/adiciona",{templateUrl:"/views/usuario/form.html",controller:"usuario"}),e.when("/usuario/detalha/:id",{templateUrl:"/views/usuario/form.html",controller:"usuario"}),e.when("/usuario/altera_senha",{templateUrl:"/views/usuario/altera_senha.html",controller:"usuario"}),e.when("/usuario/reseta_senha/:token",{templateUrl:"/views/usuario/reseta_senha.html",controller:"usuario"}),e.when("/pendencia",{templateUrl:"/views/pendencia/lista.html",controller:"pendencia"}),e.when("/pendencia/adiciona",{templateUrl:"/views/pendencia/form.html",controller:"pendencia"}),e.when("/pendencia/:id_pendencia",{templateUrl:"/views/pendencia/form.html",controller:"pendencia"}),e.when("/relatorio",{templateUrl:"/views/relatorio/dashboard.html",controller:"relatorio"}),e.when("/relatorio/demografico",{templateUrl:"/views/relatorio/demografico.html",controller:"relatorio"}),e.when("/relatorio/financeiro/extrato/supporter",{templateUrl:"/views/relatorio/financeiro_extrato_doutor.html",controller:"relatorio"}),e.when("/relatorio/financeiro/extrato/pagamento",{templateUrl:"/views/relatorio/financeiro_extrato_pagamento_doutor.html",controller:"relatorio"}),e.when("/relatorio/financeiro/previsao_pagamento",{templateUrl:"/views/relatorio/financeiro_previsao_pagamento.html",controller:"relatorio"}),e.when("/relatorio/cadastro_supporters",{templateUrl:"/views/relatorio/cadastro_doutores.html",controller:"relatorio"}),e.when("/relatorio/divulgacao_jobs",{templateUrl:"/views/relatorio/divulgacao_job.html",controller:"relatorio"}),e.when("/relatorio/entrega_vendas",{templateUrl:"/views/relatorio/entrega_vendas.html",controller:"relatorio"}),e.when("/relatorio/margem_contribuicao",{templateUrl:"/views/relatorio/margem_contribuicao.html",controller:"relatorio"}),e.when("/relatorio/candidatos_supporter",{templateUrl:"/views/relatorio/candidatos_supporter.html",controller:"relatorio"}),e.when("/relatorio/operacao/pendencias_supporters",{templateUrl:"/views/relatorio/operacao_pendencias_supporters.html",controller:"relatorio"}),e.when("/relatorio/financeiro/conta_azul",{templateUrl:"/views/relatorio/financeiro_extrato_conta_azul.html",controller:"relatorio"}),e.when("/relatorio/operacao/analise_job",{templateUrl:"/views/relatorio/operacao_analise_jobs.html",controller:"relatorio"}),e.when("/relatorio/operacao/capacity",{templateUrl:"/views/relatorio/operacao_capacity.html",controller:"relatorio"}),e.when("/relatorio/operacao/atendimento/supporter",{templateUrl:"/views/relatorio/operacao_atendimento_doutor.html",controller:"relatorio"}),e.when("/relatorio/operacao/atendimento/ticket_medio_clientes",{templateUrl:"/views/relatorio/operacao_atendimento_ticket_medio_cliente.html",controller:"relatorio"}),e.when("/relatorio/operacao/atendimento/ticket_medio_supporters",{templateUrl:"/views/relatorio/operacao_atendimento_ticket_medio_supporters.html",controller:"relatorio"}),e.when("/integracao",{templateUrl:"/views/integracao/lista.html",controller:"integracao"}),e.when("/integracao/adiciona",{templateUrl:"/views/integracao/form.html",controller:"integracao"}),e.when("/integracao/callback?:variaveis",{templateUrl:"/views/integracao/lista.html",controller:"integracao"}),e.when("/integracao/:id_integracao",{templateUrl:"/views/integracao/form.html",controller:"integracao"}),e.when("/click/deslocamento",{templateUrl:"/views/click/acao.html",controller:"click"}),e.when("/click/checkin",{templateUrl:"/views/click/acao.html",controller:"click"}),e.when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboard"}),e.when("/acompanha_job",{templateUrl:"/views/acompanha_job.html",controller:"dashboard"}),e.when("/logout",{templateUrl:"/views/login.html",controller:"login"}),e.when("/",{templateUrl:"/views/login.html",controller:"login"}),e.when("/sso/discourse/sso/:sso/sig/:sig",{templateUrl:"/views/sso.html",controller:"sso"}),e.otherwise({templateUrl:"/views/404.html",controller:"erro"})}]),app.run(["$rootScope","$location","config","$http","$interval","$timeout","$templateCache","deviceDetector","$window","json2csv",function(n,r,l,c,a,s,e,o,t,i){n.opcoes=l.opcoes,c({url:"/portal/cfg",method:"GET"}).success(function(e,o){l=Object.assign(l,e),console.log("app_version",l.app_version),"prod"==l.app_mode?(n.nsacademy=l.moodle_help.prod.base_url,n.moodle_help=l.moodle_help.prod,n.trackers=l.trackers.prod):"teste"==l.app_mode?(n.nsacademy=l.moodle_help.teste.base_url,n.moodle_help=l.moodle_help.teste,n.portal_alerta=l.app_mode,n.trackers=l.trackers.teste):(n.nsacademy=l.moodle_help.dev.base_url,n.moodle_help=l.moodle_help.dev,n.portal_alerta=l.app_mode,n.trackers=l.trackers.dev),t.ga=t.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,t.ga("create",n.trackers.google_analytics,"auto"),t.fbq("init",n.trackers.facebook_pixel),t._linkedin_data_partner_ids=t._linkedin_data_partner_ids||[],t._linkedin_data_partner_ids.push(n.trackers.linkedin),console.log("Iniciando app in modo: ",l.app_mode),n.regras_conduta=n.nsacademy+n.moodle_help.course_url+n.moodle_help.doutor_ids.regras,n.discourse_habilitado=l.discourse}).error(function(e,o){console.log("Falha recuperar configurações do APP. Iniciando em modo de produção: ",e,o),n.nsacademy=l.moodle_help.prod.base_url,n.moodle_help=l.moodle_help.prod,n.regras_conduta=n.nsacademy+l.moodle_help.prod.course_url+l.moodle_help.prod.doutor_ids.regras}),n.debug=function(){var e;"dev"==l.app_mode&&(e=console).log.apply(e,arguments)},n.fecha_modal=function(e){$("#"+e).modal("hide")},n.erro_portal=function(e,o){if(n.debug(e),401==o){if(alert(e.msg),!r.search().destino&&"/"!=r.path()){var a=r.path();r.path("/").search("destino",a)}n.usuario_logado=!1}else n.adiciona_historico(e,o)},n.historico_operacoes=[],n.adiciona_historico=function(e,o){if(400<=o){$("#notificacoes").addClass("alert-danger").fadeIn("slow")}else{$("#notificacoes").addClass("alert-success").fadeIn("slow")}var a,t=(new Date).toLocaleString();a=e.msg?e.msg:e;var r,i="";e.extra_info&&(i="string"==typeof e.extra_info?e.extra_info:_.isEmpty(e.extra_info)?"":JSON.stringify(e.extra_info)),r=a+(""!=i?" - "+i:""),n.notificacao=r,s(function(){n.notificacao="",$("#notificacoes").removeClass("alert-danger alert-success").fadeOut("slow")},4e3),n.historico_operacoes.unshift({data:t,msg:r,status:o})},n.limpa_form=function(){$("#form")[0].reset()},n.redireciona=function(e){r.path(e.join("/"))},n.get_geolocation=function(a,t){if(a.cep&&a.numero&&a.logradouro&&a.bairro&&a.cidade&&a.estado){var e=new google.maps.Geocoder,o=a.logradouro+" "+a.numero+" "+a.bairro+" "+a.cidade+" "+a.estado;e.geocode({address:o},function(e,o){o==google.maps.GeocoderStatus.OK?(a.latitude=e[0].geometry.location.lat(),a.longitude=e[0].geometry.location.lng(),t&&t.$apply()):n.adiciona_historico("Falha recuperar geolocalização",400)})}},n.get_inicio_fim=function(e){var o={};return e.startDate&&(o.data_inicio=e.startDate.format("YYYY-MM-DD")),e.endDate&&(o.data_fim=e.endDate.format("YYYY-MM-DD")),o},n.inverte_data_hora=function(e,o,a){var t=e.split("T"),r=t[0].split(o);return r[2]+a+r[1]+a+r[0]+" "+t[1]},n.busca_cep=function(e,a,t,o,r){if(!e)return n.adiciona_historico("CEP inválido!",400),$("#"+o).focus(),!1;e=e.replace(/[^\d]/g,"");return/^[0-9]{8}$/.test(e)?(n.erro_cep_imcompleto=!1,n.erro_cep_inexistente=!1,n.erro_cep_falha_interna=!1,n.informar_todo_endereco=!1,c({url:"https://viacep.com.br/ws/"+e+"/json/",method:"GET"}).success(function(e,o){!0===e.erro?(n.erro_cep_inexistente=!0,n.informar_todo_endereco=!1,$("#erro_cep").modal("show")):e.bairro&&e.logradouro?($("#"+t).focus(),n.desabilita_endereco(),e.bairro&&e.logradouro||($("#logradouro").attr("disabled",!1),$("#bairro").attr("disabled",!1))):(n.informar_todo_endereco=!1,n.erro_cep_imcompleto=!0,r||$("#erro_cep").modal("show")),a.estado=e.uf,a.cidade=e.localidade,a.bairro=e.bairro,a.logradouro=e.logradouro,a.endereco.logradouro=!!e.logradouro,a.endereco.bairro=!!e.bairro}).error(function(e,o){n.informar_todo_endereco=!0,n.erro_cep_falha_interna=!0,$("#erro_cep").modal("show")})):(n.adiciona_historico("CEP inválido!",400),$("#"+o).focus(),!1)},n.habilita_endereco=function(e){$("#erro_cep").modal("hide"),e&&($("#cidade").removeAttr("disabled"),$("#estado").removeAttr("disabled")),$("#logradouro").removeAttr("disabled"),$("#bairro").removeAttr("disabled")},n.desabilita_endereco=function(){$("#logradouro").attr("disabled",!0),$("#bairro").attr("disabled",!0),$("#cidade").attr("disabled",!0),$("#estado").attr("disabled",!0)},n.mostra_loader=function(e){1==e?$("#loader").modal("show"):$("#loader").modal("hide")},n.serializa_vetor=function(e){return e&&e.constructor===Array?e.join("\n"):""},n.mostra_mensagem=function(e,o,a,t){if($("#mensagem_status").removeClass("texto-sucesso texto-erro"),$("#mensagem_botoes_adicionais").html(""),t?n.arquivo_alerta=t:$("#mensagem_texto").html(o),a)for(var r in a)$("#mensagem_botoes_adicionais").prepend('<a class="btn btn-slim btn-secondary link-redireciona-fecha-modal" href="'+a[r].url_destino+'">'+a[r].titulo+"</a>"),$(".link-redireciona-fecha-modal").on("click",function(){$("#mensagem").modal("hide")});n.mensagem_ico_sucesso=!1,n.mensagem_ico_erro=!1,"sucesso"==e?(n.mensagem_ico_sucesso=!0,$("#mensagem_status").text("Sucesso").addClass("texto-sucesso")):"erro"==e?(n.mensagem_ico_erro=!0,$("#mensagem_status").text("Erro").addClass("texto-erro")):$("#mensagem").modal("hide"),$("#mensagem").modal("show")},n.link_redireciona_fecha_modal=function(){$("#mensagem").modal("hide")},n.mostra_mensagem_nova=function(e){if($("#mensagem_nova").modal("show"),"sucesso"==(n.dados_mensagem_nova=e).status&&e.duracao_redirecionamento)var o=a(function(){n.dados_mensagem_nova.duracao_redirecionamento=n.dados_mensagem_nova.duracao_redirecionamento-1,0==n.dados_mensagem_nova.duracao_redirecionamento&&($("#mensagem_nova").modal("hide"),a.cancel(o),n.login(e.usuario))},1e3)},n.link_redireciona_fecha_modal=function(){$("#mensagem").modal("hide")},0<=["android","ios","windows phone"].indexOf(o.os)&&(n.disposivo_movel=!0),n.temporizador=void 0,n.menus={},n.recarrega_dados_usuario_logado=function(o,a,t){$.ajax({type:"GET",url:l.base_url+"/menu",async:!1,success:function(e){e.usuario&&(n.menus=e.menu,n.usuario_logado=e.usuario,n.server_version=e.app_version,e.menu.filter(function(e){n.disposivo_movel&&"Doutor"!=n.usuario_logado.grupo&&"Minhas Solicitações"!=e.nome&&"Meus Dados"!=e.nome&&(e.invisivel=!0),"Validação Supporter"==e.nome&&(e.invisivel=!0)}),r.search().destino&&(o=!1,r.path(r.search().destino).search("destino",null)),o&&(n.disposivo_movel?"doutor"==n.usuario_logado.perfil?window.location="/#/supporter/job":"cliente"==n.usuario_logado.perfil?r.path("/cliente/job"):window.location="/#/job":"doutor"!=n.usuario_logado.perfil?window.location="/#/dashboard":window.location="/#/supporter/dashboard"),"Doutor"==n.usuario_logado.grupo?(n.conta_pendencia_doutor(),l.ns_academy_doutor_obrigatorio&&null==n.usuario_logado.id_moodle?($("#doutor_primeiro_login").modal({backdrop:"static",keyboard:!1}),a&&(n.erro_portal("Para prosseguir é necessário autenticar seu usuário no NS Academy.",400),n.mostra_alerta_nsacademy=!0)):$("#doutor_primeiro_login").modal("hide"),o&&l.discourse&&null==n.usuario_logado.usuario_discourse&&$("#discourse").modal()):"funcionario"==n.usuario_logado.perfil&&(n.contador_jobs||n.inicializa_tarefas(),(!n.temporizador||(new Date).getTime()>=n.temporizador+1e3*l.tempo_atualizacao_rotinas)&&(n.temporizador=(new Date).getTime(),n.conta_validacao_doutor()),o&&l.discourse&&null==n.usuario_logado.usuario_discourse&&$("#discourse").modal()))},error:function(e){n.menus={},t&&n.erro_portal(e.responseJSON,e.status)}})},n.inicializa_tarefas=function(){n.contador_jobs||0<=["Gestor de Demanda","Gestor de Operação"].indexOf(n.usuario_logado.grupo)&&(n.conta_job(),n.contador_jobs=a(n.conta_job,1e3*l.tempo_atualizacao_rotinas))},n.$on("$routeChangeSuccess",function(e,o,a){l.app_version&&n.server_version!=l.app_version&&-1==["/candidato_supporter/candidata","/candidato_supporter/token/:token","/avaliacao","/loja/agendamento","/usuario/reseta_senha/:token","/click/deslocamento","/click/checkin","","/logout","/"].indexOf(o.originalPath)&&t.location.reload(),t.ga("send","pageview",r.url()),t.fbq("track","pageView",r.url())}),n.$on("$routeChangeStart",function(e,o,a){n.debug("next",o.originalPath);0<=["/candidato_supporter/candidata","/candidato_supporter/token/:token","/avaliacao","/loja/agendamento","/usuario/reseta_senha/:token","/click/deslocamento","/click/checkin","","/logout"].indexOf(o.originalPath)?n.debug("url '"+o.originalPath+"'","não requer login"):-1!=["/"].indexOf(o.originalPath)?(n.debug("url '/' chamando com redireciona"),n.recarrega_dados_usuario_logado(!0,!1,!1)):(n.debug("url '"+o.originalPath+"' chamando com alerta login"),n.recarrega_dados_usuario_logado(!1,!1,!0))}),n.quantidade_jobs={aberto:0,aberto_sla:0,andamento:0,andamento_sla:0},n.conta_job=function(){c({url:l.base_url+"/job/conta",method:"GET"}).success(function(e,o){n.quantidade_jobs.aberto<e.aberto&&n.erro_portal("Existem novos Jobs abertos.",400),(n.quantidade_jobs.aberto_sla<e.aberto_sla||n.quantidade_jobs.andamento_sla<e.andamento_sla)&&n.erro_portal("Existem Jobs com o SLA VENCIDO.",400),n.quantidade_jobs=e}).error(function(e,o){n.erro_portal(e,o)})},n.conta_pendencia_doutor=function(){var e={status:"pendente",id_doutor:n.usuario_logado.id_doutor};c({url:l.base_url+"/pendencia_doutor/lista",method:"POST",data:e}).success(function(e,o){n.quantidade_pendencias_doutor=e.length,n.pendencias_doutor=e}).error(function(e,o){n.quantidade_pendencias_doutor=0,404!=o&&n.erro_portal(e,o)})},n.conta_validacao_doutor=function(){n.quantidade_validacao_doutor=0,c({url:l.base_url+"/doutor/validacao/pendente",method:"GET"}).success(function(e,o){n.quantidade_validacao_doutor=e[0].total_pendencias}).error(function(e,o){404!=o&&n.erro_portal(e,o)})},$(window).on("shown.bs.modal",function(){$('[data-toggle="tooltip"]').tooltip({placement:"bottom",container:"body",html:!0}),n.usuario_logado&&$(".modal-backdrop").css("bottom",120)}),n.carrega_chat=function(){var e,o;n.usuario_logado&&"Cliente"==n.usuario_logado.grupo&&(e=document.createElement("script"),o=document.getElementsByTagName("script")[0],e.async=!0,e.src="https://embed.tawk.to/58810bd88f538671f477165c/default",e.charset="UTF-8",e.setAttribute("crossorigin","*"),o.parentNode.insertBefore(e,o))},n.grava_usuario_discourse=function(e){c({url:l.base_url+"/usuario/discourse/"+e,method:"PUT"}).success(function(e,o){n.adiciona_historico(e,o),$("#discourse").modal("hide")}).error(function(e,o){n.erro_portal(e,o)})},n.verifica_usuario_discourse=function(){n.usuario_logado.usuario_discourse?t.open(l.url_discourse,"_blank"):$("#discourse").modal()},n.$on("$viewContentLoaded",function(){$('[data-toggle="tooltip"]').tooltip({placement:"bottom",container:"body",html:!0}),$("button, a").parent().mouseenter(function(){$(this).children().attr("disabled")&&$(this).css("cursor","no-drop")}),$(window).resize(function(){n.ajusta_altura()}),s(function(){n.ajusta_altura()},0)}),n.ajusta_altura=function(){$(".menu-list-desktop").height($(window).height()-70-112),$(".panel-body").height($(window).height()-70-126-170),$(".panel-body-financeiro").height($(window).height()-70-150-170),$(".panel-body-financeiro-legenda").height($(window).height()-70-180-170),$(".panel-body-header-duplo").height($(window).height()-70-142-150),$(".panel-body-metade").height(($(window).height()-70-126-224)/2),$(".panel-body-metade-horizontal").height(($(window).height()-70-120-210)/2),$(".panel-body-metade-horizontal-header").height(($(window).height()-70-120-250)/2),$(".panel-body-no-panel-header").height($(window).height()-70-113-100),$(".panel-body-no-panel-header-pemissao").height($(window).height()-70-126-200),$(".panel-body-no-panel-footer").height($(window).height()-70-126-120),$(".panel-body-full").height($(window).height()-70-157),$(".panel-body-no-panel-header-foooter").height($(window).height()-70-184),$(".panel-body-no-panel-header-foooter-pequeno").height($(window).height()-70-416),$(".panel-body-dashboard-dr").height($(window).height()-70-217),$(".panel-body-doutor-cidade").height($(window).height()-70-270),$(".panel-body-relatorio-venda").height($(window).height()-70-105-232),$(".panel-body-relatorio-no-header").height($(window).height()-70-148-170),$(".panel-body-relatorio-header-duplo").height($(window).height()-70-148-211);var e=$("#header").height()+$("#footer").height()+$("#principal h3").height()+$("#panel-header").height()+$("#panel-footer").height()+$("#table-header").height()+40,o=$("#header").height()+$("#footer").height()+$("#principal h3").height()+$("#form-footer").height()+40;n.disposivo_movel||($("#table-lista-nova").height($(window).height()-e),$("#form-body").height($(window).height()-o))};var u={d:"dias",h:"horas",m:"minutos",s:"segundos"};n.get_grupo=function(){return n.usuario_logado.grupo},n.msg_validacao=function(e,o,a){if(e)return"Validado com sucesso";var t=[];for(var r in o)switch(r){case"cep":t.push("- CEP inválido. Deve ser no formato XX.XXX-XXX");break;case"cpf":t.push("- CPF inválido");break;case"cnpj":t.push("- CNPJ inválido");break;case"conta":t.push("- Conta inválida. Deve conter somente números.");break;case"conta_dv":t.push("O dígito verificardor pode ser um número ou a letra X.");break;case"data":t.push("- Data inválida. Deve ser no formato dd/mm/aaaa.");break;case"dt_diferenca_maior_que":var i=_slicedToArray($(a).attr("diferenca-maior-que").split(" "),2),n=i[0],l=i[1];t.push("- Data deve ser "+n+" "+u[l]+" anterior a data atual");break;case"dh":t.push("- Data e hora inválida. Deve ser no formato dd/mm/aaaa hh:mm:ss, sendo a hora no formato 24h e os segundos são opcionais.");break;case"dh_diferenca_maior_que":var c=_slicedToArray($(a).attr("diferenca-maior-que").split(" "),2);n=c[0],l=c[1];t.push("- Data e hora deve ser, no mínimo, "+n+" "+u[l]+" anterior a data atual");break;case"dh_futura":var s=_slicedToArray($(a).attr("futura").split(" "),2);n=s[0],l=s[1];t.push("- Data e hora deve ser "+n+" "+u[l]+" posterior a data atual");break;case"digitos_maior_que":var d=$(a).attr("maior-que");t.push("- Deve ser maior que "+d);break;case"digitos_menor_que":d=$(a).attr("menor-que");t.push("- Deve ser menor que "+d);break;case"duracao":t.push("- Duração inválida.");break;case"email":t.push("- E-mail inválido.");break;case"fone":t.push("- Telefone inválido. Deve ser no formato (XX) X XXXX-XXXX para celular ou no formato (XX) XXXX-XXXX para fixo.");break;case"hora":t.push("- Hora inválida.");break;case"igual_campo":var m=$(a).attr("campo-teste");t.push("- Deve ser igual ao compo "+m);break;case"maxlength":d=$(a).attr("maxlength"),t.push("- Deve ter no máximo "+d+" caracteres");break;case"menor_igual":d=$(a).attr("menor-igual");t.push("- Deve ser menor ou igual a "+d);break;case"minlength":d=$(a).attr("minlength"),t.push("- Deve ter no mínimo "+d+" caracteres");break;case"nao_nulo":t.push("- Preenchimento obrigatório.");break;case"nome_discourse":t.push("- Possui caracteres inválidos. Pode conter apenas letras, números e _ (underscore). Não pode terminar em _ (underscore).");break;case"nome_discourse_termina_":t.push("- Não pode terminar em _ (underscore).");break;case"numero_letra_traco_ponto":t.push("- Contém caracteres inválidos. So pode conter número, letras, traço e ponto. Acentos e outros carecteres não são permitidos.");break;case"real_maior_que":d=$(a).attr("maior-que");t.push("- Deve ser maior que "+d);break;case"real_menor_que":d=$(a).attr("menor-que");t.push("- Deve ser menor que "+d);break;case"required":t.push("- Preenchimento obrigatório");break;case"str_espaco_acento_numero":t.push("- Contém caracteres inválidos. Só pode conter letras, acentos, espaços e números");break;case"str_espaco_acento_numero_linha":t.push("- Contém caracteres inválidos. Só pode conter letras, acentos, espaços e números e multiplas linhas");break;case"str_nome_sobrenome":t.push("- É preciso inserir ao menos um nome e um sobrenome");break;case"url":t.push("- Contém caracteres inválidos. Só pode caracteres válidos em uma URL");break;case"vazio":t.push("- Deve ser vazio");break;case"token_invalido":t.push("- Token inválido");break;default:t.push("- BUG! Valor não previsto. Por favor reporte o problema para equipe de desenvolvimento")}return t.join("<br>")},n.dr2supporter=function(e){if(e)return e=(e=e.replace("doutor","supporter")).replace("Doutor","Supporter")},n.custom_tooltip=function(i){return function(e){var o=document.getElementById("chartjs-tooltip");if(o||((o=document.createElement("div")).id="chartjs-tooltip",o.innerHTML="<table></table>",document.body.appendChild(o)),0!==e.opacity){if(e.body){var a=e.body.map(function(e){return e.lines}),t="<tbody>";a.forEach(function(e,o){t+='<tr><td style="color: #ffffff;background-color: #000000;border-color: #000000;border-width: 1px;border-radius: 2px;padding: 2px 2px 0px">'+e+i+"</td></tr>"}),t+="</tbody>",o.querySelector("table").innerHTML=t}var r=this._chart.canvas.getBoundingClientRect();o.style.opacity=1,o.style.position="absolute",o.style.left=r.left+window.pageXOffset+e.caretX+"px",o.style.top=r.top+window.pageYOffset+e.caretY+"px",o.style.fontFamily=e._bodyFontFamily,o.style.fontSize=e.bodyFontSize+"px",o.style.fontStyle=e._bodyFontStyle,o.style.padding=e.yPadding+"px "+e.xPadding+"px"}else o.style.opacity=0}},n.json2csv=i,n.gravar_clicado=!1,n.seta_gravar=function(e){n.gravar_clicado=e},n.otimiza_filtro=function(o){if(!o)return{};var a={};return Object.keys(o).forEach(function(e){angular.isArray(o[e])?0<o[e].length&&(a[e]=o[e]):o[e]&&(0==e.indexOf("data_")?a[e]=moment(o[e]).format("YYYY-MM-DD"):a[e]=o[e])}),a},n.limpa_filtros=function(o){Object.keys(o).forEach(function(e){delete o[e]})},n.get_ids=function(e){var o=[];return e.forEach(function(e){o.push(e.id)}),o},n.tracking_ga=function(){"prod"==l.app_mode&&t.ga("send","event","formulario-enviado-dr","click","formulario-enviado-dr")},n.modal_confirmacao=function(e){e.msg||(e.msg="Deseja remover este registro?"),n.obj_confirmacao=e,$("#modal_confirmacao").modal("show")},n.confirmacao=function(e){e&&n.obj_confirmacao.cb(n.obj_confirmacao),n.obj_confirmacao={},$("#modal_confirmacao").modal("hide")},n.modal_confirmacao_cancela=function(){n.obj_confirmacao={},$("#modal_confirmacao").modal("hide")},n.chat=function(){if(localStorage.user){var i=JSON.parse(localStorage.user);i.id_bot_km&&i.km_app_id&&(document,e=window.kommunicate||{},o=_objectSpread(_objectSpread({appId:i.km_app_id,automaticChatOpenOnNavigation:!0,popupWidget:!0,userName:i.nome,email:i.email,userId:"agregado_cliente"==i.perfil?i.email:i.id},translate),{},{onInit:function(){var e={defaultBotIds:[i.id_bot_km],defaultAssignee:i.id_bot_km,skipRouting:!0};Kommunicate.updateSettings(e);Kommunicate.customizeWidgetCss("#launcher-svg-container,#km-popup-close-button { background-color: #00aaaa !important;}.mck-box-top,.mck-msg-right .mck-msg-box,#mck-msg-new { background: #00aaaa !important; }.mck-box-title,#mck-tab-title,.mck-msg-right .mck-msg-box { color: #fff !important;}#mck-agent-status-text {color: rgba(55, 57, 70, 0.5);}#km-chat-widget-close-button svg,#mck-conversation-back-btn svg { fill: #184869;}.mck-message-inner,#mck-sidebox-ft { background: #f9f9f9 !important;}");var o={id_usuario:i.id,nome:i.nome,email:i.email};Kommunicate.updateChatContext(o);var a={"Api-Key":"SrPoYRF3AcQKtz3dg619xONycRVgkpjw","Of-User-Id":window.kommunicate._globals.userId,"Content-Type":"application/json"},t={displayName:i.nome,email:i.email,metadata:{id:i.id,nome:i.nome,email:i.email,cliente:i.cliente}},r={method:"POST",headers:a,body:JSON.stringify(t)};fetch("https://services.kommunicate.io/rest/ws/user/update",r)}}),(a=document.createElement("script")).type="text/javascript",a.async=!0,a.src="https://widget.kommunicate.io/v2/kommunicate.app",document.getElementsByTagName("head")[0].appendChild(a),(window.kommunicate=e)._globals=o)}var e,o,a},n.login=function(i){var e;(n.autenticando=!0,0!=((e=i)?e.login?e.senha?void 0:(alert("Informe a senha"),$("#senha").focus(),!1):(alert("Informe o usuário"),$("#login").focus(),!1):(alert("Informe usuário e senha"),$("#login").focus(),!1)))?("@"==i.login.slice(-1)&&(i.login=i.login+"netsupport.com.br"),c({url:l.base_url+"/sessao",method:"POST",data:i}).success(function(e){n.recarrega_dados_usuario_logado(!0),n.autenticando=!1,c({url:l.base_url+"/sessao/minha",method:"get"}).success(function(e){if(localStorage.setItem("user",JSON.stringify(e.dados)),n.usuario=e.dados,"funcionario"!=e.dados.perfil){var o=[],a=[];i.login.split("").filter(function(e){return o.push(e.charCodeAt())}),i.senha.split("").filter(function(e){return a.push(e.charCodeAt())});var t=o.join("-"),r=a.join("-");n.mostra_mensagem("",'<div style="text-align:center">\n                    <img src="/img/logo.png" width="150" />\n                   <br>\n                    <br>\n                    Olá <b>'.concat(e.dados.nome,'</b>.<br><h3>Temos uma versão nova do portal para você!</h3>\n                     Encontra-se disponível no endereço <b>\n                     <a href="').concat(e.dados.url_frontend,"?user=").concat(t,"&pass=").concat(r,'">').concat(e.dados.url_frontend,"</a></b>.\n                     <br>\n                     Atualize seus favoritos! </div>"),[{url_destino:e.dados.url_frontend+"?user=".concat(t,"&pass=").concat(r),titulo:"Ir"}])}n.chat()})}).error(function(e){alert(e.msg),n.autenticando=!1})):$scope.autenticando=!1},n.usuario=JSON.parse(localStorage.getItem("user")),n.whatsapp=function(e){n.usuario.autoriza_whatsapp=e,localStorage.setItem("user",JSON.stringify(n.usuario)),c({url:l.base_url+"/doutor/autoriza_whatsapp",method:"POST",data:{autoriza:e}}).success(function(){e&&window.open("https://api.whatsapp.com/send?phone=553484419437&text=Aceito%20receber%20chamados%20por%20WhatsApp!%21","_blank")})},n.goto_login=function(){r.path("/")},n.debug("app.js carregado")}]);
"use strict";var translate={labels:{"input.message":"Escreva uma mensagem...","conversations.title":"Atendimentos","start.new":"Novo atendimento","empty.messages":"Sem mensagens","no.more.messages":"Sem mais mensagens","empty.conversations":"Ainda nenhuma conversa","no.more.conversations":"Sem mais conversas","search.placeholder":"Procure...","location.placeholder":"Qual a sua localização","members.title":"Membros",typing:"escrevendo...","is.typing":"está digitando...",online:"Online",offline:"Offline","clear.messages":"Limpar Mensagens",delete:"Apagar",reply:"Responder","location.share.title":"Compartilhar localização","my.location":"Minha localização",send:"Enviar","send.message":"Enviar Mensagem",smiley:"Emojis",close:"Fechar",edit:"Editar",save:"Salvar","file.attachment":"Anexo","file.attach.title":"Anexar","last.seen":"Visto","last.seen.on":"Visto por último","time.format.AM":"AM","time.format.PM":"PM",hour:" hora",min:" min",yesterday:"Ontem",hours:" horas",mins:" mins",ago:"atrás",admin:"Administrador",user:"Usuário",member:"Membro",you:"Você",away:"Ausente","closed.conversation.message":"Esta conversa foi marcada como resolvida. Se você tiver outras dúvidas, basta enviar uma mensagem aqui ou iniciar uma nova conversa.","search.faq":"Procure nos FAQs...","looking.for.something.else":"Te ajudo em algo mais?","no-faq-found":"Estamos aqui para ajudar.","talk.to.agent":"Falar com um Supporter","how.to.reachout":"Como podemos entrar em contato com você?","email.error.alert":"Parece que você digitou um e-mail inválido","conversation.rated":"avaliou a conversa","char.limit.warn":"Mantenha sua mensagem dentro de 256 caracteres para ajudar o bot a entender facilmente","limit.remove":"Remover","limit.characters":"caracteres","limit.remaining":"restante","lead.collection":{email:"Email",name:"Nome",phone:"Telefone de contato",title:"Atendimentos",heading:"Antes de começar, só precisamos de alguns detalhes para que possamos atendê-lo melhor",submit:"Começar uma conversa"},"csat.rating":{CONVERSATION_RATED:"Você avaliou a conversa",RATE_CONVERSATION:"Avalie sua conversa",CONVERSATION_REVIEW_PLACEHOLDER:"Adicione um comentário…",OTHER_QUERIES:"Tem outras dúvidas? ",RESTART_CONVERSATION:"Reinicie esta conversa ",SUBMIT_RATING:"Envie sua avaliação "},"page.title.on.new.message":"Nova mensagem de ","emoji.hover.text":{poor:"Pobre",great:"Ótima",average:"Média"},"rich.message":{"notification.preview":"Mensagem"},"filter.conversation.list":{ALL_CONVERSATIONS:"Todos atendimentos",ACTIVE_CONVERSATIONS:"Atendimentos ativos",HIDE_RESOLVED:"Ocultar resolvido",SHOW_RESOLVED:"Mostrar resolvido"},"time.stamp":{"sec.ago":"segundo atrás","secs.ago":"segundos atrás","min.ago":"min atrás","mins.ago":"mins atrás","hr.ago":"hr atrás","hrs.ago":"hrs atrás"},"voice.output":{location:{init:"Um local foi compartilhado com você.",lat:"Latitude é ",lon:"e Longitude é "},attachment:"Você tem um anexo."}}};
"use strict";app.value("config",{app_name:"Portal NetSupport",base_url:"/portal",app_mode:"dev",tempo_atualizacao_rotinas:900,redirect_url_desativacao:"https://docs.google.com/forms/d/1UPk2Ji9dK6mNn-Z1ISA_6V0GpZv6EbTmHux4po3FPRw/viewform?edit_requested=true",desativa_conta_form:"",loja:{prod:{url:"https://loja.netsupport.com.br"},teste:{url:"https://loja-teste.netsupport.com.br"},dev:{url:"https://loja-teste.netsupport.com.br"}},trackers:{prod:{google_analytics:"UA-60038561-1",facebook_pixel:"812655602195141",linkedin:"1162610"},teste:{google_analytics:"UA-60038561-6",facebook_pixel:"413155726079539",linkedin:""},dev:{google_analytics:"UA-60038561-7",facebook_pixel:"2073376666296816",linkedin:""}},moodle_help:{prod:{base_url:"https://nsacademy.netsupport.com.br",page_url:"/mod/page/view.php?id=",course_url:"/course/view.php?id=",doutor_ids:{dashboard:"21",pendencias:"6",candidato_job:"15",competencias:"10",dados_doutor:"3",documentos:"9",job:"14",slack:"5",cidade:"",regras:"4"}},dev:{base_url:"https://moodle-dev.netsupport.com.br",page_url:"/mod/page/view.php?id=",course_url:"/course/view.php?id=",doutor_ids:{dashboard:"",pendencias:"",candidato_job:"",competencias:"",dados_doutor:"",documentos:"",job:"",slack:"",cidade:"",regras:""}},teste:{base_url:"https://moodle-teste.netsupport.com.br",page_url:"/mod/page/view.php?id=",course_url:"/course/view.php?id=",doutor_ids:{dashboard:"8",pendencias:"6",candidato_job:"15",competencias:"10",dados_doutor:"3",documentos:"9",job:"14",slack:"5",cidade:"",regras:""}}},opcoes:{status_jobs:[{valor:"Aberto",desc:"Aberto"},{valor:"Atendimento encerrado",desc:"Atendimento encerrado"},{valor:"Cancelado",desc:"Cancelado"},{valor:"Categorizado",desc:"Categorizado"},{valor:"Com Doutor",desc:"Com Supporter"},{valor:"Com Gestor",desc:"Com Gestor"},{valor:"Divulgado",desc:"Divulgado"},{valor:"Doutor em trânsito",desc:"Supporter em trânsito"},{valor:"Doutor no local",desc:"Supporter no local"},{valor:"Doutor orientado",desc:"Supporter orientado"},{valor:"Falha validação",desc:"Falha validação "},{valor:"Fechado",desc:"Fechado"},{valor:"Finalizado",desc:"Finalizado"},{valor:"Reagendado",desc:"Reagendado"},{valor:"Rescindido",desc:"Rescindido"},{valor:"Sem Doutor",desc:"Sem Supporter"},{valor:"Validado com sucesso",desc:"Validado com sucesso"},{valor:"Fechamento cancelado",desc:"Fechamento cancelado"}],sla:[{valor:"dentro",desc:"Dentro"},{valor:"vencido",desc:"Vencido"}],sexo:[{valor:void 0,desc:"SELECIONE"},{valor:"F",desc:"Feminino"},{valor:"M",desc:"Masculino"}],pcd:[{valor:void 0,desc:"SELECIONE"},{valor:"S",desc:"Sim"},{valor:"N",desc:"Não"}],tipo_conta:[{valor:void 0,desc:"SELECIONE"},{valor:"corrente",desc:"Conta Corrente"},{valor:"poupanca",desc:"Conta poupança"}],operacao_conta:[{valor:null,desc:"SELECIONE"},{valor:"001",desc:"001 - Conta Corrente de Pessoa Física"},{valor:"003",desc:"003 – Conta Corrente de Pessoa Jurídica"},{valor:"013",desc:"013 – Poupança de Pessoa Física"},{valor:"022",desc:"022 – Poupança de Pessoa Jurídica"}],status:[{valor:void 0,desc:"SELECIONE"},{valor:"ativo",desc:"Ativo"},{valor:"inativo",desc:"Inativo"}],tipo_cliente:[{valor:void 0,desc:"SELECIONE"},{valor:"pequeno",desc:"Pequeno"},{valor:"grande",desc:"Grande"}],tipo_faturamento:[{valor:void 0,desc:"SELECIONE"},{valor:"fixo",desc:"Fixo"},{valor:"variavel",desc:"Variável"}],frequencia:[{valor:void 0,desc:"SELECIONE"},{valor:"pontual",desc:"Pontual"},{valor:"recorrente",desc:"Recorrente"}],tipo_atendimento:[{valor:void 0,desc:"SELECIONE"},{valor:"presencial",desc:"Presencial"},{valor:"remoto",desc:"Remoto"}],tipo_data_job:[{valor:void 0,desc:"SELECIONE"},{valor:"abertura",desc:"Abertura"},{valor:"atendimento",desc:"Atendimento"},{valor:"fechamento",desc:"Fechamento"}],tipo_deslocamento:[{valor:void 0,desc:"SELECIONE"},{valor:"variavel",desc:"Variável"},{valor:"fixo",desc:"Fixo"},{valor:"zero",desc:"Zero"}],cod_chamado_cli_obrigatorio:[{valor:void 0,desc:"SELECIONE"},{valor:!0,desc:"Sim"},{valor:!1,desc:"Não"}],tipo_documento:[{valor:void 0,nome:"SELECIONE",desc:"Selecione um item.",duracao:null},{valor:"1_id_doutor",nome:"Documento de identificação do supporter",desc:"Escolha um subtipo para documento de identificação. Poderão ser utilizados CNH ou RG/CPF."},{valor:"2_ac_doutor_pc",nome:"Certidão negativa de antecedentes criminais do supporter: polícia civil",desc:"Emita este certificado de antecedentes criminais visitando o site da polícia civil de seu estado e solicite emissão deste documento. No google pesquise certidão antecedentes criminais XX onde XX é o seu estado. Ex: certidão antecedentes criminais MG."},{valor:"3_ac_doutor_pf",nome:"Certidão negativa de antecedentes criminais do supporter: polícia federal",desc:"Emita este certificado de antecedentes criminais visitando o site da polícia federal e solicite emissão deste documento através do site https://servicos.dpf.gov.br/antecedentes-criminais/certidao."},{valor:"4_self_doutor_doc",nome:"Selfie do supporter com documento pessoal",desc:"Envie uma foto com documento de identificação ao lado de seu rosto."},{valor:"5_foto_doutor",nome:"Foto do supporter",desc:"Envie uma foto de rosto para identificação do seu perfil."},{valor:"7_comprovante_residencia",nome:"Comprovante de residência",desc:"Envie cópia de alguma conta que contenha o endereço de sua residência (água, luz, telefone, etc)."},{valor:"11_comprovante_pj",nome:"Comprovante da Pessoa Jurídica",desc:"Envie cópia da certidão emitida no site da Receita Federal: https://www.receita.fazenda.gov.br/PessoaJuridica/CNPJ/cnpjreva/Cnpjreva_Solicitacao2.asp. É importante que no arquivo conste da data e hora de emissão da certidão."},{valor:"12_curriculo",nome:"Currículo",desc:"Enviar Currículo"}],estado:[{nome:"SELECIONE",sigla:void 0},{nome:"Acre",sigla:"AC"},{nome:"Alagoas",sigla:"AL"},{nome:"Amazonas",sigla:"AM"},{nome:"Amapá",sigla:"AP"},{nome:"Bahia",sigla:"BA"},{nome:"Ceará",sigla:"CE"},{nome:"Distrito Federal",sigla:"DF"},{nome:"Espírito Santo",sigla:"ES"},{nome:"Goiás",sigla:"GO"},{nome:"Maranhão",sigla:"MA"},{nome:"Minas Gerais",sigla:"MG"},{nome:"Mato Grosso do Sul",sigla:"MS"},{nome:"Mato Grosso",sigla:"MT"},{nome:"Pará",sigla:"PA"},{nome:"Paraíba",sigla:"PB"},{nome:"Pernambuco",sigla:"PE"},{nome:"Piauí",sigla:"PI"},{nome:"Paraná",sigla:"PR"},{nome:"Rio de Janeiro",sigla:"RJ"},{nome:"Rio Grande do Norte",sigla:"RN"},{nome:"Rondônia",sigla:"RO"},{nome:"Roraima",sigla:"RR"},{nome:"Rio Grande do Sul",sigla:"RS"},{nome:"Santa Catarina",sigla:"SC"},{nome:"Sergipe",sigla:"SE"},{nome:"São Paulo",sigla:"SP"},{nome:"Tocantins",sigla:"TO"}],template:[{valor:void 0,desc:"SELECIONE"},{valor:"email_candidato_doutor.html",desc:"Candidato Supporter"},{valor:"email_notificacao_job_doutores.html",desc:"Notificação job Supporter"},{valor:"email_notificacao_job_doutores_migrados.html",desc:"Notificação job Supporters Migrados"},{valor:"email_reseta_senha.html",desc:"Reseta Senha"},{valor:"email_divulgacao_job.html",desc:"Divulgacaoção Job"}],metodo:[{valor:void 0,desc:"SELECIONE"},{valor:"PUT",desc:"PUT"},{valor:"GET",desc:"GET"},{valor:"POST",desc:"POST"},{valor:"DELETE",desc:"DELETE"}],menu:[{valor:void 0,desc:"SELECIONE"},{valor:"S",desc:"Sim"},{valor:"N",desc:"Não"}],perfil:[{valor:void 0,desc:"SELECIONE"},{valor:"funcionario",desc:"Funcionário"},{valor:"doutor",desc:"Supporter"},{valor:"cliente",desc:"Cliente"}],tipo_integracao:[{valor:void 0,desc:"SELECIONE"},{valor:"oauth2",desc:"Oauth 2"}],urgencia_atendimento:[{valor:void 0,desc:"SELECIONE"},{valor:"imediato",desc:"Atendimento Imediato"},{valor:"agendado",desc:"Atendimento Agendado"}],forma_atendimento:[{valor:void 0,desc:"SELECIONE"},{valor:"presencial",desc:"presencial"},{valor:"remoto",desc:"remoto"}],motivo_desassociacao:[{valor:void 0,desc:"SELECIONE"},{valor:"desistencia",desc:"Desistência"},{valor:"abandono",desc:"Abandono"}],aceite_cliente:[{valor:void 0,desc:"SELECIONE"},{valor:!0,desc:"Sim"},{valor:!1,desc:"Não"}],tipo_lancamento:[{valor:void 0,desc:"SELECIONE"},{valor:"reembolso_ns",desc:"Pagamento adicional por conta da NetSupport"},{valor:"reembolso_cliente",desc:"Pagamento adicional por conta do Cliente"},{valor:"cobranca_cliente",desc:"Cobrança cliente"}],tipo:[{valor:void 0,desc:"SELECIONE"},{valor:"atendimento",desc:"Atendimento Avulso"},{valor:"alocacao",desc:"Alocação"}],sim_nao:[{valor:void 0,desc:"SELECIONE"},{valor:!0,desc:"sim"},{valor:!1,desc:"não"}],tipo_pessoa:[{valor:void 0,desc:"SELECIONE"},{valor:"fisica",desc:"Física"},{valor:"juridica",desc:"Jurídica"}],id_grupo:[{valor:void 0,desc:"SELECIONE"},{valor:"1",desc:"Supporter"},{valor:"2",desc:"Cliente"},{valor:"3",desc:"Gestor Demanda"},{valor:"4",desc:"MKT"},{valor:"5",desc:"TI"}],status_pagamento:[{valor:void 0,desc:"SELECIONE"},{valor:"pago",desc:"Pago"},{valor:"pendente",desc:"Pendente"}],status_nota_fiscal:[{valor:void 0,desc:"SELECIONE"},{valor:"validado",desc:"Validado"},{valor:"pendente",desc:"Pendente"}],status_pendencia:[{valor:void 0,desc:"SELECIONE"},{valor:"paga",desc:"Paga"},{valor:"pendente",desc:"Pendente"}],status_recebimento:[{valor:void 0,desc:"SELECIONE"},{valor:"recebido",desc:"Recebido"},{valor:"pendente",desc:"Pendente"}],status_faturamento:[{valor:void 0,desc:"SELECIONE"},{valor:"nao_faturado",desc:"Não Faturado"},{valor:"faturado",desc:"Faturado"},{valor:"perda",desc:"Perda"}],status_candidatura_job:[{id:void 0,nome:"SELECIONE"},{id:"na_fila",nome:"Na fila"},{id:"selecionado",nome:"Selecionado para Atendimento"},{id:"descartado",nome:"Recusado para Job"},{id:"desistiu",nome:"Desistiu do Job"},{id:"job_terminado",nome:"Job Fechado"}],tipo_custo:[{valor:"ciclo",desc:"Pagamento"},{valor:"periodo",desc:"Atendimento"}],titular_conta:[{valor:void 0,desc:"SELECIONE"},{valor:"pf",desc:"Pessoa Física"},{valor:"pj",desc:"Pessoa Jurídica"}],visibilidade_operacao:[{valor:void 0,desc:"SELECIONE"},{valor:"tudo",desc:"Todos os jobs"},{valor:"operacao",desc:"Somente os jobs da operação atual"},{valor:"meus",desc:"Somente seus próprios jobs"}]}});
"use strict";app.directive("datahora",function(){return{restrict:"A",require:"ngModel",link:function(e,o,t,a){var r=t.datahora,s=/^\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}(\.\d{0,6})?$/;switch(r){case"dd/MM/yyyy HH:mm:ss.us":var i=26;break;case"dd/MM/yyyy HH:mm:ss":var i=19;break;case"dd/MM/yyyy HH:mm":var i=16;break;default:return alert("Formato de data inválido: "+r),null}a.$formatters.push(function(e){return s.test(e)&&!isNaN(Date.parse(e))?(o=e.substring(0,i),t="-",a="/",r=o.split("T"),(n=r[0].split(t))[2]+a+n[1]+a+n[0]+" "+r[1]):e;var o,t,a,r,n})}}}),app.directive("googleMapa",function(){return{restrict:"A",transclude:!0,replace:!0,link:function(c,a,e){var d,l,g,p,m=[],u={lat:-15.721751,lng:-48.0073978},r={center:new google.maps.LatLng(u),zoom:4.3,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!0,streetViewControl:!1};function y(e){return e||""}function v(o,e,t,a,r,n){var s={position:e,map:o,title:t,icon:"/img/mapas/"+r+"_"+n+".png",status:n},i=new google.maps.Marker(s);m.push(i),google.maps.event.addListener(i,"click",function(){void 0!==l&&l.close();var e={content:a};(l=new google.maps.InfoWindow(e)).open(o,i)})}function f(e){c.reseta&&(google.maps.event.addListener(d,"click",function(){g=d.getZoom(),p={lat:d.getCenter().lat(),lng:d.getCenter().lng()}}),google.maps.event.addListener(d,"center_changed",function(){g=d.getZoom(),p={lat:d.getCenter().lat(),lng:d.getCenter().lng()}}),google.maps.event.addListener(d,"zoom_changed",function(){g=d.getZoom(),p={lat:d.getCenter().lat(),lng:d.getCenter().lng()}})),c.reseta&&!e||(p=!1,c.reseta=!0)}c.$watch("reseta",function(){f(!1)}),c.$watch("referencias",function(){var e;e="off"==c.referencias?-100:0,d.setOptions({styles:[{featureType:"poi.attraction",stylers:[{visibility:c.referencias}]},{featureType:"poi.business",stylers:[{saturation:e},{lightness:e},{visibility:c.referencias}]},{featureType:"poi.government",stylers:[{visibility:c.referencias}]},{featureType:"poi.medical",stylers:[{visibility:c.referencias}]},{featureType:"poi.park",stylers:[{visibility:c.referencias}]},{featureType:"poi.place_of_worship",elementType:"geometry.fill",stylers:[{visibility:c.referencias}]},{featureType:"poi.school",stylers:[{visibility:c.referencias}]},{featureType:"poi.school",elementType:"labels.icon",stylers:[{visibility:c.referencias}]},{featureType:"poi.sports_complex",stylers:[{visibility:c.referencias}]}]})}),c.$watch("jobs",function(){if(0!=c.jobs.length){f(!0),m&&(m=[]);var e=new google.maps.LatLngBounds;for(var o in new Date,c.jobs){var t,a,r,n;switch(t={lat:c.jobs[o].latitude,lng:c.jobs[o].longitude},r="sim"==c.jobs[o].sla_vencido?(a="vermelho","#d9544f"):(a="verde","#5db75d"),c.jobs[o].status){case"Aberto":n="aberto";break;case"Com Gestor":n="com_gestor";break;case"Categorizado":n="categorizacao";break;case"Divulgado":n="divulgacao";break;case"Com Doutor":n="com_doutor";break;case"Doutor em trânsito":n="doutor_transito";break;case"Doutor no local":n="doutor_local";break;case"Atendimento encerrado":n="atendimento_encerrado";break;case"Validado com sucesso":n="valido_sucesso",a="verde",r="#5db75d";break;case"Falha validação":n="valido_erro",a="vermelho",r="#d9544f";break;case"Fechado":n="fechado",a="verde",r="#5db75d";break;default:0<=["Abandono","Desistencia","Reaberto"].indexOf(c.jobs[o].status)||console.warn("Status desconhecido."),n="valido_erro",a="vermelho",r="#d9544f"}var s=c.jobs[o].problema.slice(1,77)+"...",i=new Date(c.jobs[o].dh_agendamento_cliente).toLocaleString(),l='<div style="width: 300px;height: 160px;"><h4 style="width: 300px"><a style="text-decoration: none; color: '+r+'!important;" href="'+("doutor"==c.usuario.perfil?"#/supporter/job/detalha/":"cliente"==c.usuario.perfil?"#/cliente/job/detalha/":"#/job/detalha/")+c.jobs[o].id+'" ><img src="/img/mapas/'+n+"_"+a+'.png"> - '+c.jobs[o].id+'</a></h4><p style="margin: 0"><strong>Cliente:</strong> '+c.jobs[o].nome_cliente+'</p><p style="margin: 0"><strong>Supporter:</strong> '+y(c.jobs[o].nome_doutor)+'</p><p style="margin: 0"><strong>Gestor:</strong> '+y(c.jobs[o].nome_gestor)+'</p><p style="margin: 0"><strong>Horário Agendamento:</strong> '+i+'</p><p style="margin: 0"><strong>Tipo Serviço:</strong> '+y(c.jobs[o].tipo_servico)+'</p><p style="margin: 0"><strong>Descrição:</strong> '+s+"</p></div>";v(d,new google.maps.LatLng(t),c.jobs[o].pais,l,n,a),e.extend(t)}p?d.setOptions({zoom:g,center:new google.maps.LatLng(p)}):d.fitBounds(e),new MarkerClusterer(d,m,{gridSize:50,maxZoom:15,styles:[{height:64,url:"/img/mapas/cluster_verde.png",width:64},{height:64,url:"/img/mapas/cluster_vermelho.png",width:64}]}).setCalculator(function(e){for(var o=0;o<e.length;o++)if(-1<e[o].getIcon().indexOf("vermelho"))return{text:e.length,index:2};return{text:e.length,index:1}})}else d.setOptions({center:new google.maps.LatLng(u),zoom:4.3,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!0,scaleControl:!0,streetViewControl:!1})}),function(){if(void 0===d){d=new google.maps.Map(a[0],r);var e=[{nome:"Aberto",icon:"aberto_verde",grayscale:"grayscale"},{nome:"Com Gestor",icon:"com_gestor_verde",grayscale:"grayscale"},{nome:"Categorizado",icon:"categorizacao_verde",grayscale:"grayscale"},{nome:"Divulgado",icon:"divulgacao_verde",grayscale:"grayscale"},{nome:"Com Doutor",icon:"com_doutor_verde",grayscale:"grayscale"},{nome:"Doutor em trânsito",icon:"doutor_transito_verde",grayscale:"grayscale"},{nome:"Doutor no local",icon:"doutor_local_verde",grayscale:"grayscale"},{nome:"Atendimento encerrado",icon:"atendimento_encerrado_verde",grayscale:"grayscale"},{nome:"Validado com sucesso",icon:"valido_sucesso_verde",grayscale:"grayscale"},{nome:"Falha validação",icon:"valido_erro_verde",grayscale:"grayscale"},{nome:"Fechado",icon:"fechado_verde",grayscale:"grayscale"},{nome:"",icon:"graduacao_sla",style:"width: 220px;margin-top:10px",style_div:"float:right !important;"}];for(var o in e){var t=document.createElement("div");t.innerHTML='<div class="text-center" style="'+e[o].style_div+'"><img  style="'+e[o].style+'" class="'+e[o].grayscale+'" src="/img/mapas/'+e[o].icon+'.png"><br>'+e[o].nome.replace("Doutor","Supporter")+"</div>",legenda.appendChild(t)}d.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legenda),google.maps.event.addListener(d,"tilesloaded",function(){jQuery("#legenda").css("display","inline-flex")})}}()},scope:{jobs:"=",referencias:"=",reseta:"=",usuario:"="}}}),app.directive("selecionaClique",function(){return{restrict:"A",link:function(e,o,t){o.on("focus",function(){this.select()})}}}),app.directive("copyToClipboard",["$rootScope",function(a){return{restrict:"A",scope:{input:"="},link:function(o,e,t){e.bind("click",function(){a.adiciona_historico("Item copiado.",200);var e=$("<input>");$("body").append(e),e.val(o.input).select(),document.execCommand("copy"),e.remove()})}}}]);
"use strict";app.filter("datahora",function(){return function(t,r){if(t){if(isNaN(Date.parse(t)))return"";var n=t.split("T"),e=n[0].split("-"),i=n[1];return"mostrar_ms"==r&&null!=r||(i=(i=n[1].split("."))[0]),e[2]+"/"+e[1]+"/"+e[0]+" "+i}}}),app.filter("data",function(){return function(t){if(t)return isNaN(Date.parse(t))?t:t.split("-").reverse().join("/")}}),app.filter("quebralinha",function(){return function(t){return t.replace(/\n\r?/g,"<br/>")}}),app.filter("fone",function(){return function(t){return!t||t.length<10?t:10==t.length?t.replace(/(.{2})(.{4})(.{1,4})/,"($1) $2-$3"):t.replace(/(.{2})(.{1})(.{4})(.{1,4})/,"($1) $2 $3-$4")}}),app.filter("cpf",function(){return function(t){return t&&11==t.length?t.replace(/(.{3})(.{3})(.{3})(.{1,2})/,"$1.$2.$3-$4"):t}}),app.filter("cnpj",function(){return function(t){return t&&14==t.length?t.replace(/(.{2})(.{3})(.{3})(.{4})(.{1,2})/,"$1.$2.$3/$4-$5"):t}}),app.filter("realBr",function(){return function(t){return t||0==t?t.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):t}}),app.filter("agencia_conta",function(){return function(t){return t.length<=1?t:(digito=t.slice(-1),conta=t.slice(0,-1),digito?conta.split("").reverse().join("").replace(/(\d{3})/g,"$1.").replace(/\.$/,"").split("").reverse().join("")+"-"+digito:t)}}),app.filter("digitos",function(){return function(t){return t||3<=t?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."):t}}),app.filter("capitalize",function(){return function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}});
"use strict";app.factory("json2csv",function(){return{converter_array_csv:function(a){var n,o,e,i,t,c;return null==(c=angular.fromJson(a.data)||null)?null:(i=a.delimita_coluna||";",t=a.delimita_linha||"\n",e=Object.keys(c[0]),a.campos?e.forEach(function(t){-1==a.campos.indexOf(t)&&e.splice(e.indexOf(t),1)}):-1!=e.indexOf("$$hashKey")&&e.splice(e.indexOf("$$hashKey"),1),n="",n+=e.join(i),n+=t,c.forEach(function(a){o=0,e.forEach(function(t){0<o&&(n+=i),null==a[t]&&(a[t]=""),0!=t.indexOf("total")&&0!=t.indexOf("valor")||(a[t]=a[t].toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})),n+=a[t],o++}),n+=t}),n)},nome_arquivo_csv:function(t){var a=t.filtro,n=t.prefixo;return a.data_criado||(n+="-"+moment(new Date).format("YYYY-MM-DD_HH-mm-ss")),angular.forEach(a,function(t,a){t?(-1!=a.indexOf("data_")&&(t=moment(t).format("YYYY-MM-DD")),n+="-"+t):n+="-"+a}),n+=".csv"},download_csv:function(t,a,n){var o,e,i=this.converter_array_csv({data:a,campos:n});null!=i&&(t=this.nome_arquivo_csv(t)||"arquivo.csv",i.match(/^data:text\/csv/i)||(i="data:text/csv;charset=utf-8,"+i),o=encodeURI(i),(e=document.createElement("a")).setAttribute("href",o),e.setAttribute("download",t),document.body.appendChild(e),e.click())}}});
"use strict";!function(e,t,n,s,c,a,i){e.GoogleAnalyticsObject=c,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,a=t.createElement(n),i=t.getElementsByTagName(n)[0],a.async=1,a.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(a,i)}(window,document,"script",0,"ga"),function(e,t,n,s,c,a,i){e.fbq||(c=e.fbq=function(){c.callMethod?c.callMethod.apply(c,arguments):c.queue.push(arguments)},e._fbq||(e._fbq=c),(c.push=c).loaded=!0,c.version="2.0",c.queue=[],(a=t.createElement(n)).async=!0,a.src="https://connect.facebook.net/en_US/fbevents.js",(i=t.getElementsByTagName(n)[0]).parentNode.insertBefore(a,i))}(window,document,"script"),function(e,t,n,s,c,a){e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},e._hjSettings={hjid:1115497,hjsv:6},c=t.getElementsByTagName("head")[0],(a=t.createElement("script")).async=1,a.src="https://static.hotjar.com/c/hotjar-"+e._hjSettings.hjid+".js?sv="+e._hjSettings.hjsv,c.appendChild(a)}(window,document),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js"}();
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,a=!1,n=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var soma=function(e,t){return e+t},multiplica_d1=function(e,t){return e*digitos[t]},multiplica_d2=function(e,t){return e*digitos[t+1]},re_data_inv=/^\d{4}-\d{2}-\d{2}$/,re_dh_inv=/^\d{4}-\d{2}-\d{2}[ T]\d{2}:\d{2}(:\d{2})?$/,re_digitos=/^[\d]+$/,re_nao_digitos=/[^\d]/g,re_nome_discourse=/^\w+$/,re_email=/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/,re_hora=/^\d{2}:\d{2}(:\d{2})?$/,re_str_espaco_acento_numero=/^[a-z0-9áéíóúçãõàâêô\-_\. ]+$/i,re_str_espaco_acento_numero_linha=/^[a-z0-9áéíóúçãõàâêô\-_\.\/:,\n\/# ]+$/i,re_numero_letra_traco_ponto=/^[a-z0-9\.\-]+$/i,re_valida_token=/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/,unidades_data={d:864e5,h:36e5,m:6e4,s:1e3};function inverte_data(e,t,r){return e.split(t).reverse().join(r)}function inverte_data_hora(e,t,r){var i=_slicedToArray(e.split(/[T ]/),2),a=i[0],n=i[1];return inverte_data(a,t,r)+" "+n}app.directive("cep",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"=",buscaCEP:"&",focusSucesso:"@",focusFalha:"@"},link:function(a,e,t,n){function o(e){if(e)switch(e.length){case 1:case 2:return e;case 3:case 4:case 5:return e.replace(/(.{2})(.{1,3})/,"$1.$2");default:return e.replace(/(.{2})(.{3})(.{1,3})/,"$1.$2-$3")}return e}n.$parsers.push(function(e){if(!e)return n.$setValidity("cep",!0),e;var t=(r=e,r.replace(/[^\d]/g,""));var r;if(i=t,n.$setViewValue(o(i)),n.$render(),a.campoTeste&&a.obj[a.campoTeste]!=a.valorTeste)return n.$setValidity("cep",!0),t;var i;return 8==t.length?n.$setValidity("cep",!0):n.$setValidity("cep",!1),t}),n.$formatters.push(o)}}}),app.directive("cpf",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(o,e,t,s){function u(e){if(e)switch(e.length){case 1:case 2:case 3:return e;case 4:case 5:case 6:return e.replace(/(.{3})(.{1,3})/,"$1.$2");case 7:case 8:case 9:return e.replace(/(.{3})(.{3})(.{1,3})/,"$1.$2.$3");default:return e.replace(/(.{3})(.{3})(.{3})(.{1,2})/,"$1.$2.$3-$4")}return e}s.$parsers.push(function(e){if(!e)return s.$setValidity("cpf",!0),e;var t=(r=e,r.replace(/[^\d]/g,""));var r;if(i=t,s.$setViewValue(u(i)),s.$render(),o.campoTeste&&o.obj[o.campoTeste]!=o.valorTeste)return s.$setValidity("cpf",!0),t;var i;if(11!=t.length||"00000000000"==t)return s.$setValidity("cpf",!1),t;var a=[1,2,3,4,5,6,7,8,9],n=t.split("").map(Number);if(a.map(function(e,t){return e*n[t]}).reduce(soma,0)%11%10!=n[9])return s.$setValidity("cpf",!1),t;return a.map(function(e,t){return e*n[t+1]}).reduce(soma,0)%11%10==n[10]?s.$setValidity("cpf",!0):s.$setValidity("cpf",!1),t}),s.$formatters.push(u)}}}),app.directive("cnpj",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(u,e,t,l){function c(e){if(e)switch(e.length){case 1:case 2:return e;case 3:case 4:case 5:return e.replace(/(.{2})(.{1,3})/,"$1.$2");case 6:case 7:case 8:return e.replace(/(.{2})(.{3})(.{1,3})/,"$1.$2.$3");case 9:case 10:case 11:case 12:return e.replace(/(.{2})(.{3})(.{3})(.{1,4})/,"$1.$2.$3/$4");default:return e.replace(/(.{2})(.{3})(.{3})(.{4})(.{1,2})/,"$1.$2.$3/$4-$5")}return e}l.$parsers.push(function(e){if(!e)return l.$setValidity("cnpj",!0),e;var t=(r=e,r.replace(/[^\d]/g,""));var r;if(i=t,l.$setViewValue(c(i)),l.$render(),u.campoTeste&&u.obj[u.campoTeste]!=u.valorTeste)return l.$setValidity("cnpj",!0),t;var i;if(14!=t.length||"00000000000000"==t)return l.$setValidity("cnpj",!1),t;var a=t.split("").map(Number),n=function(e,t){return e*a[t]},o=[5,4,3,2,9,8,7,6,5,4,3,2].map(n).reduce(soma,0)%11;o=o<2?0:11-o;if(o!=a[12])return l.$setValidity("cnpj",!1),t;var s=[6,5,4,3,2,9,8,7,6,5,4,3,2].map(n).reduce(soma,0)%11;s=s<2?0:11-s;return s==a[13]?l.$setValidity("cnpj",!0):l.$setValidity("cnpj",!1),t}),l.$formatters.push(c)}}}),app.directive("conta",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(i,e,t,a){function n(e){return e&&1!=e.length?e.split("").reverse().join("").replace(/(\d{3})/g,"$1.").replace(/\.$/,"").split("").reverse().join(""):e}a.$parsers.push(function(e){if(!e)return a.$setValidity("conta",!0),null;if(i.campoTeste&&i.obj[i.campoTeste]!=i.valorTeste)return a.$setValidity("conta",!0),null;var t=e.replace(/[^\d]/gi,"");return r=t,a.$setViewValue(n(r)),a.$render(),/^\d+$/.test(t)?(a.$setValidity("conta",!0),t):(a.$setValidity("conta",!1),null);var r}),a.$formatters.push(n)}}}),app.directive("contaDv",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(i,e,t,a){function n(e){return e}a.$parsers.push(function(e){if(!e)return a.$setValidity("conta_dv",!0),null;if(i.campoTeste&&i.obj[i.campoTeste]!=i.valorTeste)return a.$setValidity("conta_dv",!0),null;var t=e.replace(/[^\dx]/gi,"");return r=t,a.$setViewValue(n(r)),a.$render(),/^[\dx]$/gi.test(t)?(a.$setValidity("conta_dv",!0),e):(a.$setValidity("conta_dv",!1),null);var r}),a.$formatters.push(n)}}}),app.directive("data",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",diferencaMaiorQue:"@",obj:"="},link:function(d,e,t,p){p.$parsers.push(function(e){if(!e)return p.$setValidity("data",!0),null;var t=(r=e,r.replace(/[^\d]/g,""));var r;if(i=t,p.$setViewValue(function(e){if(e)switch(e.length){case 1:case 2:return e;case 3:case 4:return e.replace(/(.{2})(.{1,2})/,"$1/$2");default:return e.replace(/(.{2})(.{2})(.{1,4})/,"$1/$2/$3")}return e}(i)),p.$render(),d.campoTeste&&d.obj[d.campoTeste]!=d.valorTeste)return p.$setValidity("data",!0),null;var i;if(8!=t.length)return p.$setValidity("data",!1),null;var a=t.replace(/(.{2})(.{2})(.{4})/,"$3-$2-$1"),n=Date.parse(a);{if(isNaN(n)||!re_data_inv.test(a))return p.$setValidity("data",!1),null;p.$setValidity("data",!0)}if(d.diferencaMaiorQue){var o=Date.now(),s=d.diferencaMaiorQue.split(" "),u=_slicedToArray(s,2),l=u[0],c=u[1];return o-n>parseInt(l)*unidades_data[c]?(p.$setValidity("dt_diferenca_maior_que",!0),a):(p.$setValidity("dt_diferenca_maior_que",!1),null)}return a}),p.$formatters.push(function(e){return re_data_inv.test(e)&&!isNaN(Date.parse(e))?inverte_data(e,"-","/"):""})}}}),app.directive("dh",function(){return{restrict:"A",require:"ngModel",scope:{ms:"@dh",campoTeste:"@",valorTeste:"@",diferencaMaiorQue:"@",futura:"@",grupo:"@",obj:"="},link:function(f,e,t,m){m.$parsers.push(function(e){if(!e)return m.$setValidity("dh",!0),null;var t,r=(i=e,i.replace(/[^\d]/g,""));var i;if(a=r,m.$setViewValue(function(e){if(e)switch(e.length){case 1:case 2:return e;case 3:case 4:return e.replace(/(.{2})(.{1,2})/,"$1/$2");case 5:case 6:case 7:case 8:return e.replace(/(.{2})(.{2})(.{1,4})/,"$1/$2/$3");case 9:case 10:return e.replace(/(.{2})(.{2})(.{4})(.{1,2})/,"$1/$2/$3 $4");case 11:case 12:return e.replace(/(.{2})(.{2})(.{4})(.{2})(.{1,2})/,"$1/$2/$3 $4:$5");default:return e.replace(/(.{2})(.{2})(.{4})(.{2})(.{2})(.{1,2})/,"$1/$2/$3 $4:$5:$6")}return e}(a)),m.$render(),f.campoTeste&&f.obj[f.campoTeste]!=f.valorTeste)return m.$setValidity("dh",!0),null;var a;if(14!=r.length&&12!=r.length)return m.$setValidity("dh",!1),null;t=14==r.length?"$3-$2-$1 $4:$5:$6":"$3-$2-$1 $4:$5";var n=r.replace(/(.{2})(.{2})(.{4})(.{2})(.{2})(.{2})?/,t),o=Date.parse(n);{if(isNaN(o)||!re_dh_inv.test(n))return m.$setValidity("dh",!1),null;m.$setValidity("dh",!0)}if(f.diferencaMaiorQue){var s=Date.now(),u=f.diferencaMaiorQue.split(" "),l=_slicedToArray(u,2),c=l[0],d=l[1];return s-o>parseInt(c)*unidades_data[d]?m.$setValidity("dh_diferenca_maior_que",!0):m.$setValidity("dh_diferenca_maior_que",!1),n}if(f.futura){if(0<=["TI","Gestor de Operação"].indexOf(f.grupo))m.$setValidity("dh_futura",!0);else{var s=Date.now(),p=f.futura.split(" "),$=_slicedToArray(p,2),c=$[0],d=$[1];o>s+parseInt(c)*unidades_data[d]?m.$setValidity("dh_futura",!0):m.$setValidity("dh_futura",!1)}return n}return m.$setValidity("dh",!0),n}),m.$formatters.push(function(e){return re_dh_inv.test(e)&&!isNaN(Date.parse(e))?f.ms?inverte_data_hora(e,"-","/"):inverte_data_hora(e,"-","/").split(".")[0]:""})}}}),app.directive("dhfutura",function(){return{restrict:"A",require:"ngModel",scope:{ms:"@dh",campoTeste:"@",valorTeste:"@",diferencaMaiorQue:"@",futura:"@",grupo:"@",obj:"="},link:function($,e,t,f){f.$parsers.push(function(e){"object"==_typeof(e)&&(e=moment(e).format("DD/MM/YYYY HH:mm"));if(!e)return f.$setValidity("dh",!0),null;var t,r=(i=e,i.replace(/[^\d]/g,""));var i;if($.campoTeste&&$.obj[$.campoTeste]!=$.valorTeste)return f.$setValidity("dh",!0),null;if(14!=r.length&&12!=r.length)return f.$setValidity("dh",!1),null;t=14==r.length?"$3-$2-$1 $4:$5:$6":"$3-$2-$1 $4:$5";var a=r.replace(/(.{2})(.{2})(.{4})(.{2})(.{2})(.{2})?/,t),n=Date.parse(a);{if(isNaN(n)||!re_dh_inv.test(a))return f.$setValidity("dh",!1),null;f.$setValidity("dh",!0)}if($.diferencaMaiorQue){var o=Date.now(),s=$.diferencaMaiorQue.split(" "),u=_slicedToArray(s,2),l=u[0],c=u[1];return o-n>parseInt(l)*unidades_data[c]?f.$setValidity("dh_diferenca_maior_que",!0):f.$setValidity("dh_diferenca_maior_que",!1),a}if($.futura){if(0<=["TI","Gestor de Operação"].indexOf($.grupo))f.$setValidity("dh_futura",!0);else{var o=Date.now(),d=$.futura.split(" "),p=_slicedToArray(d,2),l=p[0],c=p[1];n>o+parseInt(l)*unidades_data[c]?f.$setValidity("dh_futura",!0):f.$setValidity("dh_futura",!1)}return a}return f.$setValidity("dh",!0),a}),f.$formatters.push(function(e){return re_dh_inv.test(e)&&!isNaN(Date.parse(e))?$.ms?inverte_data_hora(e,"-","/"):inverte_data_hora(e,"-","/").split(".")[0]:""})}}}),app.directive("digitos",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",maiorQue:"@",menorQue:"@",obj:"="},link:function(i,e,t,a){function n(e){return e?e.toString().split("").reverse().join("").replace(/(\d{3})/g,"$1.").replace(/\.$/,"").split("").reverse().join(""):e}a.$parsers.push(function(e){if(!e)return a.$setValidity("digitos",!0),null;var t=e.replace(re_nao_digitos,"");if(r=t,a.$setViewValue(n(r)),a.$render(),i.campoTeste&&i.obj[i.campoTeste]!=i.valorTeste)return a.$setValidity("digitos",!0),null;var r;if(i.maiorQue)return Number(t)>Number(maiorQue)?(a.$setValidity("digitos_maior_que",!0),t):(a.$setValidity("digitos_maior_que",!1),null);if(i.menorQue)return Number(t)<Number(menorQue)?(a.$setValidity("digitos_menor_que",!0),t):(a.$setValidity("digitos_menor_que",!1),null);return a.$setValidity("digitos",!0),t}),a.$formatters.push(n)}}}),app.directive("digitosFloat",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",maiorQue:"@",menorQue:"@",obj:"="},link:function(i,e,t,a){function n(e){return e?e.toString().split("").reverse().join("").replace(/(\d{2})/g,"$1.").replace(/\.$/,"").split("").reverse().join(""):e}a.$parsers.push(function(e){if(!e)return a.$setValidity("digitos",!0),null;var t=e;if(i.campoTeste&&i.obj[i.campoTeste]!=i.valorTeste)return a.$setValidity("digitos",!0),null;i.maiorQue&&(parseFloat(t)>parseFloat(i.maiorQue)?a.$setValidity("digitos_maior_que",!0):a.$setValidity("digitos_maior_que",!1));i.menorQue&&(parseFloat(t)<parseFloat(i.menorQue)?a.$setValidity("digitos_menor_que",!0):a.$setValidity("digitos_menor_que",!1));return r=t=e.replace(re_nao_digitos,""),a.$setViewValue(n(r)),a.$render(),t;var r}),a.$formatters.push(n)}}}),app.directive("digitosSemPonto",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",maiorQue:"@",menorQue:"@",obj:"="},link:function(i,e,t,a){function n(e){return e?e.split("").reverse().join("").replace(/\.$/,"").split("").reverse().join(""):e}a.$parsers.push(function(e){if(!e)return a.$setValidity("digitos",!0),null;var t=e.replace(re_nao_digitos,"");if(r=t,a.$setViewValue(n(r)),a.$render(),i.campoTeste&&i.obj[i.campoTeste]!=i.valorTeste)return a.$setValidity("digitos",!0),null;var r;if(i.maiorQue)return Number(t)>Number(maiorQue)?(a.$setValidity("digitos_maior_que",!0),t):(a.$setValidity("digitos_maior_que",!1),null);if(i.menorQue)return Number(t)<Number(menorQue)?(a.$setValidity("digitos_menor_que",!0),t):(a.$setValidity("digitos_menor_que",!1),null);return a.$setValidity("digitos",!0),t}),a.$formatters.push(n)}}}),app.directive("email",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("email",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("email",!0),null;return re_email.test(e)?(i.$setValidity("email",!0),e):(i.$setValidity("email",!1),null)})}}}),app.directive("fone",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(a,e,t,n){function o(e){if(e)if(e.length<11)switch(e.length){case 1:case 2:return e.replace(/(.{1,2})/,"($1");case 3:case 4:case 5:case 6:return e.replace(/(.{2})(.{1,4})/,"($1) $2");default:return e.replace(/(.{2})(.{4})(.{1,4})/,"($1) $2-$3")}else switch(e.length){case 1:case 2:return e.replace(/(.{1,2})/,"($1");case 3:return e.replace(/(.{2})(.{1})/,"($1) $2");case 4:case 5:case 6:case 7:return e.replace(/(.{2})(.{1})(.{1,4})/,"($1) $2 $3");default:return e.replace(/(.{2})(.{1})(.{4})(.{1,4})/,"($1) $2 $3-$4")}return e}n.$parsers.push(function(e){if(!e)return n.$setValidity("fone",!0),e;var t=(r=e,r.replace(/[^\d]/g,""));var r;if(i=t,n.$setViewValue(o(i)),n.$render(),a.campoTeste&&a.obj[a.campoTeste]!=a.valorTeste)return n.$setValidity("fone",!0),t;var i;if(t.length<10)return n.$setValidity("fone",!1),t;return n.$setValidity("fone",!0),t}),n.$formatters.push(o)}}}),app.directive("hora",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",testaMenorIgual:"=",menorIgual:"@",horaDiferenteDe:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("hora",!0),null;if(e&&e==t.horaDiferenteDe)return i.$setValidity("hora",!1),null;if(function(e){switch((e=e.replace(/[^\d]/g,"")).length){case 1:case 2:break;default:e=e.replace(/(.{2})(.{1,2})/,"$1:$2")}i.$setViewValue(e),i.$render()}(e),t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("hora",!0),null;{if(moment(e,"HH:mm").format("HH:mm")!=e)return i.$setValidity("hora",!1),null;if(i.$setValidity("hora",!0),t.testaMenorIgual){if(!(moment(e,"HH:mm")<=moment(t.menorIgual,"HH:mm:ss")))return i.$setValidity("menor_igual",!1),null;i.$setValidity("menor_igual",!0)}else i.$setValidity("menor_igual",!0);return e}}),i.$formatters.push(function(e){if(e)return moment(e,"HH:mm:ss").format("HH:mm")})}}}),app.directive("duracao",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",testaMenorIgual:"=",menorIgual:"@",horaDiferenteDe:"@",obj:"="},link:function(r,e,t,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("duracao",!0),null;if(e&&e==r.horaDiferenteDe)return i.$setValidity("duracao",!1),null;if(function(e){switch((e=e.replace(/[^\d]/g,"")).length){case 1:case 2:break;default:e=e.replace(/(.{2})(.{1,2})/,"$1:$2")}i.$setViewValue(e),i.$render()}(e),r.campoTeste&&r.obj[r.campoTeste]!=r.valorTeste)return i.$setValidity("duracao",!0),null;var t=moment.duration(e);{if(t.format("HH:mm")!=e)return i.$setValidity("duracao",!1),null;if(i.$setValidity("duracao",!0),r.testaMenorIgual){if(!(t<=moment.duration(r.menorIgual)))return i.$setValidity("menor_igual",!1),null;i.$setValidity("menor_igual",!0)}else i.$setValidity("menor_igual",!0);return e}}),i.$formatters.push(function(e){if(e)return moment.duration(e).format("HH:mm")})}}}),app.directive("nomeDiscourse",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("nome_discourse",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("nome_discourse",!0),null;return re_nome_discourse.test(e)?(i.$setValidity("nome_discourse",!0),"_"==e.slice(-1)?(i.$setValidity("nome_discourse_termina_",!1),null):(i.$setValidity("nome_discourse_termina_",!0),e)):(i.$setValidity("nome_discourse",!1),null)})}}}),app.directive("naoNulo",function(){return{restrict:"A",require:"ngModel",scope:{},link:function(e,t,r,i){i.$parsers.push(function(e){e.id?i.$setValidity("nao_nulo",!0):i.$setValidity("nao_nulo",!1);return e})}}}),app.directive("numeroLetraTracoPonto",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("numero_letra_traco_ponto",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("numero_letra_traco_ponto",!0),null;return re_numero_letra_traco_ponto.test(e)?(i.$setValidity("numero_letra_traco_ponto",!0),e):(i.$setValidity("numero_letra_traco_ponto",!1),null)})}}}),app.directive("real",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",maiorQue:"@",menorQue:"@",obj:"="},link:function(a,e,t,n){function o(e){if(null==e)return e;if(e=String(e)){var t=_slicedToArray(e.split("."),2),r=t[0],i=t[1];return i||(i="00"),1==i.length&&(i+="0"),r.split("").reverse().join("").replace(/(\d{3})/g,"$1.").replace(/\.$/,"").split("").reverse().join("")+","+i}return e}n.$parsers.push(function(e){if(!e)return n.$setValidity("real",!0),null;var t=e.replace(re_nao_digitos,"");t.length<3&&(t="00"+t);var r=Number(t.slice(0,-2)+"."+t.slice(-2));if(i=r,n.$setViewValue(o(i)),n.$render(),a.campoTeste&&a.obj[a.campoTeste]!=a.valorTeste)return n.$setValidity("real",!0),null;var i;if(a.maiorQue)return r>Number(a.maiorQue)?(n.$setValidity("real_maior_que",!0),r):(n.$setValidity("real_maior_que",!1),null);if(a.menorQue)return r<Number(a.menorQue)?(n.$setValidity("real_menor_que",!0),r):(n.$setValidity("real_menor_que",!1),null);return n.$setValidity("real",!0),r}),n.$formatters.push(o)}}}),app.directive("strEspacoAcentoNumero",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("str_espaco_acento_numero",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("str_espaco_acento_numero",!0),null;return re_str_espaco_acento_numero.test(e)?(i.$setValidity("str_espaco_acento_numero",!0),e):(i.$setValidity("str_espaco_acento_numero",!1),null)})}}}),app.directive("strEspacoAcentoNumeroLinha",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("str_espaco_acento_numero_linha",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("str_espaco_acento_numero_linha",!0),null;return re_str_espaco_acento_numero_linha.test(e)?(i.$setValidity("str_espaco_acento_numero_linha",!0),e):(i.$setValidity("str_espaco_acento_numero_linha",!1),null)})}}}),app.directive("strNomeSobrenome",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("str_nome_sobrenome",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("str_nome_sobrenome",!0),null;return 2<=e.trim().split(" ").length?(i.$setValidity("str_nome_sobrenome",!0),e):(i.$setValidity("str_nome_sobrenome",!1),null)})}}}),app.directive("url",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(!e)return i.$setValidity("url",!0),null;if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("url",!0),null;return/^\/[#a-z0-9_]+(\/[#a-z0-9_]+)*$/.test(e)?(i.$setValidity("url",!0),e):(i.$setValidity("url",!1),null)})}}}),app.directive("vazio",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",valorTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){if(t.campoTeste&&t.obj[t.campoTeste]!=t.valorTeste)return i.$setValidity("vazio",!0),null;return e?(i.$setValidity("vazio",!1),null):(i.$setValidity("vazio",!0),e)})}}}),app.directive("igualCampo",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",obj:"="},link:function(t,e,r,i){i.$parsers.push(function(e){return t.obj[t.campoTeste]!=e?(i.$setValidity("igual_campo",!1),null):(i.$setValidity("igual_campo",!0),e)})}}}),app.directive("validaToken",function(){return{restrict:"A",require:"ngModel",scope:{campoTeste:"@",obj:"="},link:function(e,t,r,i){i.$parsers.push(function(e){return re_valida_token.test(e)?i.$setValidity("token_invalido",!0):i.$setValidity("token_invalido",!1),e})}}});
"use strict";app.factory("adicionaVersao",["config",function(n){return{request:function(r){return-1!=r.url.indexOf(".html")&&-1==r.url.indexOf("tpl.html")&&(n&&n.app_version?r.url=r.url+"?v="+n.app_version:r.url=r.url+"?v="+Date.now()),r}}}]).config(["$httpProvider",function(r){r.interceptors.push("adicionaVersao")}]);
"use strict";app.controller("avaliacao",["$scope","$rootScope","$http","$location","config","$routeParams","$route",function(t,a,o,c,i,l,s){t.avaliacao_resposta=!1,t.avaliacao_atual=1,t.avaliados=0,t.mostra_avaliacao=function(a){a&&t.avaliacao_atual<t.avaliacao.doutores.length&&t.avaliacao_atual++,!a&&0<t.avaliacao_atual&&t.avaliacao_atual--},t.avalia=function(a){t.avaliados++,t.mostra_avaliacao(1)},t.get=function(a){o({url:i.base_url+"/avaliacao?avaliacao="+escape(a.avaliacao)+"&sig="+escape(a.sig),method:"GET"}).success(function(a,o){t.avaliacao=a.dados}).error(function(a,o){t.avaliacao=[],t.avaliacao_resposta={titulo:"Algo deu errado.",texto:a.msg,icone:"bad.svg"}})},t.grava=function(a){t.avaliacao.doutores.filter(function(a){a.nota||a.problema_resolvido}),o({url:i.base_url+"/avaliacao",method:"POST",data:a}).success(function(a,o){t.avaliacao=[],t.avaliacao_resposta={status:"sucesso",titulo:"Avaliação gravada com sucesso!",icone:"good.svg"}}).error(function(a,o){t.avaliacao=[],t.avaliacao_resposta={titulo:"Algo deu errado.",texto:a.erro,icone:"bad.svg"}})},"/avaliacao"==s.current.originalPath&&t.get(l)}]);
"use strict";app.controller("banco",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(c,a,t,o,i,r,n){c.bancos=[],c.lista=function(o){var r=a.otimiza_filtro(o);t({url:i.base_url+"/banco/lista",method:"POST",data:r}).success(function(o,r){c.bancos=o}).error(function(o,r){c.bancos=[],a.erro_portal(o,r)})},c.adiciona=function(o){t({url:i.base_url+"/banco",method:"POST",data:o}).success(function(o,r){a.adiciona_historico(o,r),c.banco={}}).error(function(o,r){a.erro_portal(o,r)})},c.get=function(o){t({url:i.base_url+"/banco/"+o,method:"GET"}).success(function(o,r){c.banco=o}).error(function(o,r){a.erro_portal(o,r)})},c.altera=function(n){t({url:i.base_url+"/banco/"+n.id,method:"PUT",data:n}).success(function(o,r){a.adiciona_historico(o,r),c.get(n.id)}).error(function(o,r){a.erro_portal(o,r)})},c.deleta=function(o){var r=o.id_banco;t({url:i.base_url+"/banco/"+r,method:"DELETE"}).success(function(o,r){a.adiciona_historico(o,r),c.lista(c.filtros)}).error(function(o,r){a.erro_portal(o,r)})},"/banco/:id_banco"==r.current.originalPath&&c.get(n.id_banco)}]);
"use strict";app.controller("banco_ns",["$scope","$rootScope","$http","config","$route","$routeParams",function(c,r,t,s,o,n){c.bancos=[],c.lista_banco=function(){t({url:s.base_url+"/banco/lista",method:"POST"}).success(function(o,n){c.bancos=o}).error(function(o,n){c.bancos=[],r.erro_portal(o,n)})},c.lista=function(o){var n=r.otimiza_filtro(o);t({url:s.base_url+"/banco_ns/lista",method:"POST",data:n}).success(function(o,n){c.bancos_ns=o}).error(function(o,n){c.bancos_ns=[],r.erro_portal(o,n)})},c.adiciona=function(o){console.log(o),t({url:s.base_url+"/banco_ns",method:"POST",data:o}).success(function(o,n){r.adiciona_historico(o.msg,n),c.banco_ns={}}).error(function(o,n){r.erro_portal(o,n)})},c.get=function(o){t({url:s.base_url+"/banco_ns/"+o,method:"GET"}).success(function(o,n){c.banco_ns=o}).error(function(o,n){c.banco_ns={},r.erro_portal(o,n)})},c.altera=function(a){t({url:s.base_url+"/banco_ns/"+a.id,method:"PUT",data:a}).success(function(o,n){r.adiciona_historico(o.msg,n),c.get(a.id)}).error(function(o,n){r.erro_portal(o,n)})},c.desativa=function(o){var n=o.id_banco;t({url:s.base_url+"/banco_ns/"+n,method:"DELETE"}).success(function(o,n){r.adiciona_historico(o.msg,n),c.lista(c.filtros)}).error(function(o,n){r.erro_portal(o,n)})},c.ativa=function(o){var n=o.id_banco;t({url:s.base_url+"/banco_ns/"+n,method:"POST"}).success(function(o,n){r.adiciona_historico(o.msg,n),c.lista(c.filtros)}).error(function(o,n){r.erro_portal(o,n)})},"/banco_ns/:id_banco"==o.current.originalPath&&(c.lista_banco(),c.get(n.id_banco)),"/banco_ns/adiciona"==o.current.originalPath&&(c.lista_banco(),c.banco_ns={})}]);
"use strict";app.controller("base_custo",["$scope","$rootScope","$http","config","$routeParams","$route",function(r,a,c,e,o,t){r.base_custos=[],r.lista=function(o){var t=a.otimiza_filtro(o);c({url:e.base_url+"/base_custo/lista",method:"POST",data:t}).success(function(o,t){r.base_custos=o}).error(function(o,t){r.base_custos=[],a.erro_portal(o,t)})},r.adiciona=function(o){c({url:e.base_url+"/base_custo",method:"POST",data:o}).success(function(o,t){a.adiciona_historico(o,t),r.base_custo={}}).error(function(o,t){a.erro_portal(o,t)})},r.get=function(o){c({url:e.base_url+"/base_custo/"+o,method:"GET"}).success(function(o,t){r.base_custo=o}).error(function(o,t){r.base_custo={},a.erro_portal(o,t)})},r.altera=function(s){c({url:e.base_url+"/base_custo/"+s.id,method:"PUT",data:s}).success(function(o,t){a.adiciona_historico(o,t),r.get(s.id)}).error(function(o,t){a.erro_portal(o,t)})},r.deleta=function(o){var t=o.id_base_custo;c({url:e.base_url+"/base_custo/"+t,method:"DELETE"}).success(function(o,t){a.adiciona_historico(o,t),r.lista(r.filtros)}).error(function(o,t){a.erro_portal(o,t)})},"/base_custo/:id_base_custo"==t.current.originalPath&&r.get(o.id_base_custo),"/base_custo/adiciona"==t.current.originalPath&&(r.base_custo={})}]);
"use strict";app.controller("candidato_doutor",["$scope","$rootScope","$routeParams","$http","$location","config","$route",function(n,i,o,t,r,a,e){n.boas_vindas=!0,n.supporter_candidata_form=!0,n.loader=!1,n.mostra_mensagem_nova=!1,n.candidato_doutores=[],n.bancos=[],n.init=function(){n.doutor={},i.desabilita_endereco()},n.operacao_conta_require=function(o){n.operacao_conta_cef=o.search("104")},n.lista=function(o){var r=i.otimiza_filtro(o);t({url:a.base_url+"/candidato_doutor/lista",method:"POST",data:r}).success(function(o,r){n.candidato_doutores=o}).error(function(o,r){n.candidato_doutores=[],i.erro_portal(o,r)})},n.recandidata=function(){n.mostra_mensagem_nova=!1,n.supporter_candidata_form=!0},n.cadastra=function(o,e){e&&i.mostra_loader(!0),n.supporter_candidata_form=!1,n.loader=!0,n.mostra_mensagem_nova=!1,t({url:a.base_url+"/candidato_doutor",method:"POST",data:o}).success(function(o,r){if(e)return i.mostra_loader(!1),void i.adiciona_historico(o,"sucesso");var t=o.msg;if(o.extra_info&&!_.isEmpty(o.extra_info)){var a=o.extra_info;"string"==typeof a?t+=" "+a:(temp_str="",t+=" - "+Object.entries(a).map(function(o){return o[0]+": "+o[1]}).reduce(function(o,r){return o+r}))}i.tracking_ga(),n.loader=!1,n.mostra_mensagem_nova={status:!0,titulo:"Deu tudo certo!",mensagem:t,icone:"email_sucesso.svg",url_destino:"/#/"}}).error(function(o,r){if(e)return i.mostra_loader(!1),void i.adiciona_historico(o,"erro");n.loader=!1,n.mostra_mensagem_nova={status:!1,titulo:"Algo deu errado!",mensagem:o.msg,icone:"email_erro.svg"}})},n.adiciona=function(e){""==e.logradouro&&delete e.logradouro,""==e.bairro&&delete e.bairro,t({url:a.base_url+"/candidato_doutor/token/"+e.token,method:"POST",data:e}).success(function(o,r){var t=o.msg;if(o.extra_info&&!_.isEmpty(o.extra_info)){var a=o.extra_info;"string"==typeof a?t+=" "+a:(temp_str="",t+=" - "+Object.entries(a).map(function(o){return o[0]+": "+o[1]}).reduce(function(o,r){return o+r}))}i.mostra_mensagem_nova({status:"sucesso",titulo:"Tudo certo com seu cadastro!",mensagem:t,icone:"good.svg",usuario:{login:e.email,senha:e.senha},duracao_redirecionamento:5})}).error(function(o,r){var t=o.msg;if(o.extra_info&&!_.isEmpty(o.extra_info)){var a=o.extra_info;"string"==typeof a?t+=" "+a:(temp_str="",t+=" - "+Object.entries(a).map(function(o){return o[0]+": "+o[1]}).reduce(function(o,r){return o+r}))}i.mostra_mensagem_nova({status:"erro",titulo:"Algo deu errado",mensagem:t,icone:"email_erro.svg"})})},n.deleta=function(o){var r=o.id_candidato_doutor;t({url:a.base_url+"/candidato_doutor/"+r,method:"DELETE"}).success(function(o,r){i.adiciona_historico("Doutor removido com sucesso.",r),n.lista()}).error(function(o,r){i.erro_portal(o,r)})},n.cadastra_doc=function(o){t({url:a.base_url+"/candidato_doutor/token/"+o,method:"GET"}).success(function(o,r){n.doutor.email=o.email,n.doutor.celular=o.celular,n.doutor.nome=o.nome,n.doutor.token=o.token}).error(function(o,r){"Token não encontrado"==o.msg&&i.mostra_mensagem("erro",null,null,"/views/mensagens/erro_form_cadastro_doutor.html")})},n.lista_banco=function(){t({url:a.base_url+"/banco/lista",method:"POST"}).success(function(o,r){n.bancos=o}).error(function(o,r){n.bancos=[],i.erro_portal(o,r)})},"/candidato_supporter/token/:token"==e.current.originalPath&&(n.init(),n.cadastra_doc(o.token),n.lista_banco()),"/candidato_supporter/adiciona"==e.current.originalPath&&n.init()}]);
"use strict";app.controller("cidade_brasil",["$scope","$rootScope","$http","$location","config","$routeParams","$route",function(e,r,c,d,t,a,i){e.cidades=[],e.lista=function(a){var i=r.otimiza_filtro(a);c({url:t.base_url+base_url_cidade,method:"POST",data:i}).success(function(a,i){e.cidades=a}).error(function(a,i){e.cidades=[],r.erro_portal(a,i)})},e.adiciona=function(o){c({url:t.base_url+base_url_cidade,method:"POST",data:o}).success(function(a,i){r.adiciona_historico("Cidade '"+o.cidade+"' gravado com sucesso.",i),e.cidade={}}).error(function(a,i){r.erro_portal(a,i)})},e.get=function(a){c({url:t.base_url+base_url_cidade+"/"+a,method:"GET"}).success(function(a,i){e.cidade=a}).error(function(a,i){r.erro_portal(a,i)})},e.altera=function(o){c({url:t.base_url+base_url_cidade+"/"+o.id,method:"PUT",data:o}).success(function(a,i){r.adiciona_historico("Cidade "+o.nome+"' alterado com sucesso.",i),d.path("/cidade_brasil")}).error(function(a,i){r.erro_portal(a,i)})},e.deleta=function(a){var i=a.id_cidade;c({url:t.base_url+base_url_cidade+"/"+i,method:"DELETE"}).success(function(a,i){r.adiciona_historico("Cidade deletado com sucesso.",i),e.lista()}).error(function(a,i){r.erro_portal(a,i)})},"/cidade_brasil/:id_cidade"==i.current.originalPath&&e.get(a.id_cidade),"/cidade_brasil/adiciona"==i.current.originalPath&&e.init()}]);
"use strict";app.controller("click",["$scope","$rootScope","$http","$location","config","$route","$routeParams","$window",function(a,c,o,e,t,n,s,i){a.msg="Aguardando confirmação",a.status="sucesso",a.get=function(){o({url:t.base_url+"/click/"+a.acao+"?token="+escape(s.token)+"&sig="+escape(s.sig),method:"GET"}).success(function(c,o){a.msg=c.msg}).error(function(c,o){a.status=null,a.msg=c.msg})},"/click/deslocamento"==n.current.originalPath&&(a.acao="deslocamento"),"/click/checkin"==n.current.originalPath&&(a.acao="checkin"),c.modal_confirmacao({cb:a.get,msg:"Deseja confirmar o ".concat(a.acao," ?")})}]);
"use strict";app.controller("cliente",["$scope","$rootScope","$http","$location","config","$routeParams","$route",function(a,t,n,e,c,i,o){a.bases_custo=[{id:null,nome:"SELECIONE"}],a.clientes=[],a.usuarios=[],a.operacoes=[],a.cidade_cliente=[],a.cliente_selecionado=void 0,a.gds=[],a.init=function(e){a.cliente={id_grupo:"cliente",cpf:null,dt_nascimento:null,sexo:null,celular:null,complemento:null,tipo_pessoa:e,valor_faturamento_fixo:0,franquia_deslocamento:0,valor_km_adicional:0,usuario_responsavel:!1,usuario_cliente:!1,cliente_cliente:!1,cadastro_usuario:!1,cadastro_agregado:!1,white_label:!1,limite_cadastro_agregado:0,limite_cadastro_usuario:0,identificador_white_label:null,gds_preferenciais:[]},"fisica"==e&&(a.cliente.razao_social=null,a.cliente.nome_fantasia=null,a.cliente.cnpj=null,a.cliente.tamanho=null,a.cliente.tipo_cliente="individual",a.cliente.cod_chamado_cli_obrigatorio=!1,a.cliente.id_base_custo=3),t.desabilita_endereco(),a.get_gds()},a.get_gds=function(){n({url:c.base_url+"/funcionario/lista",method:"POST",data:{nome_grupo:"Gestor de Demanda",status:"ativo",nucleo_abertura:!1}}).success(function(e,i){a.gds=e}).error(function(e,i){t.erro_portal(e,i)})},a.get_gds(),a.adiciona_gd=function(i){a.cliente.gds_preferenciais=a.cliente.gds_preferenciais.filter(function(e){return e.id_gestor!=i.id}),i.checked?i.checked=!1:(a.cliente.gds_preferenciais.push({id_gestor:i.id}),i.checked=!0)},a.get_cadastro_agregado=function(e){if("ilimitado"==e)return a.form.quantidade_agregado.$setValidity("invalid",!0),void(a.limite_cadastro_agregado=0);return/^\d+$/.test(e)?void 0:(a.form.quantidade_agregado.$setValidity("invalid",!1),void t.erro_portal("A quantidade de agregados deve ser um  número inteiro ou a palavra 'ilimitado'",400))},a.get_cadastro_usuario=function(e,i){if("ilimitado"==e)return a.form.quantidade_usuario.$setValidity("invalid",!0),void(a.limite_cadastro_usuario=0);1!=i&&(a.quantidade_usuario="");return/^\d+$/.test(e)?void 0:(a.form.quantidade_usuario.$setValidity("invalid",!1),void t.erro_portal("A quantidade de usuário deve ser um número inteiro ou a palavra 'ilimitado'",400))},a.get_white_label=function(e){1!=white_label&&(a.identificador_white_label=null)},a.init_usuario=function(){a.usuario_cliente={id_operacao:void 0,nome:null,login:null}},a.init_operacao=function(){a.operacao_cliente={}},a.lista=function(e,o){var i=t.otimiza_filtro(e);!i.data_inicio|!i.data_fim&&(i.data_inicio=null,i.data_fim=null),n({url:c.base_url+"/cliente/lista",method:"POST",data:{nome:i.nome,status:i.status,cpf_cnpj:i.cpf_cnpj,engajamento:{data_inicio:i.data_inicio,data_fim:i.data_fim}}}).success(function(e,i){o&&e.splice(0,0,{id:void 0,nome_cliente:"SELECIONE"}),a.clientes=e}).error(function(e,i){a.clientes=[],t.erro_portal(e,i)})},a.seleciona_cliente=function(e){e.selecionado?(e.selecionado=!1,a.init(),a.usuarios=[],a.operacoes=[]):(a.clientes.filter(function(e){return e.selecionado=!1}),e.selecionado=!0,a.cliente=e,a.lista_usuario(e.id),a.lista_operacao(e.id))},a.get=function(e){n({url:c.base_url+"/cliente/"+e,method:"GET"}).success(function(e,i){(a.cliente=e).gds_preferenciais.map(function(i){a.gds.map(function(e){e.id==i.id_gestor&&(e.checked=!0)})})}).error(function(e,i){t.erro_portal(e,i)})},a.get_meus_dados=function(){n({url:c.base_url+"/cliente/meu",method:"GET"}).success(function(e,i){a.cliente=e}).error(function(e,i){t.erro_portal(e,i)})},a.adiciona=function(o){n({url:c.base_url+"/cliente",method:"POST",data:o}).success(function(e,i){t.adiciona_historico(e,i),a.init(o.tipo_pessoa)}).error(function(e,i){t.erro_portal(e,i)})},a.altera=function(o){n({url:c.base_url+"/cliente/"+o.id,method:"PUT",data:o}).success(function(e,i){t.adiciona_historico(e,i),a.get(o.id)}).error(function(e,i){t.erro_portal(e,i)})},a.desativa=function(e){var i=e.id_cliente;n({url:c.base_url+"/cliente/"+i,method:"DELETE"}).success(function(e,i){t.adiciona_historico(e,i),a.lista(a.filtros)}).error(function(e,i){t.erro_portal(e,i)})},a.ativa=function(e){n({url:c.base_url+"/cliente/"+e+"/status",method:"PUT"}).success(function(e,i){t.adiciona_historico(e,i),a.lista(a.filtros)}).error(function(e,i){t.erro_portal(e,i)})},a.lista_usuario=function(e){n({url:c.base_url+"/cliente/"+e+"/usuario/lista",method:"POST"}).success(function(e,i){e.splice(0,0,{id:null,nome:"SELECIONE"}),a.usuarios=e,a.operacao&&a.seleciona_operacao(a.operacao,!0)}).error(function(e,i){t.erro_portal(e,i),a.usuarios=[]})},a.adiciona_usuario=function(e){e.id_operacao||(e.id_operacao=null),n({url:c.base_url+"/cliente/"+a.cliente.id+"/usuario",method:"POST",data:e}).success(function(e,i){t.adiciona_historico(e,i),a.init_usuario()}).error(function(e,i){t.erro_portal(e,i)})},a.get_usuario=function(e,i){n({url:c.base_url+"/cliente/"+e+"/usuario/"+i,method:"GET"}).success(function(e,i){null===e.id_operacao&&(e.id_operacao=void 0),a.usuario_cliente=e}).error(function(e,i){t.erro_portal(e,i)})},a.altera_usuario=function(o){n({url:c.base_url+"/cliente/"+o.id_cliente+"/usuario/"+o.id,method:"PUT",data:o}).success(function(e,i){a.get_usuario(o.id_cliente,o.id)}).error(function(e,i){t.erro_portal(e,i)})},a.desativa_usuario=function(e){var i=e.id_usuario;n({url:c.base_url+"/cliente/"+a.cliente.id+"/usuario/"+i,method:"DELETE"}).success(function(e,i){a.lista_usuario(a.cliente.id)}).error(function(e,i){t.erro_portal(e,i)})},a.ativa_usuario=function(e){n({url:c.base_url+"/cliente/"+a.cliente.id+"/usuario/"+e+"/status",method:"PUT"}).success(function(e,i){a.lista_usuario(a.cliente.id)}).error(function(e,i){t.erro_portal(e,i)})},a.remove_usuario_operacao=function(e){n({url:c.base_url+"/cliente/"+e.id_cliente+"/usuario/"+e.id+"/operacao",method:"DELETE",data:e}).success(function(e,i){a.lista_usuario(a.cliente.id)}).error(function(e,i){t.erro_portal(e,i)})},a.seleciona_operacao=function(i,e){i.selecionado&&!e?(i.selecionado=!1,a.operacao=null,a.usuarios.filter(function(e){return e.visivel=!1})):(a.operacoes.filter(function(e){return e.selecionado=!1}),i.selecionado=!0,a.operacao=i,a.usuarios.filter(function(e){return e.id_operacao==i.id?e.visivel=!1:e.visivel=!0}))},a.lista_operacao=function(e,o){n({url:c.base_url+"/cliente/"+e+"/operacao/lista",method:"POST"}).success(function(e,i){o&&e.splice(0,0,{id:void 0,nome:"SELECIONE"}),a.operacoes=e}).error(function(e,i){t.erro_portal(e,i),a.operacoes=[{id:void 0,nome:"SELECIONE"}]})},a.adiciona_operacao=function(e){n({url:c.base_url+"/cliente/"+a.cliente.id+"/operacao",method:"POST",data:e}).success(function(e,i){t.adiciona_historico(e,i),a.init_operacao()}).error(function(e,i){t.erro_portal(e,i)})},a.get_operacao=function(e,i){n({url:c.base_url+"/cliente/"+e+"/operacao/"+i,method:"GET"}).success(function(e,i){a.operacao_cliente=e}).error(function(e,i){a.operacao_cliente={},t.erro_portal(e,i)})},a.altera_operacao=function(o){n({url:c.base_url+"/cliente/"+a.cliente.id+"/operacao/"+o.id,method:"PUT",data:o}).success(function(e,i){a.get_operacao(o.id_cliente,o.id)}).error(function(e,i){t.erro_portal(e,i)})},a.desativa_operacao=function(e){var i=e.id_operacao;n({url:c.base_url+"/cliente/"+a.cliente.id+"/operacao/"+i,method:"DELETE"}).success(function(e,i){a.lista_operacao(a.cliente.id)}).error(function(e,i){t.erro_portal(e,i)})},a.ativa_operacao=function(e){n({url:c.base_url+"/cliente/"+a.cliente.id+"/operacao/"+e+"/status",method:"PUT"}).success(function(e,i){a.lista_operacao(a.cliente.id)}).error(function(e,i){t.erro_portal(e,i)})},a.atualiza_freq_fat_fixo=function(e){"fixo"==e?a.cliente.frequencia="recorrente":a.cliente.valor_faturamento_fixo=0},a.atualiza_franq_km_adicional=function(e){3==e&&(a.cliente.franquia_deslocamento=0,a.cliente.valor_km_adicional=0)},a.seleciona_estado=function(e){e.selecionado?(e.selecionado=!1,a.cidade_estado=[]):(a.opcoes.estado.filter(function(e){return e.selecionado=!1}),e.selecionado=!0,a.lista_cidade_estado({estado:e.sigla}))},a.seleciona_cidade=function(e){e.selecionado?e.selecionado=!1:(a.cidade_estado.filter(function(e){return e.selecionado=!1}),e.selecionado=!0)},a.lista_cidade_cliente=function(e){e?n({url:c.base_url+"/cidade_cliente/lista",method:"POST",data:{id_cliente:e}}).success(function(e,i){a.cidade_cliente=e,a.filtra_cidade_cliente()}).error(function(e,i){t.erro_portal(e,i),a.cidade_cliente=[]}):(a.cidade_cliente=[],a.cidade_estado=[],a.opcoes.estado.filter(function(e){return e.selecionado=!1}))},a.lista_cidade_estado=function(e){n({url:c.base_url+"/cidade_brasil/lista",method:"POST",data:e}).success(function(e,i){a.cidade_estado=e,a.filtra_cidade_cliente()}).error(function(e,i){t.erro_portal(e,i),a.cidade_estado=[]})},a.filtra_cidade_cliente=function(){a.cidade_estado&&a.cidade_estado.forEach(function(i){a.cidade_cliente.find(function(e){return e.id_cidade==i.id})?i.invisivel=!0:i.invisivel=!1})},a.adiciona_cidade_cliente=function(e,o){n({url:c.base_url+"/cidade_cliente",method:"POST",data:{id_cidade:e,id_cliente:o}}).success(function(e,i){t.adiciona_historico(e,i),a.lista_cidade_cliente(o)}).error(function(e,i){t.erro_portal(e,i)})},a.remove_cidade_cliente=function(e,o){n({url:c.base_url+"/cidade_cliente/"+e.id,method:"DELETE"}).success(function(e,i){t.adiciona_historico(e,i),a.lista_cidade_cliente(o)}).error(function(e,i){t.erro_portal(e,i)})},a.lista_base_custo=function(o){n({url:c.base_url+"/base_custo/lista",method:"POST"}).success(function(e,i){o&&e.splice(0,0,{id:void 0,nome:"SELECIONE"}),a.bases_custo=e}).error(function(e,i){a.bases_custo=[],t.erro_portal(e,i)})},"/cliente/adiciona/:tipo_pessoa"==o.current.originalPath&&(a.lista_base_custo(!0),a.init(i.tipo_pessoa)),"/cliente/:id_cliente"==o.current.originalPath&&(a.lista_base_custo(!0),a.get(i.id_cliente)),"/cliente/meus_dados"==o.current.originalPath&&a.get_meus_dados(),"/cliente/cidade_cliente"==o.current.originalPath&&a.lista({tipo_pessoa:"juridica",status:"ativo",tipo_cliente:"grande"},!0),"/cliente/:id_cliente/usuario/adiciona"==o.current.originalPath&&(a.init_usuario(),a.get(i.id_cliente),a.lista_operacao(i.id_cliente,!0)),"/cliente/:id_cliente/usuario/:id_usuario"==o.current.originalPath&&(a.get(i.id_cliente),a.lista_operacao(i.id_cliente,!0),a.get_usuario(i.id_cliente,i.id_usuario)),"/cliente/:id_cliente/operacao/adiciona"==o.current.originalPath&&(a.init_operacao(),a.get(i.id_cliente)),"/cliente/:id_cliente/operacao/:id_operacao"==o.current.originalPath&&(a.get(i.id_cliente),a.get_operacao(i.id_cliente,i.id_operacao))}]);
"use strict";app.controller("cliente_cliente",["$scope","$rootScope","$http","$location","config","$timeout","$routeParams","$route",function(n,c,l,e,o,i,t,r){n.clientes=[],n.cliente_clientes=[],n.limpa_filtros=function(){n.filtros={nome:null,id_cliente:null}},n.init=function(){n.cliente_cliente={nome:null,id_cliente:null}},n.limpa_filtros(),n.lista=function(e){var i=c.otimiza_filtro(e);l({url:o.base_url+"/cliente_cliente/lista",method:"POST",data:i}).success(function(e,i){n.cliente_clientes=e}).error(function(e,i){n.cliente_clientes=[],c.erro_portal(e,i)})},n.lista_clientes=function(t){l({url:o.base_url+"/cliente/lista",method:"POST"}).success(function(e,i){t&&e.splice(0,0,{id:null,nome_cliente:"SELECIONE"}),n.clientes=e}).error(function(e,i){n.clientes=[],c.erro_portal(e,i)})},n.adiciona=function(e){l({url:o.base_url+"/cliente_cliente",method:"POST",data:e}).success(function(e,i){c.adiciona_historico(e,i),n.init()}).error(function(e,i){c.erro_portal(e,i)})},n.get=function(e){l({url:o.base_url+"/cliente_cliente/"+e,method:"GET"}).success(function(e,i){n.cliente_cliente=e}).error(function(e,i){c.erro_portal(e,i)})},n.altera=function(t){l({url:o.base_url+"/cliente_cliente/"+t.id,method:"PUT",data:t}).success(function(e,i){c.adiciona_historico(e,i),n.get(t.id)}).error(function(e,i){c.erro_portal(e,i)})},n.deleta=function(e){var i=e.id_cliente_cliente;l({url:o.base_url+"/cliente_cliente/"+i,method:"DELETE"}).success(function(e,i){c.adiciona_historico(e,i),n.lista(n.filtros)}).error(function(e,i){c.erro_portal(e,i)})},n.ativa=function(e){l({url:o.base_url+"/cliente_cliente/"+e+"/status",method:"PUT"}).success(function(e,i){c.adiciona_historico(e,i),n.lista()}).error(function(e,i){c.erro_portal(e,i)})},n.lista_clientes(!0),"/cliente_cliente/:id_cliente_cliente"==r.current.originalPath&&n.get(t.id_cliente_cliente),"/cliente_cliente/adiciona"==r.current.originalPath&&n.init()}]);
"use strict";app.controller("cliente_integracao",["$scope","$rootScope","$http","config","$routeParams","$route","$window","$location",function(e,t,i,n,r,o,a,c){e.integracoes=[],e.adiciona=function(o){i({url:n.base_url+"/cliente_integracao",method:"POST",data:o}).success(function(o,r){t.adiciona_historico(o,r),c.path("/cliente/integracao/"+o.id)}).error(function(o,r){t.erro_portal(o,r)})},e.lista=function(o){i({url:n.base_url+"/cliente_integracao/lista",data:o,method:"POST"}).success(function(o,r){e.integracoes=o}).error(function(o,r){e.integracoes=[],t.erro_portal(o,r)})},e.get=function(o){i({url:n.base_url+"/cliente_integracao/"+o,method:"GET"}).success(function(o,r){e.integracao=o}).error(function(o,r){t.erro_portal(o,r)})},e.altera=function(a){i({url:n.base_url+"/cliente_integracao/"+a.id,method:"PUT",data:a}).success(function(o,r){t.adiciona_historico(o,r),e.get(a.id)}).error(function(o,r){t.erro_portal(o,r)})},e.deleta=function(o){var r=o.id_integracao;i({url:n.base_url+"/cliente_integracao/"+r,method:"DELETE"}).success(function(o,r){t.adiciona_historico(o,r),e.lista()}).error(function(o,r){t.erro_portal(o,r)})},e.remove_tokens=function(o){var r=o.id_integracao;i({url:n.base_url+"/cliente_integracao/"+r+"/token",method:"DELETE"}).success(function(o,r){t.adiciona_historico(o,r),e.lista()}).error(function(o,r){t.erro_portal(o,r)})},e.verifica_autorizacao=function(o){i({url:n.base_url+"/cliente_integracao/verifica_autorizacao",method:"POST",data:o}).success(function(o,r){e.autorizacao=o}).error(function(o,r){t.erro_portal(o,r)})},e.autoriza=function(o){i({url:n.base_url+"/cliente_integracao/autoriza",method:"POST",data:o}).success(function(o,r){t.erro_portal("Acesso autorizado com sucesso. Redirecionando para sistema de origem...",r),a.location.href=o.url}).error(function(o,r){t.erro_portal(o,r)})},e.bloqueia=function(o){i({url:n.base_url+"/cliente_integracao/bloqueia",method:"POST",data:o}).success(function(o,r){t.erro_portal("Acesso bloqueado!! Redirecionando para sistema de origem...",r),console.log(o),a.location.href=o.url}).error(function(o,r){t.erro_portal(o,r)})},"/cliente/integracao/verifica_autorizacao"==o.current.originalPath&&(parametros_faltantes=[],parametros_obrigatorios=["client_id","response_type","redirect_uri","scope","state"],parametros_obrigatorios.forEach(function(o){r[o]||parametros_faltantes.push(o)}),0==parametros_faltantes.length?e.verifica_autorizacao(r):alert("Os seguintes campos são obrigatórios e não foram informados: "+parametros_faltantes.join(", "))),"/cliente/integracao/:id_integracao"==o.current.originalPath&&e.get(r.id_integracao)}]);
"use strict";function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,n=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return n=e.done,e},e:function(e){a=!0,i=e},f:function(){try{n||null==r.return||r.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}app.controller("cursos",["$scope","$rootScope","$http","config","$routeParams","$route",function(m,_,f,p,v,e){m.curso=JSON.parse(localStorage.getItem("curso"))||{},m.cursos=[],m.clientes=[],m.cliente_cliente=[],m.tipos_atendimento=[{id:1,nome:"Alocação"},{id:2,nome:"Atendimento"}],m.tipos_servico=[],m.check={clientes:!1,cliente_cliente:!1,tipos_atendimento:!1,tipos_servico:!1},m.payload={conclusao_obrigatoria:m.curso.conclusao_obrigatoria,status:"Em Uso"===m.curso.status,clientes:[],cliente_cliente:[],tipos_atendimento:[],tipos_servico:[]},m.lista=function(){f({url:p.base_url+"/dependencia_curso/lista",method:"GET"}).success(function(e){m.cursos=e}).error(function(e,t){_.erro_portal(e,t)})},m.salvar_curso=function(e){m.curso=e,localStorage.setItem("curso",JSON.stringify(e))},m.apagarCurso=function(e){var t=e.id;f({url:p.base_url+"/dependencia_curso/"+t,method:"DELETE"}).success(function(e){m.cursos=m.cursos.filter(function(e){return e.id!=t})}).error(function(e,t){_.erro_portal(e,t)})},m.detalha=function(){f({url:p.base_url+"/cliente/lista/cliente_cliente",method:"GET"}).success(function(e){m.clientes=e;var t=[];for(var o in m.clientes){var r=m.clientes[o];if(Array.isArray(m.curso.clientes)&&(0===m.curso.clientes.length&&(m.check.clientes=!0,m.adiciona_todos("clientes")),0<m.curso.clientes.length&&m.curso))for(var i in m.curso.clientes)m.curso.clientes[i]==r.id&&m.adiciona(r,"clientes");if(Array.isArray(m.curso.clientes_dos_clientes)&&(0===m.curso.clientes_dos_clientes.length&&(m.check.cliente_cliente=!0,m.adiciona_todos("cliente_cliente")),0<m.curso.clientes_dos_clientes.length))for(var n in r.clientes){var a,c=_createForOfIteratorHelper(m.curso.clientes_dos_clientes);try{for(c.s();!(a=c.n()).done;){a.value==r.clientes[n].id&&(r.clientes[n].id_cliente=r.id,m.adiciona(r.clientes[n],"cliente_cliente"))}}catch(e){c.e(e)}finally{c.f()}}var s,l=_createForOfIteratorHelper(m.tipos_servico);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(Array.isArray(m.curso.tipo_servico)){var d,_=_createForOfIteratorHelper(m.curso.tipo_servico);try{for(_.s();!(d=_.n()).done;){var f=d.value;f!=u.nome||t.includes(f)||(t.push(f),m.adiciona(u,"tipos_servico"))}}catch(e){_.e(e)}finally{_.f()}}}}catch(e){l.e(e)}finally{l.f()}Array.isArray(m.curso.tipo_servico)&&0===m.curso.tipo_servico.length&&(m.check.tipos_servico=!0,m.adiciona_todos("tipos_servico"))}0==m.curso.tipo_atendimento.length&&(m.check.tipos_atendimento=!0,m.adiciona_todos("tipos_atendimento")),"alocacao"==m.curso.tipo_atendimento&&(m.adiciona({id:1,nome:"Alocação"},"tipos_atendimento"),m.tipos_atendimento[0].active=!0),"atendimento"==m.curso.tipo_atendimento&&(m.adiciona({id:2,nome:"Atendimento"},"tipos_atendimento"),m.tipos_atendimento[1].active=!0),m.cliente_cliente=m.cliente_cliente,m.tipos_atendimento=m.tipos_atendimento,m.tipos_servico=m.tipos_servico}).error(function(e,t){_.erro_portal(e,t)})},m.adiciona_todos=function(e){if(e)if(m.check[e]){var t,o=_createForOfIteratorHelper(m[e]);try{for(o.s();!(t=o.n()).done;){var r=t.value;m.adiciona(r,e,!0)}}catch(e){o.e(e)}finally{o.f()}}else{var i,n=_createForOfIteratorHelper(m[e]);try{for(n.s();!(i=n.n()).done;){var a=i.value;m.remove(a,e)}}catch(e){n.e(e)}finally{n.f()}}},m.adiciona=function(e,t,o){if(!e.active||o){var r,i=!(e.active=!0),n=_createForOfIteratorHelper(m.payload[t]);try{for(n.s();!(r=n.n()).done;){r.value.id==e.id&&(i=!0)}}catch(e){n.e(e)}finally{n.f()}if(i||m.payload[t].push(e),"clientes"==t){if(e.clientes){var a,c=_createForOfIteratorHelper(e.clientes);try{for(c.s();!(a=c.n()).done;){var s,l=a.value,u=!1,d=_createForOfIteratorHelper(m.cliente_cliente);try{for(d.s();!(s=d.n()).done;){s.value.id==l.id&&(u=!0)}}catch(e){d.e(e)}finally{d.f()}u||(l.id_cliente=e.id,m.cliente_cliente.push(l))}}catch(e){c.e(e)}finally{c.f()}}if(e.tipos_servico){var _,f=_createForOfIteratorHelper(e.tipos_servico);try{for(f.s();!(_=f.n()).done;){var p,v=_.value,y=!1,h=_createForOfIteratorHelper(m.tipos_servico);try{for(h.s();!(p=h.n()).done;){p.value.id==v.id&&(y=!0)}}catch(e){h.e(e)}finally{h.f()}y||m.tipos_servico.push(v)}}catch(e){f.e(e)}finally{f.f()}}}}else m.remove(e,t)},m.remove=function(t,e){if(t.active=!1,m.check[e]=!1,m.payload[e]=m.payload[e].filter(function(e){return e.id!=t.id}),"clientes"==e){m.cliente_cliente=m.cliente_cliente.filter(function(e){return e.id_cliente!=t.id}),m.payload.cliente_cliente=m.payload.cliente_cliente.filter(function(e){return e.id_cliente!=t.id}),m.tipos_servico=[],m.payload.tipos_servico=[];var o,r=_createForOfIteratorHelper(m.payload.clientes);try{for(r.s();!(o=r.n()).done;){var i,n=_createForOfIteratorHelper(o.value.tipos_servico);try{for(n.s();!(i=n.n()).done;){var a,c=i.value,s=!1,l=_createForOfIteratorHelper(m.tipos_servico);try{for(l.s();!(a=l.n()).done;){a.value.id==c.id&&(s=!0)}}catch(e){l.e(e)}finally{l.f()}s||m.tipos_servico.push(c)}}catch(e){n.e(e)}finally{n.f()}}}catch(e){r.e(e)}finally{r.f()}m.tipos_servico=m.tipos_servico;var u,d=[],_=_createForOfIteratorHelper(m.tipos_servico);try{for(_.s();!(u=_.n()).done;){var f=u.value;if(Array.isArray(m.curso.tipo_servico)){var p,v=_createForOfIteratorHelper(m.curso.tipo_servico);try{for(v.s();!(p=v.n()).done;){var y=p.value;y!=f.nome||d.includes(y)||(d.push(y),f.active=!1,m.adiciona(f,"tipos_servico"))}}catch(e){v.e(e)}finally{v.f()}}}}catch(e){_.e(e)}finally{_.f()}}},m.gravar=function(){var e=!1;m.check.tipos_servico||0!==m.payload.tipos_servico.length||(e=!0,_.mostra_mensagem("erro","Necessário selecionar algum Tipo de Serviço")),m.check.tipos_atendimento||0!==m.payload.tipos_atendimento.length||(e=!0,_.mostra_mensagem("erro","Necessário selecionar algum Tipo de atendimento")),!m.check.cliente_cliente&&0===m.payload.cliente_cliente.length&&0<m.cliente_cliente.length&&(e=!0,_.mostra_mensagem("erro","Necessário selecionar algum Cliente de Cliente")),m.check.clientes||0!==m.payload.clientes.length||(e=!0,_.mostra_mensagem("erro","Necessário selecionar algum Cliente"));var t=[];if(1==m.payload.tipos_atendimento.length&&("Alocação"==m.payload.tipos_atendimento[0].nome?t.push("alocacao"):t.push("atendimento")),!e){var o={clientes:[],clientes_dos_clientes:[],tipo_atendimento:t,tipo_servico:[],conclusao_obrigatoria:m.payload.conclusao_obrigatoria,status:m.payload.status?"Em Uso":"Sem Uso",etag:m.curso.etag};if(0<m.payload.clientes.length&&m.payload.clientes.length<m.clientes.length){var r,i=_createForOfIteratorHelper(m.payload.clientes);try{for(i.s();!(r=i.n()).done;){var n=r.value;o.clientes.push(n.id)}}catch(e){i.e(e)}finally{i.f()}}if(0<m.payload.cliente_cliente.length&&m.payload.cliente_cliente.length<m.cliente_cliente.length){var a,c=_createForOfIteratorHelper(m.payload.cliente_cliente);try{for(c.s();!(a=c.n()).done;){var s=a.value;o.clientes_dos_clientes.push(s.id)}}catch(e){c.e(e)}finally{c.f()}}if(0<m.payload.tipos_servico.length&&m.payload.tipos_servico.length<m.tipos_servico.length){var l,u=_createForOfIteratorHelper(m.payload.tipos_servico);try{for(u.s();!(l=u.n()).done;){var d=l.value;o.tipo_servico.push(d.nome)}}catch(e){u.e(e)}finally{u.f()}}f({url:p.base_url+"/dependencia_curso/"+v.id_curso,method:"PUT",data:o}).success(function(e){_.mostra_mensagem("sucesso","Dependencia de curso gravado com sucesso"),window.location="/#/cursos"}).error(function(e,t){_.erro_portal(e,t)})}},"/cursos"==e.current.originalPath&&m.lista(),"/cursos/:id_curso"==e.current.originalPath&&m.detalha(v.id_curso)}]);
"use strict";app.controller("dashboard",["$scope","$http","$rootScope","$timeout","$interval","config","$location",function(t,a,n,e,o,s,i){var r=i.path();t.filtros={clientes:[],cliente_cliente:[],status:[],sla:[],gestores:[]},t.jobs=[],t.cliente_cliente=[],t.clientes=[],t.gestores=[],t.referencias="off",t.filtra=function(e){t.get_jobs(e)},t.get_jobs=function(e){var o=n.otimiza_filtro(e);angular.equals({},o)&&(o={status_simplificado:["aberto","andamento"]}),a({url:s.base_url+"/job/novo_lista",method:"POST",data:o}).success(function(e,o){t.jobs=e}).error(function(e,o){t.jobs=[],404!=o&&n.erro_portal(e,o)})},t.get_clientes=function(){a({url:s.base_url+"/cliente/lista",method:"POST",data:{status:"ativo"}}).success(function(e,o){t.clientes=e}).error(function(e,o){t.clientes=[],n.erro_portal(e,o)})},t.get_cliente_cliente=function(e){e!=[]?a({url:s.base_url+"/cliente_cliente/lista",method:"POST",data:{id_cliente:e}}).success(function(e,o){t.cliente_cliente=e}).error(function(e,o){n.erro_portal(e,o),t.cliente_cliente=[]}):t.cliente_cliente=[]},t.get_gestores=function(){a({url:s.base_url+"/funcionario/lista",method:"POST",data:{id_grupo:3}}).success(function(e,o){t.gestores=e}).error(function(e,o){t.gestores=[],n.erro_portal(e,o)})},t.mostra_referencias=function(){"off"==t.referencias?t.referencias="on":t.referencias="off"},t.get_acompanha_job=function(){a({url:s.base_url+"/job/dashboard2",method:"GET"}).success(function(e,o){t.pendencias_imediatas=e.pendencias_imediatas,t.pendencias_demoradas=e.pendencias_demoradas}).error(function(e,o){n.erro_portal(e,o)})},"/dashboard"==r&&("Cliente"!=n.usuario_logado.grupo?(t.get_clientes(),t.get_gestores()):t.get_cliente_cliente([n.usuario_logado.id_cliente]),t.get_jobs(t.filtros),"doutor"!=n.usuario_logado.perfil&&(t.dashabord_get_jobs=o(function(){t.get_jobs(t.filtros)},1e3*s.tempo_atualizacao_rotinas*20))),"/supporter/dashboard"==r&&t.get_jobs(t.filtros),0<=r.indexOf("/acompanha_job")&&(t.get_acompanha_job(),"funcionario"==n.usuario_logado.perfil&&(t.dashabord2_get_jobs=o(function(){t.get_acompanha_job()},1e3*s.tempo_atualizacao_rotinas))),t.$on("$destroy",function(){o.cancel(t.dashabord_get_jobs),o.cancel(t.dashabord2_get_jobs)}),n.chat()}]);
"use strict";app.controller("doutor",["$scope","$routeParams","$route","$rootScope","$http","$location","config","Upload","$q","$window",function(t,o,e,i,n,r,d,a,c,u){t.doutores=[],t.bancos=[],t.doutor_arquivos=[],t.competencias_disponiveis=[],t.competencias_selecionadas=[],t.candidato_jobs=[],t.especialidade_selecionada=0,t.area_selecionada=0,t.competencia_selecionada=0,t.descricao_competencia="",t.historico_doutor=[],t.cidade_doutor=[],t.pendencias_doutor=[],t.termo_antigo=!1,t.init_doutor=function(){t.doutor={complemento:null,cnpj:null,razao_social:null,dv_agencia_banco:null,operacao_conta:null},t.limpa_banco(),i.desabilita_endereco()},t.init_arquivo=function(){t.doutor_arquivo={}},t.init_pendencia_doutor=function(){t.pendencia_doutor={id_doutor:null,operacao:null},t.pendencia={descricao:null}},t.operacao_conta_require=function(o){t.operacao_conta_cef=o.search("104")},t.tipo_documento_require=!1,t.tipo_documento=function(a){t.remove_previa_arquivo_doutor(),t.doutor_arquivo.subtipo_arquivo="",0<=["1_id_doutor","4_self_doutor_doc"].indexOf(a)?t.tipo_documento_require=!0:t.tipo_documento_require=!1,t.opcoes.tipo_documento.filter(function(o){o.valor==a&&(t.documento_descricao=o.desc)})},t.verifica_tipo_arquivo=function(o){var a,e;(t.arquivo_tamanho_nao_suportado=!1,t.tipo_arquivo_invalido=!1,o)&&(a=2e6<o.size?(t.arquivo_tamanho_nao_suportado=!0,"tamanho do arquivo maior que permitido, deve ter no máximo 2MB"):"",e=o&&["image/jpg","image/jpeg","image/png","application/pdf"].indexOf(o.type)<=0?(t.tipo_arquivo_invalido=!0,"formato do arquivo não permitido. Arquivo deve ser imagem nos formatos JPG ou PNG ou um PDF."):"",(t.arquivo_tamanho_nao_suportado||t.tipo_arquivo_invalido)&&i.erro_portal("Arquivo Inválido: "+e+a,404))},t.lista=function(o){var a=i.otimiza_filtro(o);n({url:d.base_url+"/doutor/lista",method:"POST",data:a}).success(function(o,a){t.doutores=o}).error(function(o,a){t.doutores=[],i.erro_portal(o,a)})},t.adiciona=function(o){o.usuario_discourse=null,n({url:d.base_url+"/doutor",method:"POST",data:o}).success(function(o,a){i.adiciona_historico(o,a),t.init_doutor()}).error(function(o,a){i.erro_portal(o,a)})},t.detalha=function(o){n({url:d.base_url+"/doutor/"+o,method:"GET"}).success(function(o,a){t.doutor=o}).error(function(o,a){i.erro_portal(o,a)})},t.altera=function(e,r){n({url:d.base_url+"/doutor/"+e.id,method:"PUT",data:e}).success(function(o,a){i.adiciona_historico(o,a),r?(t.detalha_doutor_pendencia(e.id),t.form.$setPristine()):t.detalha(e.id)}).error(function(o,a){i.erro_portal(o,a)})},t.desativa=function(o){var e=o.id_doutor,r=o.tipo;n({url:d.base_url+"/doutor/"+e,method:"DELETE"}).success(function(o,a){i.adiciona_historico(o,a),"detalha"==r?t.detalha(e):t.lista(t.filtros)}).error(function(o,a){i.erro_portal(o,a)})},t.ativa=function(e,r){n({url:d.base_url+"/doutor/"+e+"/status",method:"PUT"}).success(function(o,a){i.adiciona_historico(o,a),"detalha"==r?t.detalha(e):t.lista(t.filtros)}).error(function(o,a){i.erro_portal(o,a)})},t.limpa_banco=function(){t.bancos&&t.bancos.filter(function(o){o.ticked=!1})},t.lista_banco=function(){n({url:d.base_url+"/banco/lista",method:"POST"}).success(function(o,a){t.bancos=o}).error(function(o,a){i.erro_portal(o,a)})},t.get_dados_pessoais=function(){n({url:d.base_url+"/doutor/dados_pessoais",method:"GET"}).success(function(o,a){t.doutor=o,t.doutor.endereco={logradouro:!0,bairro:!0},o.logradouro&&o.bairro||(t.doutor.endereco={logradouro:!1,bairro:!1})}).error(function(o,a){i.erro_portal(o,a)})},t.altera_dados_pessoais=function(o){delete o.endereco,i.seta_gravar(!0),n({url:d.base_url+"/doutor/dados_pessoais",method:"PUT",data:o}).success(function(o,a){i.seta_gravar(!1),i.adiciona_historico(o,a),t.get_dados_pessoais(),t.lista_pendencia_doutores({status:"pendente"})}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a)})},t.aceita_termo=function(){i.seta_gravar(!0),n({url:d.base_url+"/doutor/termo",method:"POST"}).success(function(o,a){i.seta_gravar(!1),i.adiciona_historico(o,a),t.get_dados_pessoais(),t.lista_pendencia_doutores({status:"pendente"})}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a)})},t.aceita_regras_conduta=function(){i.seta_gravar(!0),n({url:d.base_url+"/doutor/regras",method:"POST"}).success(function(o,a){i.seta_gravar(!1),i.adiciona_historico(o,a),t.get_dados_pessoais(),t.lista_pendencia_doutores({status:"pendente"})}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a)})},t.sync_slack=function(){i.seta_gravar(!0),n({url:d.base_url+"/doutor/slack",method:"POST"}).success(function(o,a){i.seta_gravar(!1),i.adiciona_historico(o,a),t.get_dados_pessoais(),i.conta_pendencia_doutor()}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a)})},t.lista_arquivo=function(){n({url:d.base_url+"/doutor/arquivo",method:"GET"}).success(function(o,a){t.doutor_arquivos=o}).error(function(o,a){404==a&&"/supporter/upload"==e.current.originalPath||i.erro_portal(o,a)})},t.adiciona_arquivo=function(o){i.seta_gravar(!0),a.upload({url:d.base_url+"/doutor/arquivo",data:o,method:"POST"}).success(function(o,a){i.seta_gravar(!1),i.adiciona_historico(o,a),t.lista_arquivo(),t.init_arquivo(),i.conta_pendencia_doutor()}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a)})},t.previa_arquivo_doutor=function(o){t.init_arquivo(),o.selecionado?t.remove_previa_arquivo_doutor():(t.remove_previa_arquivo_doutor(),"pdf"==o.extensao&&(t.arquivo_tipo_pdf=!0),o.selecionado=!0,t.id_doutor_modal_mostra_arquivo?t.doutor_arquivo_selecionado="/portal/arquivo/"+o.id+"/doutor/"+t.id_doutor_modal_mostra_arquivo:t.doutor_arquivo_selecionado="/portal/doutor/arquivo/"+o.id)},t.remove_previa_arquivo_doutor=function(){t.doutor_arquivos.filter(function(o){o.selecionado=!1}),t.arquivo_tipo_pdf=!1,t.doutor_arquivo_selecionado=null},t.lista_competencia=function(){n({url:d.base_url+"/doutor/competencia",method:"GET"}).success(function(o,a){t.competencias_disponiveis=o.competencias_disponiveis,t.competencias_selecionadas=o.competencias_selecionadas}).error(function(o,a){i.erro_portal(o,a)})},t.seleciona_especialidade=function(o){t.especialidade_selecionada==o?t.especialidade_selecionada=0:t.especialidade_selecionada=o,t.area_selecionada=0,t.competencia_selecionada=0},t.seleciona_area=function(o){t.area_selecionada==o?t.area_selecionada=0:t.area_selecionada=o,t.competencia_selecionada=0},t.seleciona_competencia=function(o){o.selecionado?(o.selecionado=!1,t.descricao_competencia=""):(t.competencias_disponiveis.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,t.descricao_competencia=o.descricao)},t.adiciona_competencia=function(a){t.competencias_selecionadas.push(a);var o=t.competencias_disponiveis.findIndex(function(o){return o.id_competencia===a.id_competencia});t.competencias_disponiveis.splice(o,1),t.competencia_selecionada=0},t.remove_competencia=function(a){t.competencias_disponiveis.push(a);var o=t.competencias_selecionadas.findIndex(function(o){return o.id_competencia===a.id_competencia});t.competencias_selecionadas.splice(o,1)},t.desabilita_gravar=function(){return 0==t.competencias_selecionadas.length},t.grava_competencia_doutor=function(){i.seta_gravar(!0),n({url:d.base_url+"/doutor/competencia",method:"POST",data:t.competencias_selecionadas}).success(function(o,a){i.seta_gravar(!1),i.adiciona_historico(o,a),i.conta_pendencia_doutor()}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a)})},t.grava_candidato_job=function(o){n({url:d.base_url+"/doutor/candidato_job/"+o,method:"POST"}).success(function(o,a){i.adiciona_historico(o,a),r.path("/supporter/candidato_job")}).error(function(o,a){i.erro_portal(o,a),r.path("/supporter/candidato_job")})},t.lista_candidato_job=function(o){i.seta_gravar(!0);var a=i.otimiza_filtro(o);n({url:d.base_url+"/doutor/candidato_job/lista",method:"POST",data:a}).success(function(o,a){i.seta_gravar(!1),t.candidato_jobs=o}).error(function(o,a){i.seta_gravar(!1),i.erro_portal(o,a),t.candidato_jobs=[]})},t.get_job_candidato=function(o){n({url:d.base_url+"/doutor/get_job_candidato/"+o,method:"GET"}).success(function(o,a){t.candidato_job=o}).error(function(o,a){i.erro_portal(o,a),r.path("/supporter/candidato_job")})},t.desiste_job=function(o){n({url:d.base_url+"/doutor/candidato_job/"+o,method:"DELETE"}).success(function(o,a){i.adiciona_historico(o,a),t.lista_candidato_job()}).error(function(o,a){i.erro_portal(o,a)})},t.get_status=function(a){return i.opcoes.status_candidatura_job.find(function(o){return o.id===a}).nome},t.get_doutor=function(o){if("todos"==o)return t.form.id_doutor.$setValidity("invalid",!0),void(t.doutor=null);if(!/^\d+$/.test(o))return t.form.id_doutor.$setValidity("invalid",!1),void i.erro_portal("Id do supporter deve ser um inteiro ou a palavra 'todos'",400);o&&n({url:d.base_url+"/doutor/"+o,method:"GET"}).success(function(o,a){t.doutor=o,t.form.id_doutor.$setValidity("invalid",!0)}).error(function(o,a){t.doutor=null,t.form.id_doutor.$setValidity("invalid",!1),i.erro_portal(o,a)})},t.pendencia_descricao=function(a){t.pendencias.filter(function(o){o.operacao==a&&(t.pendencia.descricao=o.descricao)})},t.lista_pendencia=function(){n({url:d.base_url+"/pendencia/lista",method:"POST"}).success(function(o,a){o.splice(0,0,{id:void 0,operacao:null,nome:"SELECIONE"}),t.pendencias=o}).error(function(o,a){t.pendencias=[],i.erro_portal(o,a)})},t.lista_pendencia_doutores=function(o){i.seta_gravar(!0);var a=i.otimiza_filtro(o);i.usuario_logado.id_doutor&&(a.id_doutor=i.usuario_logado.id_doutor),n({url:d.base_url+"/pendencia_doutor/lista",method:"POST",data:a}).success(function(o,a){i.seta_gravar(!1),i.quantidade_pendencias_doutor=o.length,t.pendencias_doutor=o,t.termo_pendente=!1,t.regra_conduta_pendente=!1,t.pendencias_doutor.filter(function(o){"aceite_termo"==o.operacao_pendencia&&"pendente"==o.status&&(t.termo_pendente=!0),"aceite_regras"==o.operacao_pendencia&&"pendente"==o.status&&(t.regra_conduta_pendente=!0)})}).error(function(o,a){i.seta_gravar(!1),t.pendencias_doutor=[],i.erro_portal(o,a)})},t.adiciona_pendencia_doutor=function(o){"todos"==o.id_doutor||NaN!=parseInt(o.id_doutor)?n({url:d.base_url+"/pendencia_doutor",method:"POST",data:o}).success(function(o,a){i.adiciona_historico(o,a),t.init_pendencia_doutor()}).error(function(o,a){i.erro_portal(o,a)}):i.erro_portal("ID do supporter deve ser 'todos' ou um inteiro",400)},t.lista_pendencia_doutor=function(o){filtro_otimizado=i.otimiza_filtro(o),n({url:d.base_url+"/pendencia_doutor/lista",method:"POST",data:filtro_otimizado}).success(function(o,a){t.pendencias_doutor=o}).error(function(o,a){t.pendencias_doutor=[],i.erro_portal(o,a)})},t.lista_doutor_pendencia=function(){n({url:d.base_url+"/doutor/validacao/pendente",method:"GET"}).success(function(o,a){t.pendencias_doutor=o}).error(function(o,a){i.erro_portal(o,a)})},t.detalha_doutor_pendencia=function(o){n({url:d.base_url+"/doutor/"+o,method:"GET"}).success(function(o,a){t.doutor=o}).error(function(o,a){i.erro_portal(o,a)})},t.lista_arquivo_doutor_pendencia=function(e,r){n({url:d.base_url+"/arquivo/lista",method:"POST",data:{id_doutor:e,ignora_nota_fiscal:!0}}).success(function(o,a){t.doutor_arquivos=o,r&&(t.id_doutor_modal_mostra_arquivo=e)}).error(function(o,a){i.erro_portal(o,a),t.doutor_arquivos=[]})},t.valida_arquivo=function(o){var e=o.id_doutor,a=o.arquivo,r=o.acao;n({url:d.base_url+"/doutor/"+e+"/arquivo/"+a.id+"/"+r,method:"PUT",data:a}).success(function(o,a){i.adiciona_historico(o,a),t.lista_arquivo_doutor_pendencia(e)}).error(function(o,a){i.erro_portal(o,a)})},t.deleta_arquivo=function(o){var e=o.id_doutor,a=o.arquivo;n({url:d.base_url+"/arquivo/"+a.id+"/doutor/"+e,method:"DELETE"}).success(function(o,a){t.pendencias_doutor=o,t.lista_arquivo_doutor_pendencia(e)}).error(function(o,a){i.erro_portal(o,a)})},t.lista_historico=function(o){n({url:d.base_url+"/doutor/"+o+"/historico",method:"GET"}).success(function(o,a){t.historico_doutor=o}).error(function(o,a){i.erro_portal(o,a)})},t.seleciona_estado=function(o){o.selecionado?(o.selecionado=!1,t.cidade_estado=[]):(t.opcoes.estado.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,t.lista_cidade_estado({estado:o.sigla}))},t.seleciona_cidade=function(o){o.selecionado?o.selecionado=!1:(t.cidade_estado.filter(function(o){return o.selecionado=!1}),o.selecionado=!0)},t.lista_cidade_doutor=function(){n({url:d.base_url+"/cidade_doutor/lista",method:"POST"}).success(function(o,a){t.cidade_doutor=o,t.filtra_cidade_doutor()}).error(function(o,a){i.erro_portal(o,a),t.cidade_doutor=[]})},t.lista_cidade_estado=function(o){n({url:d.base_url+"/cidade_brasil/lista",method:"POST",data:o}).success(function(o,a){t.cidade_estado=o,t.filtra_cidade_doutor()}).error(function(o,a){i.erro_portal(o,a),t.cidade_estado=[]})},t.lista_pendencia_desativacao=function(){n({url:d.base_url+"/doutor/desativacao/pendencia",method:"GET"}).success(function(o,a){t.pendencias_desativacao=o}).error(function(o,a){i.erro_portal(o,a)})},t.desativa_conta=function(){n({url:d.base_url+"/doutor/desativa",method:"POST"}).success(function(o,a){alert("Conta desativada com sucesso!"),i.usuario_logado=!1,i.historico_operacoes=[],d.desativa_conta_form?u.location.href=d.desativa_conta_form:u.location.href=d.redirect_url_desativacao}).error(function(o,a){i.erro_portal(o,a)})},t.filtra_cidade_doutor=function(){t.cidade_estado&&t.cidade_estado.forEach(function(a){t.cidade_doutor.find(function(o){return o.id_cidade==a.id})?a.invisivel=!0:a.invisivel=!1})},t.adiciona_cidade_doutor=function(o){n({url:d.base_url+"/cidade_doutor",method:"POST",data:{id_cidade:o.id,id_doutor:i.usuario_logado.id_doutor}}).success(function(o,a){i.adiciona_historico(o,a),t.lista_cidade_doutor()}).error(function(o,a){i.erro_portal(o,a)})},t.remove_cidade_doutor=function(o){n({url:d.base_url+"/cidade_doutor/"+o.id,method:"DELETE"}).success(function(o,a){i.adiciona_historico(o,a),t.lista_cidade_doutor()}).error(function(o,a){i.erro_portal(o,a)})},t.lista_job_minha_cidade=function(){n({url:d.base_url+"/doutor/job/divulgado",method:"GET"}).success(function(o,a){t.jobs_minha_cidade=o}).error(function(o,a){i.erro_portal(o,a)})},t.gerarPDF=function(o){$("#termo #panel-body").css("height","100%"),(t.doutor=o).dh_aceite_termo?(t.termo_antigo=!0,$("#botaoDash").remove(),o.cpf&&o.rg?setTimeout(function(){return html2pdf($("#termo").html(),{margin:1,filename:"Contrato "+o.nome+".pdf"})},1e3):i.modal_confirmacao({msg:"Supporter ainda não possui CPF/RG cadastrado. Deseja gerar o contrato com esses dados em branco?",cb:function(){setTimeout(function(){return html2pdf($("#termo").html(),{margin:1,filename:"Contrato "+o.nome+".pdf"})},1e3)}})):function(o){$("#notificacoes").addClass("alert-danger").fadeIn("slow"),i.notificacao=o;var a=(new Date).toLocaleString();setTimeout(function(){i.notificacao="",$("#notificacoes").removeClass("alert-danger alert-success").fadeOut("slow")},4e3),i.historico_operacoes.unshift({data:a,msg:o,status:"erro"})}("Supporter ainda não aceitou os termos")},"/supporter/:id_doutor"==e.current.originalPath&&(t.lista_banco(),t.detalha(o.id_doutor)),"/supporter/adiciona"==e.current.originalPath&&(t.lista_banco(),t.init_doutor()),"/supporter/dados_pessoais"==e.current.originalPath&&(t.get_dados_pessoais(),t.lista_banco()),0<=["/supporter/termo","/supporter/regras"].indexOf(e.current.originalPath)&&(t.get_dados_pessoais(),t.lista_pendencia_doutores({status:"pendente"})),"/supporter/upload"==e.current.originalPath&&(t.lista_arquivo(),t.init_arquivo()),"/supporter/competencia"==e.current.originalPath&&t.lista_competencia(),"/supporter/candidato_job/token/:token"==e.current.originalPath&&t.get_job_candidato(o.token),"/supporter/pendencia"==e.current.originalPath&&t.lista_pendencia(),"/supporter/pendencia/adiciona"==e.current.originalPath&&(t.init_pendencia_doutor(),t.lista_pendencia()),"/supporter/minhas_pendencias"==e.current.originalPath&&t.lista_pendencia_doutores({status:"pendente"}),"/supporter/validacao"==e.current.originalPath&&t.lista_doutor_pendencia(),"/supporter/:id_doutor/validacao"==e.current.originalPath&&(t.detalha_doutor_pendencia(o.id_doutor),t.lista_arquivo_doutor_pendencia(o.id_doutor),t.lista_banco()),"/supporter/cidade_atendimento"==e.current.originalPath&&t.lista_cidade_doutor(),"/supporter/desativa_conta"==e.current.originalPath&&t.lista_pendencia_desativacao()}]);
"use strict";app.controller("erro",["$scope","$location",function(t,e){t.url_inexistente=e.path()}]);
"use strict";app.controller("especialidade",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(c,o,n,e,r,a,i){c.especialidades=[],c.areas=[],c.competencias=[],c.especialidade_selecionada={},c.area_selecionada={},c.opcoes={area_competencia:[{id:null,nome:"SELECIONE ESPECIALIDADE"}]},c.init=function(){c.especialidade={nome:null},c.area={id_especialidade:null,nome:null},c.competencia={id_especialidade:null,id_area:null,nome:null,descricao:null}},c.init_area=function(){c.area={id_especialidade:null,nome:null}},c.lista_especialidade=function(i){n({url:r.base_url+"/especialidade/lista",method:"POST"}).success(function(e,a){i&&e.splice(0,0,{id:null,nome:"SELECIONE"}),c.especialidades=e}).error(function(e,a){c.especialidades=[],c.areas=[],c.competencias=[],o.erro_portal(e,a)})},c.adiciona_especialidade=function(e){n({url:r.base_url+"/especialidade",method:"POST",data:e}).success(function(e,a){o.adiciona_historico(e,a),c.init()}).error(function(e,a){o.erro_portal(e,a)})},c.detalha_especialidade=function(e){n({url:r.base_url+"/especialidade/"+e,method:"GET"}).success(function(e,a){c.especialidade=e}).error(function(e,a){o.erro_portal(e,a)})},c.altera_especialidade=function(e){n({url:r.base_url+"/especialidade/"+e.id,method:"PUT",data:e}).success(function(e,a){o.adiciona_historico(e,a)}).error(function(e,a){o.erro_portal(e,a)})},c.deleta_especialidade=function(e){var a=e.id_especialidade;n({url:r.base_url+"/especialidade/"+a,method:"DELETE"}).success(function(e,a){o.adiciona_historico(e,a),c.lista_especialidade(),c.areas=[],c.competencias=[]}).error(function(e,a){o.erro_portal(e,a)})},c.seleciona_especialidade=function(e){e==c.especialidade_selecionada?(c.areas=[],c.competencias=[],c.especialidade_selecionada.selecionada=!1,c.especialidade_selecionada={}):(c.especialidade_selecionada&&(c.especialidade_selecionada.selecionada=!1),c.especialidade_selecionada=e,c.especialidade_selecionada.selecionada=!0,c.lista_area(e.id),c.competencias=[])},c.lista_area=function(e,i){if(""==e)return c.areas=[],void(c.competencia.id_area="");n({url:r.base_url+"/area/lista",method:"POST",data:{id_especialidade:e}}).success(function(e,a){i&&e.splice(0,0,{id:null,nome:"SELECIONE"}),c.areas=e}).error(function(e,a){c.areas=[],c.competencia&&(c.competencia.id_area=""),404!=a&&o.erro_portal(e,a)})},c.adiciona_area=function(e){n({url:r.base_url+"/area",method:"POST",data:e}).success(function(e,a){o.adiciona_historico(e,a),c.init_area()}).error(function(e,a){o.erro_portal(e,a)})},c.detalha_area=function(e){n({url:r.base_url+"/area/"+e,method:"GET"}).success(function(e,a){c.area=e}).error(function(e,a){o.erro_portal(e,a)})},c.altera_area=function(e){n({url:r.base_url+"/area/"+e.id,method:"PUT",data:e}).success(function(e,a){o.adiciona_historico(e,a)}).error(function(e,a){o.erro_portal(e,a)})},c.deleta_area=function(e){var a=e.id_area;n({url:r.base_url+"/area/"+a,method:"DELETE"}).success(function(e,a){o.adiciona_historico(e,a),c.lista_area(c.especialidade_selecionada.id),c.competencias=[]}).error(function(e,a){o.erro_portal(e,a)})},c.seleciona_area=function(e){e==c.area_selecionada?(c.competencias=[],c.area_selecionada.selecionada=!1,c.area_selecionada={}):(c.area_selecionada&&(c.area_selecionada.selecionada=!1),c.area_selecionada=e,c.area_selecionada.selecionada=!0,c.lista_competencia(e.id))},c.lista_competencia=function(e){n({url:r.base_url+"/competencia/lista",method:"POST",data:{id_area:e}}).success(function(e,a){c.competencias=e}).error(function(e,a){c.competencias=[],404!=a&&o.erro_portal(e,a)})},c.adiciona_competencia=function(e){n({url:r.base_url+"/competencia",method:"POST",data:e}).success(function(e,a){o.adiciona_historico(e,a),c.init(),c.areas=c.opcoes.area_competencia}).error(function(e,a){o.erro_portal(e,a)})},c.detalha_competencia=function(e){n({url:r.base_url+"/competencia/"+e,method:"GET"}).success(function(e,a){c.competencia=e,c.lista_especialidade(),c.lista_area(e.id_especialidade)}).error(function(e,a){o.erro_portal(e,a)})},c.altera_competencia=function(e){n({url:r.base_url+"/competencia/"+e.id,method:"PUT",data:e}).success(function(e,a){o.adiciona_historico(e,a)}).error(function(e,a){o.erro_portal(e,a)})},c.deleta_competencia=function(e){var a=e.id_competencia;n({url:r.base_url+"/competencia/"+a,method:"DELETE"}).success(function(e,a){o.adiciona_historico(e,a),c.lista_competencia(c.area_selecionada.id)}).error(function(e,a){o.erro_portal(e,a)})},"/especialidade/:id_especialidade"==a.current.originalPath&&c.detalha_especialidade(i.id_especialidade),"/especialidade/adiciona"==a.current.originalPath&&c.init(),"/especialidade/area/:id_area"==a.current.originalPath&&(c.lista_especialidade(!1),c.detalha_area(i.id_area)),"/especialidade/area/adiciona"==a.current.originalPath&&(c.lista_especialidade(!0),c.init()),"/especialidade/competencia/:id_competencia"==a.current.originalPath&&c.detalha_competencia(i.id_competencia),"/especialidade/competencia/adiciona"==a.current.originalPath&&(c.lista_especialidade(!0),c.areas=c.opcoes.area_competencia,c.init())}]);
"use strict";app.controller("ferramenta",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(o,n,t,a,e,r,i){o.init_email=function(){o.email={},o.dados='{\n    "nome": "NeTi",\n    "token_job": "123123",\n    "token_candidato_doutor": "456",\n    "data_atendimento": "12/10/2018 08:00",\n    "local": "uberlandia mg",\n    "escopo": "pau no pc",\n    "previsao_ganho": "muito money",\n    "url": "http://portal.ff",\n    "url_imagem": "https://portal-teste.netsupport.com.br",\n    "duracao": 30,\n    "token": "123"\n}'},o.envia_email=function(o,a){try{o.dados=JSON.parse(a)}catch(o){return void n.erro_portal("Falha ao converter 'dados' para o formado JSON.",400)}t({url:e.base_url+"/ferramentas/email",method:"POST",data:o}).success(function(o,a){n.adiciona_historico(o,a)}).error(function(o,a){n.erro_portal(o,a)})},"/ferramenta/envia_email"==r.current.originalPath&&o.init_email()}]);
"use strict";function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var a=0,e=function(){};return{s:e,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n,r=!0,i=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return r=t.done,t},e:function(t){i=!0,n=t},f:function(){try{r||null==o.return||o.return()}finally{if(i)throw n}}}}function _unsupportedIterableToArray(t,a){if(t){if("string"==typeof t)return _arrayLikeToArray(t,a);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,a):void 0}}function _arrayLikeToArray(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,o=new Array(a);e<a;e++)o[e]=t[e];return o}app.controller("financeiro",["$scope","$rootScope","$http","$location","config","$timeout","$route","$routeParams","Upload",function(n,r,i,t,l,a,e,o,c){function d(t,a){return t.map(function(t){return t[a]})}n.get_faturamento=function(t,a,e){var o=_.cloneDeep(t);o&&o.tipo_data?(o.data_inicio&&(o["data_"+o.tipo_data+"_inicial"]=moment(o.data_inicio).format("YYYY-MM-DD"),delete o.data_inicio),o.data_fim&&(o["data_"+o.tipo_data+"_final"]=moment(o.data_fim).format("YYYY-MM-DD"),delete o.data_fim)):o={},i({url:l.base_url+a,method:"POST",data:o}).success(function(t,a){e&&e(t),n.relatorio=t}).error(function(t,a){r.erro_portal(t,a)})},n.get_faturamento_detalha=function(t,a,e){n.relatorio_detalha=[],n.cliente_faturamento_detalha=e;var o=_.cloneDeep(t);o.id_cliente=e.id_cliente,o.tipo_data&&(o.data_inicio&&(o["data_"+o.tipo_data+"_inicial"]=moment(o.data_inicio).format("YYYY-MM-DD"),delete o.data_inicio),o.data_fim&&(o["data_"+o.tipo_data+"_final"]=moment(o.data_fim).format("YYYY-MM-DD"),delete o.data_fim)),i({url:l.base_url+"/"+a,method:"POST",data:o}).success(function(t,a){n.relatorio_detalha=t}).error(function(t,a){r.erro_portal(t,a)})},n.gera_csv_faturamento=function(){if(n.relatorio_detalha&&n.relatorio_detalha.jobs){var t,e="Id, Cliente do Cliente, Tipo Servico, Data Inicial, Data Final, Job, Hora Adicional, Código do cliente, Reembolso, Total\n",a=_createForOfIteratorHelper(n.relatorio_detalha.jobs);try{var o=function(){var a=t.value;Object.keys(a).forEach(function(t){a[t]=a[t]||" "}),e+=a.id_job+","+a.nome_cliente_cliente+","+a.tipo_servico+","+a.data_inicial+","+a.data_final+","+a.total_atendimento+","+a.total_horas_extras+","+a.codigo_chamado_cliente+","+a.total_reembolso+","+a.total_job+"\n"};for(a.s();!(t=a.n()).done;)o()}catch(t){a.e(t)}finally{a.f()}return encodeURIComponent(e)}},n.get_analise_receita=function(t,a,e){var o=_.cloneDeep(t);o.tipo_data&&(o.data_inicio&&(o["data_"+o.tipo_data+"_inicial"]=moment(o.data_inicio).format("YYYY-MM-DD"),delete o.data_inicio),o.data_fim&&(o["data_"+o.tipo_data+"_final"]=moment(o.data_fim).format("YYYY-MM-DD"),delete o.data_fim)),i({url:l.base_url+a,method:"POST",data:o}).success(function(t,a){e&&e(t),n.relatorio=t}).error(function(t,a){n.relatorio=[],r.erro_portal(t,a)})},n.gera_graficos_analise_receita=function(t){t.total_faturamento_fechado,t.total_faturamento_pendente,t.total_faturamento_finalizado;t.faturamentos_clientes&&(function(t){var a=document.getElementById("grafico1").getContext("2d");u&&u.destroy();u=new Chart(a,{type:"bar",data:{labels:d(t,"nome_cliente"),datasets:[{label:"Fechada",data:d(t,"total_faturamento_fechado"),backgroundColor:"blue",stack:"background"},{label:"Pronta",data:d(t,"total_faturamento_atrasado"),backgroundColor:"yellow",stack:"background"},{label:"Pendente",data:d(t,"total_faturamento_pendente"),backgroundColor:"red",stack:"background"}]},options:{title:{display:!0,text:"Composição Receita"},scales:{yAxes:[{stacked:!0,ticks:{beginAtZero:!0}}],xAxes:[{stacked:!0,ticks:{stepSize:1,min:0,autoSkip:!1}}]},legend:{position:"bottom"}}})}(t.faturamentos_clientes),function(t,a){var e=document.getElementById("grafico2").getContext("2d");null!=f&&f.destroy();f=new Chart(e,{type:"pie",data:{labels:d(t,"nome_cliente"),datasets:[{data:d(t,"total_faturamento"),backgroundColor:(o=t.length,palette("mpn65",o).map(function(t){return"#"+t}))}]},options:{title:{display:!0,text:"Distribuição Receita"},legend:{position:"right"},tooltips:{callbacks:{label:function(t,a){var e=a.datasets[t.datasetIndex],o=e.data.reduce(function(t,a){return t+a}),n=e.data[t.index],r=(n/o*100).toFixed(1)+"%";return r}}}}});var o}(t.faturamentos_clientes))};var u=null;var f=null}]);
"use strict";app.controller("flag",["$scope","$rootScope","$http","$location","config","$timeout","$routeParams","$route",function(i,a,n,o,l,r,t,c){i.flags=[],i.filtros={},i.init=function(){i.flag={filtro:null,flag:null,descricao:null,prioridade:null}},i.lista=function(o){var r=a.otimiza_filtro(o);n({url:l.base_url+"/flag/lista",method:"POST",data:r}).success(function(o,r){i.flags=o}).error(function(o,r){i.flags=[],a.erro_portal(o,r)})},i.adiciona=function(o){n({url:l.base_url+"/flag",data:o,method:"POST"}).success(function(o,r){a.adiciona_historico(o,r),i.init()}).error(function(o,r){a.erro_portal(o,r)})},i.get=function(o){n({url:l.base_url+"/flag/"+o,method:"GET"}).success(function(o,r){i.flag=o}).error(function(o,r){a.erro_portal(o,r)})},i.altera=function(t){n({url:l.base_url+"/flag/"+t.id,method:"PUT",data:t}).success(function(o,r){a.adiciona_historico(o,r),i.get(t.id)}).error(function(o,r){a.erro_portal(o,r)})},i.deleta=function(o){var r=o.id_flag;n({url:l.base_url+"/flag/"+r,method:"DELETE"}).success(function(o,r){a.adiciona_historico(o,r),i.lista(i.filtros)}).error(function(o,r){a.erro_portal(o,r)})},i.ativa=function(o){n({url:l.base_url+"/flag/"+o+"/status",method:"PUT"}).success(function(o,r){a.adiciona_historico(o,r),i.lista()}).error(function(o,r){a.erro_portal(o,r)})},"/flag/:id_flag"==c.current.originalPath&&i.get(t.id_flag),"/flag/adiciona"==c.current.originalPath&&i.init()}]);
"use strict";app.controller("funcionalidade",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(a,e,c,o,r,i,n){a.funcionalidades=[],a.opcoes={metodo:r.opcoes.metodo,menu:r.opcoes.menu},a.init=function(){a.funcionalidade={nome:null,icone:"flaticon-question-mark-inside-a-circle",url:null,metodo:null,menu:null}},a.lista=function(o){var i=e.otimiza_filtro(o);c({url:r.base_url+"/funcionalidade/lista",method:"POST",data:i}).success(function(o,i){a.funcionalidades=o}).error(function(o,i){a.funcionalidades=[],e.erro_portal(o,i)})},a.adiciona=function(o){c({url:r.base_url+"/funcionalidade",method:"POST",data:o}).success(function(o,i){e.adiciona_historico(o,i),a.init()}).error(function(o,i){e.erro_portal(o,i)})},a.detalha=function(o){c({url:r.base_url+"/funcionalidade/"+o,method:"GET"}).success(function(o,i){a.funcionalidade=o}).error(function(o,i){e.erro_portal(o,i)})},a.altera=function(n){c({url:r.base_url+"/funcionalidade/"+n.id,method:"PUT",data:n}).success(function(o,i){e.adiciona_historico(o,i),a.detalha(n.id)}).error(function(o,i){e.erro_portal(o,i)})},a.deleta=function(o){var i=o.id_grupo;c({url:r.base_url+"/funcionalidade/"+i,method:"DELETE"}).success(function(o,i){e.adiciona_historico(o,i),a.lista(a.filtros)}).error(function(o,i){e.erro_portal(o,i)})},"/funcionalidade/:id_funcionalidade"==i.current.originalPath&&a.detalha(n.id_funcionalidade),"/funcionalidade/adiciona"==i.current.originalPath&&a.init()}]);
"use strict";app.controller("funcionario",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(r,a,t,o,c,n,i){r.funcionarios=[],r.bancos=[],r.init_funcionario=function(){r.funcionario={},r.funcionario.operacao_conta=null,r.funcionario.complemento=null,r.funcionario.dv_agencia_banco=null,a.desabilita_endereco()},r.operacao_conta_require=function(o){r.operacao_conta_cef=o.search("104")};var e=document.getElementById("id_grupo");setTimeout(function(){a.usuario.nucleo_abertura_gd&&"Gestor de Demanda"==e.options[e.selectedIndex].text&&(document.getElementById("nucleo_abertura").style.display="block")},1e3),e&&(e.onchange=function(){a.usuario.nucleo_abertura_gd&&"Gestor de Demanda"==e.options[e.selectedIndex].text?document.getElementById("nucleo_abertura").style.display="block":document.getElementById("nucleo_abertura").style.display="none"}),r.lista=function(o){var n=a.otimiza_filtro(o);t({url:c.base_url+"/funcionario/lista",method:"POST",data:n}).success(function(o,n){r.funcionarios=o}).error(function(o,n){a.erro_portal(o,n),r.funcionarios=[]})},r.adiciona=function(o){t({url:c.base_url+"/funcionario",method:"POST",data:o}).success(function(o,n){a.adiciona_historico(o,n),r.init_funcionario()}).error(function(o,n){a.erro_portal(o,n)})},r.detalha=function(o){t({url:c.base_url+"/funcionario/"+o,method:"GET"}).success(function(o,n){r.funcionario=o}).error(function(o,n){a.erro_portal(o,n)})},r.altera=function(i){t({url:c.base_url+"/funcionario/"+i.id,method:"PUT",data:i}).success(function(o,n){a.adiciona_historico(o,n),r.detalha(i.id)}).error(function(o,n){a.erro_portal(o,n)})},r.grava=function(o){r.funcionario.nome_criado_por?r.altera(o):r.adiciona(o)},r.desativa=function(o){var n=o.id_funcionario;t({url:c.base_url+"/funcionario/"+n,method:"DELETE"}).success(function(o,n){a.adiciona_historico(o,n),r.lista(r.filtros)}).error(function(o,n){a.erro_portal(o,n)})},r.ativa=function(o){t({url:c.base_url+"/funcionario/"+o+"/status",method:"PUT"}).success(function(o,n){a.adiciona_historico(o,n),r.lista(r.filtros)}).error(function(o,n){a.erro_portal(o,n)})},r.sync_slack=function(o){t({url:c.base_url+"/funcionario/"+o+"/slack",method:"PUT"}).success(function(o,n){a.adiciona_historico(o,n),r.lista()}).error(function(o,n){a.erro_portal(o,n)})},r.lista_banco=function(){t({url:c.base_url+"/banco/lista",method:"POST"}).success(function(o,n){r.bancos=o}).error(function(o,n){a.erro_portal(o,n)})},r.lista_grupo=function(){t({url:c.base_url+"/grupo/lista",method:"POST",data:{perfil:"funcionario"}}).success(function(o,n){o.splice(0,0,{id:void 0,nome:"SELECIONE"}),r.grupos=o}).error(function(o,n){r.grupos=[],a.erro_portal(o,n)})},"/funcionario/:id_funcionario"==n.current.originalPath&&(r.lista_banco(),r.lista_grupo(),r.detalha(i.id_funcionario)),(n.current.originalPath="/funcionario/adiciona")&&(r.init_funcionario(),r.lista_banco(),r.lista_grupo())}]);
"use strict";app.controller("grupo",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(i,a,t,o,n,r,u){i.grupos=[],i.init=function(){i.grupo={}},i.lista=function(o){var r=a.otimiza_filtro(o);t({url:n.base_url+"/grupo/lista",method:"POST",data:r}).success(function(o,r){i.grupos=o}).error(function(o,r){i.grupos=[],a.erro_portal(o,r)})},i.adiciona=function(o){t({url:n.base_url+"/grupo",method:"POST",data:o}).success(function(o,r){a.adiciona_historico(o,r),i.init()}).error(function(o,r){a.erro_portal(o,r)})},i.detalha=function(o){t({url:n.base_url+"/grupo/"+o,method:"GET"}).success(function(o,r){i.grupo=o}).error(function(o,r){a.erro_portal(o,r)})},i.altera=function(u){t({url:n.base_url+"/grupo/"+u.id,method:"PUT",data:u}).success(function(o,r){a.adiciona_historico(o,r),i.detalha(u.id)}).error(function(o,r){a.erro_portal(o,r)})},i.deleta=function(o){var r=o.id_grupo;t({url:n.base_url+"/grupo/"+r,method:"DELETE"}).success(function(o,r){a.adiciona_historico(o,r),i.lista(i.filtros)}).error(function(o,r){a.erro_portal(o,r)})},i.lista_permissao_grupo=function(o){if(o.selecionado)return i.permissao_grupo=[],i.grupo_id=null,i.lista_usuario_grupo_invalido=null,i.lista_usuario_grupo=null,void(o.selecionado=!1);i.grupos.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,i.grupo_id=o.id;var r={id_grupo:o.id};t({url:n.base_url+"/permissao_grupo/lista",method:"POST",data:r}).success(function(o,r){i.permissao_grupo=o}).error(function(o,r){i.permissao_grupo=[]}),i.lista_usuario_grupo_invalido=null,i.lista_usuario_grupo=null,"Cliente"==o.nome||"Doutor"==o.nome?i.lista_usuario_grupo_invalido='Para lista usuários do grupo "'+o.nome+'" acesse o menu do mesmo.':t({url:n.base_url+"/grupo/"+o.id+"/usuario",method:"GET"}).success(function(o,r){i.lista_usuario_grupo=o}).error(function(o,r){i.lista_usuario_grupo=[]})},"/grupo/:id_grupo"==r.current.originalPath&&i.detalha(u.id_grupo),"/grupo/adiciona"==r.current.originalPath&&i.init()}]);
"use strict";app.controller("header",["$scope","$http","$rootScope","config",function(o,t,c,e){}]);
"use strict";app.controller("importa_retorno",["$scope","$rootScope","$http","$location","config","$timeout","$route","$routeParams","Upload",function(t,n,r,o,e,a,i,c,u){t.verifica_tipo_arquivo=function(o){if(t.arquivo_tamanho_nao_suportado=!1,t.tipo_arquivo_invalido=!1,t.arquivo_valido=!1,o){if(2e6<o.size){t.arquivo_tamanho_nao_suportado=!0;var r=" Tamanho do arquivo maior que permitido, deve ter no máximo 2MB"}else r="";if(o&&["text/csv","","application/vnd.ms-excel"].indexOf(o.type)<0){t.tipo_arquivo_invalido=!0;var a="formato do arquivo não permitido. Arquivo deve texto no formato CSV."}else a="";t.arquivo_tamanho_nao_suportado||t.tipo_arquivo_invalido?n.erro_portal("Arquivo Inválido: "+a+r,400):t.arquivo_valido=!0}},t.importa_retorno=function(o,r){o&&u.upload({url:e.base_url+"/financeiro/importacao/retorno/"+r,data:{arquivo:o}}).success(function(o,r){n.adiciona_historico(o.msg,r),t.arquivo=null,t.arquivo_valido=!1}).error(function(o,r){n.erro_portal(o,r)})},t.lista_importacao=function(o){t.tipo_retorno=o,r({url:e.base_url+"/financeiro/importacao/retorno/"+o,method:"GET"}).success(function(o,r){t.importacoes=o}).error(function(o,r){t.importacoes=[],n.erro_portal(o,r)})},t.get_importacao=function(o,a,i){r({url:e.base_url+"/financeiro/importacao/retorno/"+o,method:"GET"}).success(function(o,r){t.importacao=o,a&&$(a).modal(),i&&n.json2csv.download_csv({prefixo:"retorno-"+i.tipo,filtro:{data_criado:i.criado_em}},t.importacao.csv)}).error(function(o,r){t.importacao={},n.erro_portal(o,r)})}}]);
"use strict";app.controller("integracao",["$scope","$http","$location","config","$rootScope","$window","$routeParams","$route",function(t,i,r,n,c,e,a,o){t.init=function(){t.integracao={tipo:"oauth2"}},t.lista=function(){i({url:n.base_url+"/integracao/lista",method:"POST"}).success(function(a,o){a.filter(function(a){a.imagem="logo_contaazul.png"}),t.integracoes=a}).error(function(a,o){t.integracoes=[],c.erro_portal(a,o)})},t.adiciona=function(a){i({url:n.base_url+"/integracao",method:"POST",data:a}).success(function(a,o){c.adiciona_historico(a.msg,o),t.init()}).error(function(a,o){c.erro_portal(a,o)})},t.detalha=function(a){i({url:n.base_url+"/integracao/"+a,method:"GET"}).success(function(a,o){t.integracao=a}).error(function(a,o){c.erro_portal(a,o)})},t.altera=function(r){i({url:n.base_url+"/integracao/"+r.id,method:"PUT",data:r}).success(function(a,o){c.adiciona_historico(a.msg,o),t.detalha(r.id)}).error(function(a,o){c.erro_portal(a,o)})},t.remove=function(a){var o=a.id_integracao;i({url:n.base_url+"/integracao/"+o,method:"DELETE"}).success(function(a,o){c.adiciona_historico(a.msg,o),t.lista()}).error(function(a,o){c.erro_portal(a,o)})},t.autenticar=function(a){i({url:n.base_url+"/integracao/"+a.id+"/autorizacao",method:"GET",data:a}).success(function(a,o){e.open(a.url,"_top")}).error(function(a,o){c.erro_portal(a,o)})},t.callback=function(a){i({url:n.base_url+"/integracao/callback?"+$.param(a),method:"GET"}).success(function(a,o){"OK"==a.status&&(c.adiciona_historico("Autorização realizada com sucesso.",o),r.path("/integracao"))}).error(function(a,o){c.erro_portal(a,o)})},"/integracao"==o.current.originalPath&&t.lista(),"/integracao/:id_integracao"==o.current.originalPath&&t.detalha(a.id),"/integracao/adiciona"==o.current.originalPath&&t.init(),"/integracao/callback"==o.current.originalPath&&t.callback(a)}]);
"use strict";function _slicedToArray(o,a){return _arrayWithHoles(o)||_iterableToArrayLimit(o,a)||_unsupportedIterableToArray(o,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,a){if(o){if("string"==typeof o)return _arrayLikeToArray(o,a);var e=Object.prototype.toString.call(o).slice(8,-1);return"Object"===e&&o.constructor&&(e=o.constructor.name),"Map"===e||"Set"===e?Array.from(o):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(o,a):void 0}}function _arrayLikeToArray(o,a){(null==a||a>o.length)&&(a=o.length);for(var e=0,t=new Array(a);e<a;e++)t[e]=o[e];return t}function _iterableToArrayLimit(o,a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(o)){var e=[],t=!0,i=!1,r=void 0;try{for(var n,d=o[Symbol.iterator]();!(t=(n=d.next()).done)&&(e.push(n.value),!a||e.length!==a);t=!0);}catch(o){i=!0,r=o}finally{try{t||null==d.return||d.return()}finally{if(i)throw r}}return e}}function _arrayWithHoles(o){if(Array.isArray(o))return o}app.controller("job",["$scope","$rootScope","$http","$location","config","Upload","$q","$routeParams","$route","$interval",function(p,c,r,i,n,a,o,e,t,d){var l="/job",s=i.path();p.destaca_valor="",p.jobs=[],p.clientes=[],p.historico_job=[],p.tipos_servicos=[{id:null,nome:"SELECIONE Tipo e Forma de Atendimento"}],p.candidatos_job=[],p.tipos_servico_selecionado={},p.gestores=[],p.doutores=[],p.job={},p.filtros={},p.quantidade_jobs={},p.orientacao_job={},p.calendario1={},p.calendario2={};var u=["associacao_gestor","categorizacao","divulgacao","associacao_doutor","inicio_deslocamento","checkin","encerramento","validacao"];function b(){for(var o in p.eventos)clearTimeout(o);p.eventos=[]}p.lista_todos=!0,p.atendimentos=[],p.tipo_servico=[],p.notas=[],p.dados_supporter={},p.first=!0,p.id_job=null,p.local=function(o){return"remoto"==o.forma_atendimento?"remoto":o.estado+"/"+o.cidade},p.status=["Aberto","Com Gestor","Categorizado","Divulgado","Com Doutor","Doutor em trânsito","Doutor no local","Atendimento encerrado","Validado com sucesso","Falha validação","Reaberto","Sem Doutor","Reagendado","Cancelado","Fechado"],p.opcoes={urgencia_atendimento:n.opcoes.urgencia_atendimento,forma_atendimento:n.opcoes.forma_atendimento,motivo_desassociacao:n.opcoes.motivo_desassociacao,aceite_cliente:n.opcoes.aceite_cliente,tipo_lancamento:n.opcoes.tipo_lancamento,tipo:n.opcoes.tipo,sim_nao:n.opcoes.sim_nao,status:n.opcoes.status_jobs,tipo_atendimento:n.opcoes.tipo},p.limpa_filtros=function(a){Object.keys(a).forEach(function(o){delete a[o]}),p.doutor_selecionado=null,p.cliente_selecionado=null},p.remove_vazio_filtro=function(a){Object.keys(a).forEach(function(o){a[o]&&a[o]!=[]||delete a[o]})},p.init_job=function(){p.job={id_cliente:null,problema:null,dado_sensivel:null,nome_contato:null,celular_contato:null,email_contato:null,codigo_chamado_cliente:null,nome_local_atendimento:null,motivo_codigo_duplicado:null,codigo_duplicado:null,codigo_venda:null,cep:null,cep_valido:!1,estado:null,cidade:null,bairro:null,logradouro:null,numero:null,complemento:null,longitude:null,latitude:null,urgencia_atendimento:void 0,dh_agendamento_cliente:null,forma_atendimento:null,divulga:!0},c.usuario_logado.id_cliente&&(p.job.id_cliente=c.usuario_logado.id_cliente,p.job.id_projeto=void 0),c.desabilita_endereco()},p.init_gestor=function(){p.altera_gd={id:p.job.id_gestor}},p.init_categorizacao=function(){"Com Gestor"==p.job.status?(p.job.trabalha_sabado=!1,p.job.trabalha_domingo=!1,p.job.divulga=!0,p.job.feriados=null,p.frm_categ.folga_obrigatoria=p.job.folga_obrigatoria||p.tipo_servico_selecionado.folga_obrigatoria,p.job.folga_obrigatoria=p.job.folga_obrigatoria||p.tipo_servico_selecionado.folga_obrigatoria,p.job.id_orientacao=void 0,p.job.tipo=void 0,p.job.forma_atendimento=void 0,p.job.valor_diferenciado=void 0):p.lista_tipo_servico(!0)},p.init_encerrar_job=function(){p.encerra_job={duracao_atendimento:null,descricao_atendimento:null,arquivo:null}},p.init_valida_atendimento=function(){moment(p.job.at_duracao_atendimento,"HH:mm").isSameOrBefore(moment(p.job.criterios_encerramento.duracao_atendimento,"HH:mm"))?p.job.fez_hora_extra=!1:p.job.fez_hora_extra=!0,p.validacao={id_atendimento_improdutivo:p.job.id_atendimento_improdutivo,motivo_falha_validacao:p.job.motivo_falha_validacao,finaliza:!0},p.lista_flags("atendimento_improdutivo",!0)},p.init_finaliza_job=function(){p.finaliza_job={},p.job.aceite_cliente&&(p.finaliza_job.aceite_cliente=p.job.aceite_cliente),3==p.job.id_base_custo?($("#dh_fechamento_cliente").attr("disabled","disabled"),p.job.dh_fechamento_cliente?p.finaliza_job.dh_fechamento_cliente=p.job.dh_fechamento_cliente:p.finaliza_job.dh_fechamento_cliente=moment().format("YYYY-MM-DDTHH:mm:ss")):($("#dh_fechamento_cliente").removeAttr("disabled"),p.finaliza_job.dh_fechamento_cliente=p.job.dh_fechamento_cliente)},p.init_desassocia_doutor=function(){"atendimento"==p.job.tipo?p.desassocia_doutor={cancela_agendamento:!1,reagenda:!1,motivo_desassociacao:null}:p.desassocia_doutor={},r({url:n.base_url+"/flag/lista",method:"POST",data:{status:"ativo",filtro:"desassociacao_doutor"}}).success(function(o,a){p.opcoes.id_flag_desassociacao=o,console.log(o)}).error(function(o,a){p.doutor_direto.nome_doutor=null,c.erro_portal(o,a)})},p.init_associa_doutor_direto=function(){p.doutor_direto={}},p.init_notas=function(){p.nota={}},p.init_faturamento=function(o){o?p.job_faturavel={faturavel:!1,motivo_nao_faturavel:null}:(p.job_faturavel={faturavel:!0,motivo_nao_faturavel:null},p.adiciona_fatura_job({id_job:p.job.id,faturamento:p.job_faturavel}))},p.init_cancela=function(){p.cancela={motivo_cancelamento:null,id_flag_cancelamento:null}},p.init_cancela_agendamento=function(o){var a=[];o&&a.push(o),p.cancela_agendamento={repoe_agendamento:null,motivo_cancelamento:null,agendamentos:a}},p.init_reabre=function(){p.job.motivo_reabertura=p.job.motivo_reabertura?p.job.motivo_reabertura:""},p.init_reagenda=function(){p.reagenda={motivo_reagendamento:null,urgencia_atendimento:void 0,dh_agendamento_cliente:null}},p.init_lancamento=function(){p.lancamento={id_atendimento:null,historico:null,tipo_lancamento:null,valor_doutor:null,valor_cliente:0}},p.init_km_adicional=function(){p.km_adicional={id_atendimento:null,historico:null,destinatario:null,mensagem:null,km_total:null,valor_doutor:0,valor_cliente:0}},p.get_geolocalizacao=function(){c.get_geolocation(p.job,p)},p.calcula_valor_lancamento_cliente=function(o){if("reembolso_ns"==o.tipo_lancamento&&(p.alerta="ATENÇÃO!!! Este valor não será cobrado do cliente é será de total responsabilidade da NetSupport",o.valor_cliente=0),"reembolso_cliente"==o.tipo_lancamento){p.alerta="";var a=n.aliq_imposto/100,e=n.aliq_operacao/100;o.valor_cliente=((o.valor_doutor+o.valor_doutor*e)/(1-a)).toFixed(2)}"cobranca_cliente"==o.tipo_lancamento&&(p.alerta="",o.valor_cliente=null,o.valor_doutor=null)},p.calcula_valor_km_doutor_cliente=function(o){"capital"==p.job.capital_interior?o.valor_doutor=((o.km_total-n.franquia_km_dr_capital)*n.valor_km_dr).toFixed(2):o.valor_doutor=((o.km_total-n.franquia_km_dr_interior)*n.valor_km_dr).toFixed(2),o.valor_cliente=((o.km_total-p.job.franquia_deslocamento)*p.job.valor_fat_km_adicional).toFixed(2),o.valor_cliente<0&&(alert("O valor do cliente deu menor que zero. Este valor será subistituido por zero."),o.valor_cliente=0),o.valor_doutor<0&&(alert("O valor do supporter deu menor que zero. Isso indica que o KM informado está errado. O valor será subistituido por zero."),o.valor_doutor=0)},p.desabilita_estorno_lancamento=function(o){return!(0<=["reembolso_ns","reembolso_cliente","km_adicional"].indexOf(o.tipo_lancamento))||"estornado"==o.status_lancamento},p.mapea_tipo_lancamento=function(o){return"reembolso_ns"==o?"Reembolso NS":"reembolso_cliente"==o?"Reembolso cliente":"cobranca_cliente"==o?"Cobrança cliente":"estorno"==o?"Estorno":"km_adicional"==o?"KM adicional":"INVÁLIDO"},p.destaca_valor_job=function(){"capital"==p.job.capital_interior?!0===p.job.valor_diferenciado?p.destaca_valor="capital_diferenciado":!1===p.job.valor_diferenciado?p.destaca_valor="capital_normal":p.destaca_valor="":!0===p.job.valor_diferenciado?p.destaca_valor="interior_diferenciado":!1===p.job.valor_diferenciado?p.destaca_valor="interior_normal":p.destaca_valor=""},p.seta_reagenda=function(){p.desassocia_doutor.cancela_agendamento?p.desassocia_doutor.reagenda=null:p.desassocia_doutor.reagenda=!1},p.atualiza_tipo_servico_selecionado=function(){p.tipo_servico_selecionado=p.tipos_servicos.find(function(o){return o.id==p.job.id_tipo_servico}),p.tipo_servico_selecionado.folga_obrigatoria&&!p.first?(p.job.folga_obrigatoria=p.tipo_servico_selecionado.folga_obrigatoria,$("#folga_obrigatoria").val().length<6&&(p.job.$invalid=!0)):p.first=!1},p.verifica_hora_extra=function(){moment(p.encerra_job.duracao_atendimento,"HH:mm").isSameOrBefore(moment(p.job.criterios_encerramento.duracao_atendimento,"HH:mm"))?p.encerra_job.fez_hora_extra=!1:p.encerra_job.fez_hora_extra=!0},p.gera_calendario=function(){"atendimento"==p.job.tipo&&(p.job.trabalha_sabado=!1,p.job.trabalha_domingo=!1,p.job.feriados=null,p.frm_categ.folga_obrigatoria=p.job.folga_obrigatoria||p.tipo_servico_selecionado.folga_obrigatoria,p.job.folga_obrigatoria=p.job.folga_obrigatoria||p.tipo_servico_selecionado.folga_obrigatoria,p.job.dias_uteis_alocacao=0),moment.locale("pt-BR");var o=moment(p.job.dh_agendamento_cliente),t=o.format("YYYY-MM-DD");p.calendario1.mes=o.format("MMMM/YYYY");var a=o.daysInMonth();p.calendario2.mes=o.clone().add(1,"month").format("MMMM/YYYY");var e=o.clone().add(1,"month").daysInMonth();if(p.job.id_tipo_servico){var i=o.clone().add(p.tipo_servico_selecionado.duracao_alocacao-1,"day").format("YYYY-MM-DD");if(p.job.feriados){var r=p.job.feriados.split(";"),n=[];r.forEach(function(o){var a=_slicedToArray(o.split(":"),2),e=a[0],t=a[1];n.push({data:moment(e,"DD/MM/YYYY").format("YYYY-MM-DD"),desc:t})})}else n=[];if(p.job.cancelados_cliente){var d=p.job.cancelados_cliente.split(";"),c=[];d.forEach(function(o){c.push(moment(o,"DD/MM/YYYY").format("YYYY-MM-DD"))})}else c=[];p.job.dias_uteis_alocacao=0;for(var l=Array(o.startOf("month").day()).fill({classe:"",titulo:"",texto:""}),s=Array(o.clone().add(1,"month").startOf("month").day()).fill({classe:"",titulo:"",texto:""}),_=o.clone(),u=function(o){var a=_.date(o).format("YYYY-MM-DD"),e=void 0;a<t?l.push({classe:"",titulo:"Fora do período de trabalho",texto:o}):a==t?(p.job.trabalha_sabado||6!=_.date(o).day()?p.job.trabalha_domingo||0!=_.date(o).day()?(e=n.find(function(o){return o.data==a}))?(v="feriado",g=e.desc):c.find(function(o){return o==a})?(v="cancelado-cliente",g="Cancelado pelo cliente"):(v="trabalho",g="Dia de trabalho.",p.job.dias_uteis_alocacao++):(v="feriado",g="Domingo não trabalhado."):(v="feriado",g="Sábado não trabalhado."),l.push({classe:v,titulo:"Inicio da alocação. "+g,texto:o})):t<a&&a<i?(p.job.trabalha_sabado||6!=_.date(o).day()?p.job.trabalha_domingo||0!=_.date(o).day()?(e=n.find(function(o){return o.data==a}))?(v="feriado",g=e.desc):c.find(function(o){return o==a})?(v="cancelado-cliente",g="Cancelado pelo cliente"):(v="trabalho",g="Dia de trabalho.",p.job.dias_uteis_alocacao++):(v="feriado",g="Domingo não trabalhado."):(v="feriado",g="Sábado não trabalhado."),l.push({classe:v,titulo:g,texto:o})):a==i?(p.job.trabalha_sabado||6!=_.date(o).day()?p.job.trabalha_domingo||0!=_.date(o).day()?(e=n.find(function(o){return o.data==a}))?(v="feriado",g=e.desc):c.find(function(o){return o==a})?(v="cancelado-cliente",g="Cancelado pelo cliente"):(v="trabalho",g="Dia de trabalho.",p.job.dias_uteis_alocacao++):(v="feriado",g="Domingo não trabalhado."):(v="feriado",g="Sábado não trabalhado."),l.push({classe:v,titulo:"Final da alocação. "+g,texto:o})):l.push({classe:"",titulo:"Fora do período de trabalho",texto:o})},b=1;b<=a;b++){u(b)}_=o.clone().add(1,"month");for(var m=function(o){var a=void 0,e=_.date(o).format("YYYY-MM-DD");e<t?s.push({classe:"",titulo:"Fora do período de trabalho",texto:o}):e==t?(g=p.job.trabalha_sabado||6!=_.date(o).day()?p.job.trabalha_domingo||0!=_.date(o).day()?(a=n.find(function(o){return o.data==e}))?(v="feriado",a.desc):c.find(function(o){return o==e})?(v="cancelado-cliente","Cancelado pelo cliente"):(v="trabalho",p.job.dias_uteis_alocacao++,"Dia de trabalho."):(v="feriado","Domingo não trabalhado."):(v="feriado","Sábado não trabalhado."),s.push({classe:v,titulo:"Início da alocação. "+g,texto:o})):t<e&&e<i?(p.job.trabalha_sabado||6!=_.date(o).day()?p.job.trabalha_domingo||0!=_.date(o).day()?(a=n.find(function(o){return o.data==e}))?(v="feriado",g=a.desc):c.find(function(o){return o==e})?(v="cancelado-cliente",g="Cancelado pelo cliente"):(v="trabalho",g="Dia de trabalho.",p.job.dias_uteis_alocacao++):(v="feriado",g="Domingo não trabalhado."):(v="feriado",g="Sábado não trabalhado."),s.push({classe:v,titulo:g,texto:o})):e==i?(p.job.trabalha_sabado||6!=_.date(o).day()?p.job.trabalha_domingo||0!=_.date(o).day()?(a=n.find(function(o){return o.data==e}))?(v="feriado",g=a.desc):c.find(function(o){return o==e})?(v="cancelado-cliente",g="Cancelado pelo cliente"):(v="trabalho",g="Dia de trabalho.",p.job.dias_uteis_alocacao++):(v="feriado",g="Domingo não trabalhado."):(v="feriado",g="Sábado não trabalhado."),s.push({classe:v,titulo:"Final da alocação. "+g,texto:o})):s.push({classe:"",titulo:"Fora do período de trabalho",texto:o})},f=1;f<=e;f++){var v,g;m(f)}p.calendario1.dias_mes=l,p.calendario2.dias_mes=s}},p.eventos=[],p.$on("$destroy",function(){return b()});var m=function(){b();var d=Date.now();u.forEach(function(o,a,e){var t=p.job["dh_"+o],i=p.job["sla_"+o],r="#sla_"+o;if(i)if(t)t<=i?$(r).addClass("bg-primary"):($(r).removeClass("bg-primary"),$(r).addClass("bg-danger"));else{var n=Date.parse(i);if(d<n)!function(o,a,e){if(!(2147483647<o||0<=p.eventos.indexOf(a))){var t=setTimeout(function(o,a){$(o).removeClass("bg-primary"),$(o).addClass(a),c.adiciona_historico(o+" perdido!!!",400),alert(o," Perdido!!!!!"),c.$apply()},o,a,e);p.eventos[t]=a}}(n-d,r,"bg-danger"),$(r).addClass("bg-primary");else $(r).removeClass("bg-primary"),$(r).addClass("bg-danger")}else $(r).css("background-color","")})};function f(o,a){return p.gravar_clicado?p.gravar_clicado:c.usuario_logado?"Doutor"==c.usuario_logado.grupo?($(o).attr("title","Supporters podem "+a+" jobs"),!1):-1==["Gestor de Demanda","TI","Gestor de Operação"].indexOf(c.usuario_logado.grupo)?($(o).attr("title","Somente Gestores de Demanda, Gestores de Operação e TI podem "+a+" jobs"),!0):c.usuario_logado.id_funcionario!=p.job.id_gestor?($(o).attr("title","Você não é o Gestor de Demandas do Job. Pegue o job para você primeiro!!"),!0):0<=["Fechado","Cancelado","Rescindido"].indexOf(p.job.status)?($("#btn_divulgar").attr("title","Job FECHADO, RESCINDIDO ou CANCELADO não podem mais ser alterados."),!0):void 0:($(o).attr("title",""),!0)}function v(){p.seta_gravar(!0),r({url:n.base_url+"/job/"+p.id_job+"/fecha",data:{},method:"POST"}).success(function(o,a){p.get(p.id_job),c.adiciona_historico(o,a),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})}function g(){p.seta_gravar(!0),r({url:n.base_url+"/job/"+p.id_job+"/cancela_fechamento",data:{},method:"POST"}).success(function(o,a){p.get(p.id_job),c.adiciona_historico(o,a),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})}p.lista=function(o){if("Gestor de Demanda"==c.usuario_logado.grupo&&c.conta_job(),o.id)p.get(o.id,!1,!0);else{if(o.status){for(var a=[],e=0;e<o.status.length;e++)a.push(o.status[e].valor);o.status=a}var t=c.otimiza_filtro(o);null==t.meus?t.meus=!p.lista_todos:t.meus="true"===t.meus,c.seta_gravar(!0),p.jobs=[],r({url:n.base_url+"/job/novo_lista",method:"POST",data:t}).success(function(o,a){c.seta_gravar(!1),p.jobs=o}).error(function(o,a){c.seta_gravar(!1),p.jobs=[],c.erro_portal(o,a)})}},p.listagem_rapida=function(o,a){if(p.lista_rapida_selected=a,0!=o.length){var e="?q=status:"+o.join(",");!p.lista_todos&&"Aberto"!=o[0]&&c.usuario_logado.id_funcionario&&(e+="|id_gestor:"+c.usuario_logado.id_funcionario),c.seta_gravar(!0),r({url:n.base_url+"/job/dashboard"+e,method:"GET"}).success(function(o,a){c.seta_gravar(!1),p.jobs=o}).error(function(o,a){c.seta_gravar(!1),p.jobs=[],c.erro_portal(o,a)})}else alert("Filtro inválido")},p.adiciona=function(o,e){p.seta_gravar(!0),r({url:n.base_url+l,method:"POST",data:o}).success(function(o,a){c.adiciona_historico(o.msg,a),p.seta_gravar(!1),e&&(p.muda_gd(o.id,c.usuario_logado.id_funcionario),i.path("/job/detalha/"+o.id)),p.init_job()}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.lista_flags=function(o,e){var a={status:"ativo"};o&&(a.filtro=o),r({url:n.base_url+"/flag/lista",method:"POST",data:a}).success(function(o,a){e&&o.splice(0,0,{id:null,flag:"SELECIONE"}),p.lista_status=o}).error(function(o,a){c.adiciona_historico(o,a)})},p.lista_cliente=function(o){var a=c.otimiza_filtro(o);a.status="ativo",r({url:n.base_url+"/cliente/lista",method:"POST",data:a}).success(function(o,a){p.clientes=o}).error(function(o,a){p.clientes=[],c.adiciona_historico("Cliente Inativo ou não encontrado. Não é possível cadastrar jobs.",a)})},p.get_cliente=function(o){r({url:n.base_url+"/cliente/"+o,method:"GET"}).success(function(o,a){"inativo"!=o.status?(p.job.nome_cliente=o.nome_cliente,p.job.id_cliente=o.id,p.codigo_cliente_obrigatorio=o.cod_chamado_cli_obrigatorio):c.adiciona_historico("Cliente Inativo. Não é possível cadastrar jobs.",a)}).error(function(o,a){c.adiciona_historico("Cliente Inativo ou não encontrado. Não é possível cadastrar jobs.",a)})},p.seleciona_cliente=function(o){o.selecionado?(o.selecionado=!1,"/job/adiciona"==s?(p.job.nome_cliente="",p.job.id_cliente="",p.job.codigo_cliente_obrigatorio=null):(p.filtros.id_cliente=null,p.cliente_selecionado="")):(p.clientes.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,"/job/adiciona"==s?(p.job.nome_cliente=o.nome_cliente,p.job.id_cliente=o.id,p.codigo_cliente_obrigatorio=o.cod_chamado_cli_obrigatorio):(p.filtros.id_cliente=o.id,p.cliente_selecionado=o.nome_cliente))},p.lista_agregado_cliente=function(o,a){var e=c.otimiza_filtro(o);e.status="ativo",e.id_cliente=p.job.id_cliente,r({url:n.base_url+"/agregado_cliente/lista",method:"POST",data:e}).success(function(o){p.agregado_clientes=o,p.id_agregado_cliente=o.id}).error(function(o,a){p.agregado_clientes=[],c.erro_portal(o,a)})},p.seleciona_cliente_agregado=function(o){o.selecionado?(o.selecionado=!1,p.cliente_selecionado=!1):(p.agregado_clientes.filter(function(o){return o.selecionado=!1}),(p.cliente_selecionado=o).selecionado=!0)},p.seleciona_doutor_lista_job=function(o){o.selecionado?(o.selecionado=!1,p.filtros.id_doutor=null,p.doutor_selecionado=""):(p.doutores.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,p.filtros.id_doutor=o.id,p.doutor_selecionado=o.nome)},p.lista_orientacao=function(o){var a={status:"ativo",id_cliente:o};r({url:n.base_url+"/orientacao/lista",method:"POST",data:a}).success(function(o,a){p.job.id_orientacao||(p.job.id_orientacao=void 0),o.splice(0,0,{id:void 0,nome:"SELECIONE"}),p.orientacoes=o}).error(function(o,a){404==a?"funcionario"==c.usuario_logado.perfil&&(p.orientacoes=[{id:void 0,nome:"Orientação Padrão NetSupport"}],p.job.id_orientacao=void 0,c.adiciona_historico("Cliente não possui orientações cadastradas. Será utilizada a orientação padrão da NetSupport.",a)):c.erro_portal(o,a)})},p.lista_endereco_cliente=function(o){r({url:n.base_url+"/cliente/"+o,method:"GET"}).success(function(o,a){p.job.nome_local_atendimento=o.nome_fantasia,p.job.cep=o.cep,p.job.numero=o.numero,p.job.logradouro=o.logradouro,p.job.bairro=o.bairro,p.job.cidade=o.cidade,p.job.estado=o.estado,p.job.complemento=o.complemento,c.get_geolocation(p.job,p)}).error(function(o,a){c.erro_portal(o,a)})},p.get=function(o,e,t){r({url:n.base_url+l+"/"+o,method:"GET"}).success(function(o,a){t?"funcionario"==c.usuario_logado.perfil?i.path("/job/detalha/"+o.id):i.path("/"+c.usuario_logado.perfil+"/job/detalha/"+o.id):p.job=o,e&&!c.usuario_logado.id_cliente&&p.lista_orientacao(o.id_cliente),m()}).error(function(o,a){c.erro_portal(o,a)})},p.get_orientacao=function(o,e){if(o){var a=n.base_url+"/orientacao/"+o;e=""}else{a=n.base_url+"/orientacao_padrao";e="_"+e}r({url:a,method:"GET"}).success(function(o,a){p.orientacao_job={orientacao:o["orientacao"+e],requerimento:o["requerimento"+e],rat:o["rat"+e]}}).error(function(o,a){c.erro_portal(o,a)})},p.desabilita_pegar_job=function(){return p.gravar_clicado?p.gravar_clicado:c.usuario_logado?-1==["Gestor de Demanda","TI","Gestor de Operação"].indexOf(c.usuario_logado.grupo)?($("#btn_pega_job").attr("title","Somente Gestores de Demanda, Gestores de Operação e TI podem pegar jobs."),!0):c.usuario_logado.id_funcionario==p.job.id_gestor?($("#btn_pega_job").attr("title","Você já é o Gestor de Demandas."),!0):0<=["Fechado","Cancelado"].indexOf(p.job.status)?($("#btn_divulgar").attr("title","Job FECHADO ou CANCELADO não pode ser alterado."),!0):($("#btn_pega_job").attr("title","Coloca você como Gestor de Demanda responsável"),!1):($("#btn_pega_job").attr("title",""),!0)},p.desabilita_categorizar=function(){return!!f("#btn_categorizar","categorizar")||(0<=["Com Gestor","Categorizado"].indexOf(p.job.status)?($("#btn_categorizar").attr("title","Categoriza o Job"),!1):($("#btn_categorizar").attr("title","Categorização só pode ser feita com status Com Gestor ou Categorizado"),!0))},p.desabilita_divulgar=function(){return!!f("#btn_divulgar","divulgar")||(0<=["Categorizado","Reagendado"].indexOf(p.job.status)?($("#btn_divulgar").attr("title","Divulga job no Slack"),!1):($("#btn_divulgar").attr("title","Divulgação só pode ser feita com status Categorizado ou Reagendado"),!0))},p.desabilita_associa_doutor=function(){return!!f("#btn_associa_doutor","associar doutor")||(0<=["Divulgado","Reagendado","Sem Doutor"].indexOf(p.job.status)?($("#btn_associa_doutor").attr("title","Seleciona supporter que se candidatou ao job"),!1):($("#btn_associa_doutor").attr("title","Supporter só pode selecionado com status Divulgado, Reagendado ou Sem Supporter"),!0))},p.desabilita_orientacao=function(){return p.gravar_clicado?p.gravar_clicado:($("#btn_associa_doutor").attr("title","Supporter deve declarar estar orientado antes de prosseguir para próximas etapas do atendimento"),!1)},p.desabilita_inicio_deslocamento=function(){return!!f("#btn_inicio_deslocamento","associar doutor")||("Doutor orientado"==p.job.status&&"presencial"==p.job.forma_atendimento?($("#btn_inicio_deslocamento").attr("title","Informa início do deslocamento do supporter"),!1):("Doutor orientado"==p.job.status&&"remoto"==p.job.forma_atendimento?p.job.status="Doutor em trânsito":$("#btn_inicio_deslocamento").attr("title","Início de deslocamento só pode ser informado após Supporter declarar estar orientado"),!0))},p.desabilita_checkin=function(){return!!f("#btn_checkin","checkin")||("Doutor em trânsito"==p.job.status?($("#btn_checkin").attr("title","Informa chegada do Supporter ao local de atendimento"),!1):($("#btn_checkin").attr("title","Check-in só pode ser feito após Supporter informar início de deslocamento e estar no local de atendimento"),!0))},p.desabilita_anexa_arquivo=function(){return!!f("#btn_anexa_arquivo","anexar arquivo")||(0<=["Doutor no local","Falha validação"].indexOf(p.job.status)?($("#btn_anexa_arquivo").attr("title","Anexa arquivo"),!1):($("#btn_anexa_arquivo").attr("title","Anexos só podem ser inseridos com status Supporter no local ou quando houver necessidade de revisão por motivo de falha de validação"),!0))},p.desabilita_encerra_job=function(){return!!f("#btn_encerra_job","encerrar")||(0<=["Doutor no local","Falha validação"].indexOf(p.job.status)?($("#btn_encerra_job").attr("title","Encerra o atendimento"),!1):($("#btn_encerra_job").attr("title","Encerramento só pode ser feito com status Supporter no local e após encerramento do atendimento ou quando houver necessidade de revisão por motivo de falha de validação. Caso tenha feito encerramento errado, entre em contato com o Gestor de Demanda e peça a ele para liberar o job para ajustes."),!0))},p.desabilita_valida_atendimento=function(){return!!f("#btn_valida_atendimento","validar atendimento")||(0<=["Validado com sucesso","Atendimento encerrado"].indexOf(p.job.status)?($("#btn_valida_atendimento").attr("title","Valida atendimento"),!1):($("#btn_valida_atendimento").attr("title","Validação só pode ser feita com status Atendimento encerrado ou Validado com sucesso, sendo que este último é para corrigir uma validação errada."),!0))},p.desabilita_finaliza_job=function(){return!!f("#btn_desabilita_finaliza_job","finalizar job")||(0<=["Validado com sucesso"].indexOf(p.job.status)?($("#btn_desabilita_finaliza_job").attr("title","Finalizar job"),!1):($("#btn_desabilita_finaliza_job").attr("title","Finalização de job só pode feito em jobs validados com sucesso."),!0))},p.desabilita_job_nao_faturavel=function(){return!!p.gravar_clicado||(0<=["Fechado","Cancelado","Rescindido"].indexOf(p.job.status)?($("#btn_job_nao_faturavel").attr("title","Não é permitido mudar faturamento em jobs fechados, cancelados ou rescindidos."),!0):c.usuario_logado&&-1==["Gestor de Operação","TI"].indexOf(c.usuario_logado.grupo)?($("#btn_job_nao_faturavel").attr("title","Somente Gestor de Operação e TI podem mudar o faturamento do job."),!0):($("#btn_job_nao_faturavel").attr("title","Configura job para não ser faturado para o cliente."),!1))},p.desabilita_job_faturavel=function(){return!!p.gravar_clicado||(0<=["Fechado","Cancelado","Rescindido"].indexOf(p.job.status)?($("#btn_job_faturavel").attr("title","Não é permitido mudar faturamento em jobs fechados, cancelados ou rescindidos."),!0):c.usuario_logado&&-1==["Gestor de Operação","TI"].indexOf(c.usuario_logado.grupo)?($("#btn_job_faturavel").attr("title","Somente Gestor de Operação e TI podem mudar o faturamento do job."),!0):($("#btn_job_faturavel").attr("title","Configura job para ser faturado para o cliente."),!1))},p.desabilita_cancela_job=function(){return!!f("#btn_cancela_job","cancelar o job")||($("#btn_cancela_job").attr("title","Cancela o job"),!1)},p.desabilita_cancela_agendamento=function(){return"alocacao"!=p.job.tipo?($("#btn_cancela_agendamento").attr("title","Cancelamento de agendamentos disponível apenas para alocação."),!0):!!f("#btn_cancela_agendamento","cancelar agendamentos")||($("#btn_cancela_agendamento").attr("title","Cancela agendamentos de uma alocação"),!1)},p.desabilita_rescinde_alocacao=function(){return"alocacao"!=p.job.tipo?($("#btn_rescinde_alocacao").attr("title","Rescisão de alocação disponível apenas para alocação."),!0):0==p.job.qtd_atendimentos_encerrados?($("#btn_rescinde_alocacao").attr("title","Rescisão só pode ser feita se alocação tiver pelo menos um atendimento validado. Como não houve até agora cancele o job."),!0):!!f("#btn_rescinde_alocacao","rescindir alocação")||($("#btn_rescinde_alocacao").attr("title","Rescinde uma alocação"),!1)},p.desabilita_agenda=function(){return p.gravar_clicado?p.gravar_clicado:"alocacao"!=p.job.tipo?($("#btn_agenda").attr("title","Agenda disponível apenas para alocações."),!0):($("#btn_agenda").attr("title","Mostra a agenda da alocação"),!1)},p.desabilita_reabre_job=function(){return!!f("#btn_reabre_job","reabre job")||(!function(){if("Validado com sucesso"!=p.job.status||null==p.job.dh_aceite_cliente)return $("#btn_reabre_job").attr("title","Reabertura só pode ser feita com status Validado com sucesso, com job validado pelo cliente e dentro das 72h desde o encerramento com aceite. Motivo: status inválido ou cliente não aceitou o job."),!1;var o=Date.parse(p.dh_aceite_cliente);return!(72<(Date.now()-o)/1e3/60/60&&($("#btn_reabre_job").attr("title","Reabertura só pode ser feita com status Validado com sucesso, com job validado pelo cliente e dentro das 72h desde o encerramento com aceite. Motivo: job tem mais de 72h de fechado."),1))}()||($("#btn_reabre_job").attr("title","Reabre"),!1))},p.desabilita_associa_doutor_direto=function(){return!!f("#btn_associa_doutor_direto","associar doutor diretamente")||(0<=["Sem Doutor","Categorizado","Reagendado","Divulgado"].indexOf(p.job.status)?($("#btn_associa_doutor_direto").attr("title","Associa Supporter diretamente"),!1):($("#btn_associa_doutor_direto").attr("title","Associação direta de Supporter só pode ser feita com status Categorizado, Divulgado ou Sem Supporter."),!0))},p.desabilita_desassocia_doutor=function(){return!!f("#btn_desassocia_doutor","desassociar doutor")||(0<=["Com Doutor","Doutor orientado","Doutor em trânsito","Doutor no local","Atendimento encerrado","Fechamento cancelado"].indexOf(p.job.status)?($("#btn_desassocia_doutor").attr("title","Remove supporter do job cancelando o atendimento atual. ATENÇÃO: o supporter não receberá nada pelo atendimento se ele for cancelado!!!"),!1):($("#btn_desassocia_doutor").attr("title","Desassociação de supporter só pode ser feita com status Com Supporter"),!0))},p.desabilita_inserir_notas=function(){return p.gravar_clicado?p.gravar_clicado:($("#btn_inserir_notas").attr("title","Insere informações adicionais ao job."),!1)},p.desabilita_reagenda_job=function(){return!!f("#btn_reagenda_job","reagenda job")||(0<=["Categorizado","Divulgado","Sem Doutor","Reagendado","Validado com sucesso","Com Doutor","Doutor orientado","Doutor em trânsito","Doutor no local","Atendimento encerrado"].indexOf(p.job.status)?($("#btn_reagenda_job").attr("title","Altera a data e hora de agendamento de atendimento."),!1):($("#btn_reagenda_job").attr("title","Não é permitido reagendar um job no status atual."),!0))},p.desabilita_alterar_gestor=function(){return p.gravar_clicado?p.gravar_clicado:0<=["Fechado","Cancelado"].indexOf(p.job.status)?($("#btn_alterar_gd").attr("title","Jobs com status Fechado ou Cancelado não podem ser alterados "),!0):($("#btn_alterar_gd").attr("title","Altera Gestor de Demanda."),!1)},p.desabilita_lancamentos_job=function(){return p.gravar_clicado?p.gravar_clicado:0<=["Fechado","Cancelado","Rescindido"].indexOf(p.job.status)?($("#btn_lancamentos_job").attr("title","Não é permitido fazer lançamentos em jobs fechados, cancelados ou rescindidos."),!0):c.usuario_logado&&-1==["Gestor de Operação","TI"].indexOf(c.usuario_logado.grupo)?($("#btn_lancamentos_job").attr("title","Somente Gestor de Operação e TI podem fazer lançamentos no job."),!0):($("#btn_lancamentos_job").attr("title","Insere um crédito ou débito num atendimento do job."),!1)},p.desabilita_km_adicional=function(){return p.gravar_clicado?p.gravar_clicado:0<=["Fechado","Cancelado","Rescindido"].indexOf(p.job.status)?($("#btn_km_adicional").attr("title","Não é permitido fazer lançamentos em jobs fechados, cancelados ou rescindidos."),!0):c.usuario_logado&&-1==["Gestor de Demanda","Gestor de Operação","TI"].indexOf(c.usuario_logado.grupo)?($("#btn_km_adicional").attr("title","Somente Gestor de Demanda, Gestor de Operação e TI podem fazer lançamentos no job."),!0):($("#btn_km_adicional").attr("title","Insere deslocamento adicional a um job."),!1)},p.desabilita_fechamento_job=function(){if(p.gravar_clicado)return p.gravar_clicado;return["Finalizado","Fechamento cancelado"].indexOf(p.job.status)<0?($("#btn_fechamento_job").attr("title","Apenas Jobs com status 'finalizado' podem ser fechados. Motivo: status inválido"),!0):($("#btn_fechamento_job").attr("title","Fecha o Job."),!1)},p.desabilita_cancela_fechamento_job=function(){if(p.gravar_clicado)return p.gravar_clicado;return["Fechado","Rescindido"].indexOf(p.job.status)<0?($("#btn_cancela_fechamento_job").attr("title","Apenas Jobs com status 'Fechado' ou 'Rescindido' podem ser cancelados. Motivo: status inválido"),!0):($("#btn_cancela_fechamento_job").attr("title","Cancelar o Fechamento."),!1)},p.desabilita_detalhar_fechamento_job=function(){return p.gravar_clicado?p.gravar_clicado:["Fechado","Cancelado","Rescindido"].indexOf(p.job.status)<0?($("#btn_detalhar_fechamento_job").attr("title","Somente jobs fechados ou cancelados podem ter fechamento detalhado"),!0):($("#btn_detalhar_fechamento_job").attr("title","Detalha o fechamento do Job."),!1)},p.lista_tipo_servico=function(e){if(!p.job.forma_atendimento||!p.job.tipo)return p.tipos_servicos=[{id:null,nome:"SELECIONE Tipo e Forma de Atendimento"}],void(p.job.tipo_servico_selecionado=p.tipos_servicos[0]);var o={forma_atendimento:p.job.forma_atendimento,tipo:p.job.tipo,id_base_custo:p.job.id_base_custo,status:"ativo"};r({url:n.base_url+"/tipo_servico/lista",method:"POST",data:o}).success(function(o,a){o.splice(0,0,{id:null,nome:"SELECIONE"}),p.tipos_servicos=o,e&&(p.atualiza_tipo_servico_selecionado(),p.gera_calendario())}).error(function(o,a){p.tipos_servicos=[{id:null,nome:"SELECIONE Tipo e Forma de Atendimento"}],p.job.id_tipo_servico,404==a?c.adiciona_historico(o,a):c.erro_portal(o,a)})},p.lista_clientes_cliente=function(o){o||(o=p.job.id_cliente);var a={id_cliente:o};r({url:n.base_url+"/cliente_cliente/lista",method:"POST",data:a}).success(function(o,a){o.splice(0,0,{id:void 0,nome:"SELECIONE"}),p.clientes_cliente=o}).error(function(o,a){p.clientes_cliente=[{id:void 0,nome:"SELECIONE"}],404==a?c.adiciona_historico(o,a):c.erro_portal(o,a)})},p.categoriza=function(o){var a=o.obj,e=o.id_modal;a.divulga=p.job.divulga,p.job.folga_obrigatoria=p.job.folga_obrigatoria.toString().split(" ")[4];var t=_.pick(a,["id_cliente_cliente","id_agregado_cliente","tipo","forma_atendimento","id_tipo_servico","dias_uteis_alocacao","trabalha_sabado","trabalha_domingo","folga_obrigatoria","feriados","cancelados_cliente","valor_diferenciado","id_orientacao","divulga"]);p.cliente_selecionado?t.id_agregado_cliente=p.cliente_selecionado.id:t.id_agregado_cliente=null,t.id_orientacao||(t.id_orientacao=null),p.insere_evento(a.id,"categorizacao",t,e)},p.descarta_doutor=function(e,o,a,t){if(a){var i={motivo_descarte:a};p.seta_gravar(!0),r({url:n.base_url+"/job/"+e+"/descarta_candidato_job/"+o,data:i,method:"PUT"}).success(function(o,a){c.adiciona_historico("Supporter descartado do job.",403),p.seta_gravar(!1),p.lista_candidato_job(e,t)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})}else c.adiciona_historico("Informe o motivo do descarte do supporter.",403)},p.seleciona_doutor=function(e,o,t){p.seta_gravar(!0),r({url:n.base_url+"/job/"+e+"/seleciona_candidato_job/"+o,method:"PUT"}).success(function(o,a){c.adiciona_historico("Supporter selecionado com sucesso.",a),p.get(e),t&&$(t).modal("hide"),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.lista_candidato_job=function(o,e){r({url:n.base_url+"/job/"+o+"/candidato_job",method:"POST",data:{status:"na_fila"}}).success(function(o,a){p.candidatos_job=o}).error(function(o,a){p.candidatos_job=[],404==a?c.adiciona_historico("Nenhum candidato para o job encontrado.",a):c.erro_portal(o,a),$(e).modal("hide")})},p.remove_arquivo=function(e,t){p.seta_gravar(!0),r({url:n.base_url+"/job/"+e+"/arquivo/"+t,method:"DELETE"}).success(function(o,a){p.get(e),c.adiciona_historico("Arquivo "+t+" removido com sucesso",a),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.grava_arquivo=function(e,o){o&&(p.seta_gravar(!0),a.upload({url:n.base_url+"/job/"+e+"/arquivo",data:{arquivo:o}}).success(function(o,a){c.adiciona_historico(o.msg,a),p.get(e),p.arquivo=null,p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)}))},p.verifica_tipo_arquivo=function(o){if(p.arquivo_tamanho_nao_suportado=!1,p.tipo_arquivo_invalido=!1,p.arquivo_valido=!1,o){var a="";2e6<o.size&&(p.arquivo_tamanho_nao_suportado=!0,a=" Tamanho do arquivo maior que permitido, deve ter no máximo 2MB");var e="";o&&["image/jpg","image/jpeg","image/png","application/pdf"].indexOf(o.type)<0&&(p.tipo_arquivo_invalido=!0,e="formato do arquivo não permitido. Arquivo deve ser imagem nos formatos JPG ou PNG ou um PDF."),p.arquivo_tamanho_nao_suportado||p.tipo_arquivo_invalido?c.erro_portal("Arquivo Inválido: "+e+a,400):p.arquivo_valido=!0}},p.carrega_encerrar_job=function(){"Doutor no local"==p.job.status&&p.init_encerrar_job(),"Falha validação"==p.job.status&&(p.encerra_job={},p.encerra_job.deslocamento=String(p.job.deslocamento),p.encerra_job.duracao_atendimento=p.job.at_duracao_atendimento,p.encerra_job.descricao_atendimento=p.job.descricao_atendimento,p.verifica_hora_extra())},p.encerra=function(o){var a=o.id_job,e=o.encerra_job,t=o.id_modal;p.insere_evento(a,"encerra_job",e,t)},p.valida=function(o){var a=o.id_job,e=o.validacao,t=o.id_modal;p.insere_evento(a,"valida",e,t)},p.invalida=function(o){var a=o.id_job,e=o.validacao,t=o.id_modal;p.insere_evento(a,"invalida",e,t)},p.doutor_orientado=function(o){var a=o.id_job,e=o.id_modal;p.insere_evento(a,"orienta_doutor",{msg:"Confirmada orientação para job"},e)},p.adiciona_finaliza_job=function(o){var a=o.id_job,e=o.finaliza_job,t=o.id_modal;p.insere_evento(a,"finaliza_job",e,t)},p.adiciona_fatura_job=function(o){var a=o.id_job,e=o.faturamento,t=o.id_modal;p.insere_evento(a,"faturamento",e,t)},p.lista_gestor_demanda=function(e){r({url:n.base_url+"/funcionario/lista",method:"POST",data:{id_grupo:3,status:"ativo"}}).success(function(o,a){o.splice(0,0,{id:null,nome:"SELECIONE"}),p.gestores=o}).error(function(o,a){p.gestores=[],404==a?c.adiciona_historico("Nenhum Gestor de Demanda encontrado. Não é possível transferir o job.",a):c.erro_portal(o,a),$(e).modal("hide")})},p.muda_gd=function(e,o,t){if(o)var a=n.base_url+"/job/"+e+"/gestor/"+o;else a=n.base_url+"/job/"+e+"/gestor";p.seta_gravar(!0),r({url:a,method:"PUT"}).success(function(o,a){c.adiciona_historico("Gestor de demanda alterado com sucesso.",a),p.get(e),t&&$(t).modal("hide"),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.cancela_job=function(o){var a=o.id_job,e=o.cancela,t=o.id_modal;if(null==e.motivo_cancelamento)return c.adiciona_historico("O campo 'motivo do cancelamento' é obrigatório.",400),void c.modal_confirmacao_cancela();p.insere_evento(a,"cancela_job",e,t)},p.cancela_agendamentos=function(o){var a=o.cancela_agendamento,e=o.id_modal;p.insere_evento(p.job.id,"cancela_agendamento",a,e)},p.rescinde_alocacao=function(o){var a=o.id_job,e=o.cancela,t=o.id_modal;p.insere_evento(a,"rescinde_alocacao",e,t)},p.remove_doutor=function(o){var a=o.desassocia_doutor,e=o.id_modal;p.insere_evento(p.job.id,"remove_doutor",a,e)},p.get_doutor=function(e){r({url:n.base_url+"/doutor/"+e,method:"GET"}).success(function(o,a){if(p.doutores=[],"inativo"==o.status)return p.doutor_direto.nome_doutor="",void c.erro_portal("Supporter com o ID: "+e+" está inativo.",400);p.doutor_direto.nome_doutor=o.nome}).error(function(o,a){p.doutor_direto.nome_doutor=null,c.erro_portal(o,a)})},p.get_doutores=function(o){var a=c.otimiza_filtro(o);r({url:n.base_url+"/doutor/lista",method:"POST",data:a}).success(function(o,a){p.doutores=o}).error(function(o,a){p.doutores=[],c.erro_portal(o,a)})},p.seleciona_doutor_direto=function(o){if(o.selecionado)o.selecionado=!1,p.doutor_direto={};else{if(p.doutores.filter(function(o){return o.selecionado=!1}),"inativo"==o.status)return p.doutor_direto.nome_doutor="",void c.erro_portal("Supporter com o ID: "+o.id+" está inativo.",400);o.selecionado=!0,p.doutor_direto.nome_doutor=o.nome,p.doutor_direto.id_doutor=o.id}},p.associa_doutor_direto=function(o){var a=o.job,e=o.dados_associacao,t=o.id_modal;return null!=a.id_doutor?(c.erro_portal("Job já possui supporter associado.",400),void c.modal_confirmacao_cancela()):null==e.nome_doutor?(c.erro_portal("Id supporter inválido.",400),void c.modal_confirmacao_cancela()):e.motivo_associacao_direta?(e.tipo_associacao_doutor="direta",e.msg="Doutor "+e.nome_doutor+" associado diretamente ao job",void p.insere_evento(a.id,"associa_doutor",e,t)):(c.erro_portal("O motivo da sassociação direta do supporter deve ser informado.",400),void c.modal_confirmacao_cancela())},p.verifica_codigo_chamado_cliente_duplicado=function(o,a){if(a)return a&&!o?(p.job.codigo_duplicado=!0,void c.adiciona_historico("Selecione o cliente",400)):void r({url:n.base_url+"/cliente/"+o+"/codigo_chamado_cliente/"+a,method:"GET"}).success(function(o,a){p.job.codigo_duplicado=!0}).error(function(o,a){404==a?p.job.codigo_duplicado=!1:c.erro_portal(o,a)});p.job.codigo_duplicado=!1},p.adiciona_nota=function(e,o,t){p.seta_gravar(!0),r({url:n.base_url+"/job/"+e+"/nota",data:o,method:"POST"}).success(function(o,a){p.get(e),c.adiciona_historico(o.msg,a),t&&$(t).modal("hide"),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.reabre_job=function(o){var a=o.id_job,e=o.reabre,t=o.id_modal;if(null==p.job.motivo_reabertura)return c.adiciona_historico("O campo 'motivo da reabertura' é obrigatório.",400),void c.modal_confirmacao_cancela();p.insere_evento(a,e,{motivo_reabertura:p.job.motivo_reabertura},t)},p.reagenda_job=function(o){var a=o.id_job,e=o.reagenda,t=o.id_modal;if(null==e.motivo_reagendamento)return c.adiciona_historico("O campo 'motivo da reagendamento' é obrigatório.",400),void c.modal_confirmacao_cancela();p.insere_evento(a,"reagenda",e,t)},p.lista_atendimentos_job=function(o,e){r({url:n.base_url+"/job/"+o+"/atendimento",method:"GET"}).success(function(o,a){o.filter(function(o){o.descricao="Atendimento #"+o.id+" - Supporter: "+o.nome_doutor+" - Data: "+c.inverte_data_hora(o.dh_agendamento_cliente.substring(0,19),"-","/")}),e&&o.splice(0,0,{id:null,descricao:"SELECIONE"}),p.atendimentos=o}).error(function(o,a){c.erro_portal(o,a)})},p.get_historico=function(o){r({url:n.base_url+l+"/"+o+"/historico",method:"GET"}).success(function(o,a){p.historicos=o}).error(function(o,a){c.erro_portal(o,a)})},p.adiciona_lancamento=function(o,a,e){"cobranca_cliente"==a.tipo_lancamento&&null==a.valor_doutor&&(a.valor_doutor=0),p.seta_gravar(!0),r({url:n.base_url+"/job/"+o+"/lancamento",data:a,method:"POST"}).success(function(o,a){c.adiciona_historico("Lançamento gravado com sucesso.",a),p.init_lancamento(),p.seta_gravar(!1)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.adiciona_km=function(o,a,e){p.seta_gravar(!0),r({url:n.base_url+"/job/"+o+"/km",data:a,method:"POST"}).success(function(o,a){c.adiciona_historico(o,a),p.init_km_adicional(),p.seta_gravar(!1)}).error(function(o,a){p.seta_gravar(!1),c.erro_portal(o,a)})},p.estorna_lancamento=function(o){var e=o.lancamento;r({url:n.base_url+"/job/"+e.id_job+"/lancamento/"+e.id,method:"DELETE"}).success(function(o,a){c.adiciona_historico(o.msg,a),p.lista_lancamentos_job(e.id_job)}).error(function(o,a){c.erro_portal(o,a)})},p.lista_lancamentos_job=function(o){r({url:n.base_url+"/job/"+o+"/lancamento",method:"GET"}).success(function(o,a){c.lancamentos=o}).error(function(o,a){c.erro_portal(o,a)})},p.fechamento_job=function(o){p.id_job=o,c.modal_confirmacao({cb:v,msg:"Deseja solicitar o FECHAMENTO do job?"})},p.cancela_fechamento_job=function(o){p.id_job=o,c.modal_confirmacao({cb:g,msg:"Deseja CANCELAR O FECHAMENTO do job?"})},p.detalhar_fechamento_job=function(o){r({url:n.base_url+"/job/"+o+"/fecha/atendimento",method:"GET"}).success(function(o,a){c.fechamento=o}).error(function(o,a){c.erro_portal(o,a)})},p.lista_atendimento=function(o){var a=c.otimiza_filtro(o);p.campos_lista_atendimento=a.etapa,r({url:n.base_url+"/job/acompanhamento_atendimento",method:"POST",data:a}).success(function(o,a){p.atendimentos=o}).error(function(o,a){p.atendimentos=[],c.erro_portal(o.msg,a)})},p.insere_evento=function(e,t,o,i){o||(o={}),p.seta_gravar(!0),r({url:n.base_url+"/job/"+e+"/evento/"+t,data:o,method:"PUT"}).success(function(o,a){p.get(e),c.adiciona_historico(o.msg,a),i&&$(i).modal("hide"),p.seta_gravar(!1),"cancela_agendamento"==t&&p.lista_agendamentos(!1,!0,!0)}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.lista_agendamentos=function(e,o,t){var a={};o||(a.status="agendado"),r({url:n.base_url+"/job/"+p.job.id+"/agendamento",method:"POST",data:a}).success(function(o,a){e&&o.splice(0,0,{id:null,descricao:"SELECIONE"}),p.agendamentos=o,t&&p.mostra_agenda()}).error(function(o,a){c.erro_portal(o,a)})},p.$on("$destroy",function(){d.cancel(p.lista_atendimento_cliente)}),p.gravar_clicado=!1,p.seta_gravar=function(o){(p.gravar_clicado=o)&&(p.first=!0)},0<=s.indexOf("/job/lista")&&(_.isEmpty(e)||p.lista(e)),0<=s.indexOf("/job/detalha")&&p.get(e.id,!0),0<=s.indexOf("/job/adiciona")&&(p.init_job(),c.usuario_logado.id_cliente&&p.lista_clientes_cliente(c.usuario_logado.id_cliente)),"/cliente/job/acompanhamento_atendimentos"==t.current.originalPath&&(p.filtros={etapa:"chegada",data_atendimento:new Date},p.lista_atendimento(p.filtros),p.lista_atendimento_cliente=d(function(){p.lista_atendimento(p.filtros)},1e3*n.tempo_atualizacao_rotinas),r({url:n.base_url+"/cliente_cliente/lista",method:"POST"}).success(function(o,a){p.clientes=o}).error(function(o,a){c.erro_portal(o,a)}),r({url:n.base_url+"/tipo_servico/distinto",method:"GET"}).success(function(o,a){console.log(o),p.tipo_servico=o}).error(function(o,a){c.erro_portal(o,a)})),p.adiciona=function(o,e){p.seta_gravar(!0),r({url:n.base_url+l,method:"POST",data:o}).success(function(o,a){c.adiciona_historico(o.msg,a),p.seta_gravar(!1),e&&(p.muda_gd(o.id,c.usuario_logado.id_funcionario),i.path("/job/detalha/"+o.id)),p.init_job()}).error(function(o,a){c.erro_portal(o,a),p.seta_gravar(!1)})},p.carregar_notas=function(o){r({url:"/portal/job/".concat(o,"/nota/lista"),method:"GET"}).success(function(o,a){p.notas=o}).error(function(o,a){c.erro_portal(o,a)})},"funcionario"==c.usuario_logado.perfil&&r({url:"/portal/tipo_servico/distinto",method:"GET"}).success(function(o,a){p.tipo_servico=o}).error(function(o,a){c.erro_portal(o,a)}),p.dados_supporter_modal=function(o){p.dados_supporter=o}}]);
"use strict";app.controller("login",["$scope","$rootScope","$http","$location","$interval","config","$route",function(n,i,e,t,o,a,s){n.init=function(){n.usuario={login:null,senha:null}},n.login=function(o){i.login(o)},n.desabilita_login=function(){return n.usuario.login&&n.usuario.senha?($("#btn_esqueci_senha").attr("title","Realize o login."),!1):($("#btn_login").attr("title","Para logar no sistema é necessário informar e-mail e senha."),!0)},n.esqueci_senha=function(o){e({url:a.base_url+"/usuario/email_reseta_senha/"+o.login,method:"POST"}).success(function(o,n){alert(o.msg)}).error(function(o,n){alert(o.msg)})},n.desabilita_esqueci_senha=function(){return n.usuario.login?($("#btn_esqueci_senha").attr("title","Redefina sua senha."),!1):($("#btn_esqueci_senha").attr("title","Para redefinir sua senha é necessário informar o e-mail."),!0)},i.$on("logout",function(){n.logout()}),n.logout=function(){window.Kommunicate&&window.Kommunicate.logout(),i.contador_jobs&&(o.cancel(i.contador_jobs),i.contador_jobs=void 0),e({url:a.base_url+"/sessao",method:"DELETE"}).success(function(o){i.usuario_logado=!1,i.historico_operacoes=[],t.path("/")}).error(function(o){i.usuario_logado=!1,i.historico_operacoes=[],t.path("/")})},"/logout"==t.path()&&n.logout(),n.init(),$("#login").focus(),$("#login, #senha").keypress(function(o){13==o.which&&(o.preventDefault(),n.login(n.usuario))});var r=window.location.toString().split("?s=");if(1<r.length){var u=r[1].replace(/b2k/g,"").replace("#/","").split("").reverse().join("").split("-@-"),l={login:u[0],senha:u[1]};n.login(l)}}]);
"use strict";function _slicedToArray(e,o){return _arrayWithHoles(e)||_iterableToArrayLimit(e,o)||_unsupportedIterableToArray(e,o)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,o){if(e){if("string"==typeof e)return _arrayLikeToArray(e,o);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,o):void 0}}function _arrayLikeToArray(e,o){(null==o||o>e.length)&&(o=e.length);for(var n=0,a=new Array(o);n<o;n++)a[n]=e[n];return a}function _iterableToArrayLimit(e,o){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,r=!1,t=void 0;try{for(var l,i=e[Symbol.iterator]();!(a=(l=i.next()).done)&&(n.push(l.value),!o||n.length!==o);a=!0);}catch(e){r=!0,t=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw t}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}app.controller("loja",["$scope","$rootScope","$http","$location","config","$routeParams","$route",function(t,n,o,e,l,i,a){var c=["email_cliente","nome_cliente","fone_cliente","endereco1"];t.job={bairro:null,cep:null,cidade:null,complemento:null,cpf:null,cnpj:null,razao_social:null,nome_fantasia:null,dh_agendamento_cliente:null,duracao_atendimento:null,email:null,email_cliente:null,endereco1:null,estado:null,fone:null,id_pedido:null,latitude:null,logradouro:null,longitude:null,nome:null,nome_cliente:null,numero:null,qtd_servico:null,servicos_comprados:null,tipo_pessoa:void 0,token:null,total_compra:null},t.get_geolocalizacao=function(){n.get_geolocation(t.job,t)},t.get=function(e){o({url:l.base_url+"/loja/agendamento?token="+escape(e.token)+"&sig="+escape(e.sig),method:"GET"}).success(function(e,o){t.job=Object.assign(t.job,e.dados),function(e){var o=e.split("\n");t.job.servicos_comprados=[];for(var n=0;n<o.length;n++)t.job.servicos_comprados.push(o[n].split("x ",-1))}(t.job.servicos_comprados),t.job.nome=e.dados.nome_cliente,t.job.email=e.dados.email_cliente,t.job.fone=e.dados.fone_cliente?e.dados.fone_cliente.replace(/[^\d]/g,""):"",t.job.tipo_pessoa=t.job.razao_social?"juridica":"fisica",t.job.cep=t.job.cep?t.job.cep.replace(/[^\d]/g,""):"",n.busca_cep(t.job.cep,t.job,"numero")}).error(function(e,o){t.agendamento=[],n.mostra_mensagem_nova({status:"erro",icone:"bad.svg",titulo:"Algo deu errado.",mensagem:e.erro,url_destino:l.loja[l.app_mode].url})})},t.configura_msg=function(){var e=new Date(t.job.dh_agendamento_cliente),o=["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"][e.getDay()];t.confirmacao_msg="Deseja agendar este atendimento para "+o+", "+e.toLocaleString()+"?"},t.grava=function(){var a,r,e=t.job;a=e,r=c,Object.entries(a).forEach(function(e){var o=_slicedToArray(e,2),n=o[0];o[1],0<=r.indexOf(n)&&delete a[n]}),e=a,o({url:l.base_url+"/loja/agendamento?token="+escape(i.token)+"&sig="+escape(i.sig),method:"POST",data:e}).success(function(e,o){t.job=[],n.mostra_mensagem_nova({status:"sucesso",titulo:e.msg,icone:"good.svg",url_destino:l.loja[l.app_mode].url})}).error(function(e,o){n.mostra_mensagem_nova({status:"erro",icone:"bad.svg",titulo:"Algo deu errado.",mensagem:e.erro})})},"/loja/agendamento"==a.current.originalPath&&t.get(i)}]);
"use strict";app.controller("orientacao",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(r,a,n,o,e,t,i){r.orientacoes=[],r.clientes=[],r.filtros={},r.init_orientacao=function(){r.orientacao={}},r.lista=function(o){var t=a.otimiza_filtro(o);n({url:e.base_url+"/orientacao/lista",method:"POST",data:t}).success(function(o,t){r.orientacoes=o}).error(function(o,t){r.orientacoes=[],a.erro_portal(o,t)})},r.adiciona=function(o){n({url:e.base_url+"/orientacao",method:"POST",data:o}).success(function(o,t){a.adiciona_historico(o,t),r.init_orientacao()}).error(function(o,t){a.erro_portal(o,t)})},r.altera_status=function(o){n({url:e.base_url+"/orientacao/"+o.id+"/status",method:"PUT"}).success(function(o,t){a.adiciona_historico(o,t),r.lista(r.filtros)}).error(function(o,t){a.erro_portal(o,t)})},r.altera=function(i){n({url:e.base_url+"/orientacao/"+i.id,method:"PUT",data:i}).success(function(o,t){a.adiciona_historico(o,t),r.get(i.id)}).error(function(o,t){a.erro_portal(o,t)})},r.remove=function(o){var t=o.orientacao;n({url:e.base_url+"/orientacao/"+t.id,method:"DELETE"}).success(function(o,t){a.adiciona_historico(o,t),r.lista(r.filtros)}).error(function(o,t){a.erro_portal(o,t)})},r.get=function(o){n({url:e.base_url+"/orientacao/"+o,method:"GET"}).success(function(o,t){r.orientacao=o}).error(function(o,t){a.erro_portal(o,t)})},r.lista_cliente=function(){n({url:e.base_url+"/cliente/lista",method:"POST",data:{status:"ativo"}}).success(function(o,t){o.splice(0,0,{id:void 0,nome_cliente:"SELECIONE"}),r.clientes=o}).error(function(o,t){r.cliente=[],a.erro_portal(o,t)})},"/orientacao"==t.current.originalPath&&r.lista_cliente(),"/orientacao/:id_orientacao"==t.current.originalPath&&r.get(i.id_orientacao),"/orientacao/adiciona"==t.current.originalPath&&(r.lista_cliente(),r.init_orientacao())}]);
"use strict";app.controller("orientacao_padrao",["$scope","$rootScope","$http","$location","config","$routeParams",function(r,a,e,o,t,n){r.altera=function(o){e({url:t.base_url+"/orientacao_padrao",method:"PUT",data:o}).success(function(o,e){a.adiciona_historico(o,e),r.get()}).error(function(o,e){a.erro_portal(o,e)})},r.get=function(){e({url:t.base_url+"/orientacao_padrao",method:"GET"}).success(function(o,e){switch(n.forma_atendimento){case"presencial":r.forma_atendimento="Presencial",r.projeto={rat:o.rat_presencial,requerimento:o.requerimento_presencial,orientacoes:o.orientacoes_presencial};break;case"remoto":r.forma_atendimento="Remoto",r.projeto={rat:o.rat_remoto,requerimento:o.requerimento_remoto,orientacoes:o.orientacoes_remoto};break;default:r.orientacao_padrao=o}}).error(function(o,e){r.orientacao_padrao={},r.projeto={},a.erro_portal(o,e)})},r.get()}]);
"use strict";app.controller("pendencia",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(a,o,r,n,c,e,i){a.pendencias=[],a.lista=function(n){var e=o.otimiza_filtro(n);r({url:c.base_url+"/pendencia/lista",method:"POST",data:e}).success(function(n,e){a.pendencias=n}).error(function(n,e){a.pendencias=[],o.erro_portal(n,e)})},a.adiciona=function(n){r({url:c.base_url+"/pendencia",method:"POST",data:n}).success(function(n,e){o.adiciona_historico(n,e),a.pendencia={}}).error(function(n,e){o.erro_portal(n,e)})},a.detalha=function(n){r({url:c.base_url+"/pendencia/"+n,method:"GET"}).success(function(n,e){a.pendencia=n}).error(function(n,e){o.erro_portal(n,e)})},a.altera=function(i){r({url:c.base_url+"/pendencia/"+i.id,method:"PUT",data:i}).success(function(n,e){o.adiciona_historico(n,e),a.detalha(i.id)}).error(function(n,e){o.erro_portal(n,e)})},a.remove=function(n){var e=n.pendencia;r({url:c.base_url+"/pendencia/"+e.id,method:"DELETE"}).success(function(n,e){o.adiciona_historico(n,e),a.lista(a.filtros)}).error(function(n,e){o.erro_portal(n,e)})},"/pendencia/:id_pendencia"==e.current.originalPath&&a.detalha(i.id_pendencia),"/pendencia/adiciona"==e.current.originalPath&&(a.pendencia={})}]);
"use strict";app.controller("permissao",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(a,n,u,o,e,r,i){var t=i.id_grupo;a.get=function(){a.grupo={},u({url:e.base_url+"/grupo/"+t,method:"GET"}).success(function(o,r){a.grupo=o}).error(function(o,r){n.erro_portal(o,r)}),a.lista()},a.lista=function(){a.funcionalidade=[],a.permissao_grupo=[];u({url:e.base_url+"/funcionalidade/lista",method:"POST",data:{menu:"S"}}).success(function(o,r){a.funcionalidade=o;var i={id_grupo:t};u({url:e.base_url+"/permissao_grupo/lista",method:"POST",data:i}).success(function(o,r){a.permissao_grupo=o,a.permissao_grupo.filter(function(i){return a.funcionalidade.filter(function(o){if(o.id==i.id_funcionalidade){var r=a.funcionalidade.indexOf(o);a.funcionalidade.splice(r,1)}})})}).error(function(o,r){404!=r&&n.erro_portal(o,r)})}).error(function(o,r){404!=r&&n.erro_portal(o,r)})},a.adiciona=function(o){u({url:e.base_url+"/permissao_grupo",method:"POST",data:{id_grupo:t,id_funcionalidade:o.id}}).success(function(o,r){n.adiciona_historico(o,r),a.lista(t)}).error(function(o,r){n.erro_portal(o,r)})},a.deleta=function(o){u({url:e.base_url+"/permissao_grupo/"+o.id,method:"DELETE"}).success(function(o,r){n.adiciona_historico(o,r),a.lista()}).error(function(o,r){n.erro_portal(o,r)})},a.get(t)}]);
"use strict";function _createForOfIteratorHelper(o){if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(o=_unsupportedIterableToArray(o))){var t=0,e=function(){};return{s:e,n:function(){return t>=o.length?{done:!0}:{done:!1,value:o[t++]}},e:function(o){throw o},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,i=!0,n=!1;return{s:function(){a=o[Symbol.iterator]()},n:function(){var o=a.next();return i=o.done,o},e:function(o){n=!0,r=o},f:function(){try{i||null==a.return||a.return()}finally{if(n)throw r}}}}function _unsupportedIterableToArray(o,t){if(o){if("string"==typeof o)return _arrayLikeToArray(o,t);var e=Object.prototype.toString.call(o).slice(8,-1);return"Object"===e&&o.constructor&&(e=o.constructor.name),"Map"===e||"Set"===e?Array.from(o):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(o,t):void 0}}function _arrayLikeToArray(o,t){(null==t||t>o.length)&&(t=o.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=o[e];return a}app.controller("relatorio",["$scope","$http","$rootScope","config","$location","$timeout","$route","$routeParams",function(d,l,s,c,o,t,e,a){d.tipo_custo="ciclo",d.relatorio=[],d.tipos_servicos=[],d.relatorio_vendas=[],d.faturamento_antigo_novo={},d.pendencias_supporter=[],d.total_jobs_relatorio=0,d.total_atendimentos_relatorio=0,d.filtros={},d.filtro_otimizado={},d.filtro_analise_jobs={},d.reseta_relatorio=function(){d.relatorio_cadastro_doutores={},d.relatorio_divulgacao={}},d.trimestres=["1º Trimestre","2º Trimestre","3º Trimestre","4º Trimestre"],d.meses=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],d.campos_extrato_pagamento_doutor=["id_doutor","nome_doutor","cpf","razao_social","cnpj","nome_banco","tipo_conta","codigo_banco","agencia_banco","dv_agencia_banco","conta_banco","dv_conta_banco","operacao_conta","total_pagamento","titular_conta","email_doutor"],d.relatorio_qtds_cadastro_doutores=function(o){d.relatorio_cadastro_doutores={total_doutores:0,total_doutores_com_pendencia:0},o.forEach(function(o){d.relatorio_cadastro_doutores.total_doutores+=o.total_doutores,d.relatorio_cadastro_doutores.total_doutores_com_pendencia+=o.total_doutores_com_pendencia})},d.relatorio_extrato_custos=function(o){d.qtds_relatorio_extrato_custos={qtd_jobs:0,atendimentos:0,qtd_doutor:0,total_pagamentos:0},o.forEach(function(o){d.qtds_relatorio_extrato_custos.qtd_jobs+=o.qtd_jobs,d.qtds_relatorio_extrato_custos.atendimentos+=o.qtd_atendimento,d.qtds_relatorio_extrato_custos.qtd_doutor+=o.qtd_doutor,d.qtds_relatorio_extrato_custos.total_pagamentos+=o.total_geral_ciclo})},d.detalha_pendencias_doutor=function(o,t){t.id_doutor=o;var e=s.otimiza_filtro(t);l({url:c.base_url+"/relatorio/operacao/pendencia_doutor/detalha",method:"POST",data:e}).success(function(o,t){d.pendencias_supporter=o}).error(function(o,t){d.pendencias_supporter=[],s.erro_portal(o,t)})},d.lista_entrega_vendas=function(o){var t=s.otimiza_filtro(o);l({url:c.base_url+"/relatorio/vendas",method:"POST",data:t}).success(function(o,t){d.relatorio_vendas=o,d.filtra_relatorio()}).error(function(o,t){s.erro_portal(o,t)})},d.filtra_relatorio=function(o){var t;(o&&(o.pendencia&&(d.filtro.pendencia="T"!=o.pendencia?o.pendencia:""),o.etapa&&(d.filtro.etapa=o.etapa)),0!=d.relatorio_vendas.length)&&(d.qtd_vendas=0,d.qtd_jobs=0,d.qtd_valor=0,d.relatorio_vendas_filtradas=[],d.relatorio_vendas.filter(function(o){0<=o.etapa.indexOf(d.filtro.etapa)&&(""!=d.filtro.pendencia?(t=angular.isArray(o.pendencia[d.filtro.etapa])?0<o.pendencia[d.filtro.etapa].length:o.pendencia[d.filtro.etapa],"S"==d.filtro.pendencia&&t?(d.qtd_jobs=d.qtd_jobs+o.jobs,d.qtd_valor=d.qtd_valor+o.valor,d.relatorio_vendas_filtradas.push(o)):"N"!=d.filtro.pendencia||t||(d.qtd_jobs=d.qtd_jobs+o.jobs,d.qtd_valor=d.qtd_valor+o.valor,d.relatorio_vendas_filtradas.push(o))):(d.qtd_jobs=d.qtd_jobs+o.jobs,d.qtd_valor=d.qtd_valor+o.valor,d.relatorio_vendas_filtradas.push(o)))}),d.qtd_vendas=d.relatorio_vendas_filtradas.length)},d.filtra_cobertura=function(o){d.cidades_cobertura=0,o.filter(function(o){1<=o.cobertura_total&&d.cidades_cobertura++}),d.cidades_cobertura_percentual=(d.cidades_cobertura/o.length*100).toFixed(2)},d.lista_historico_entrega_vendas=function(o,e){d.venda_numero=o,d.historico_entrega_vendas=[],l({url:c.base_url+"/relatorio/vendas/"+o+"/atendimentos",method:"GET"}).success(function(o,t){e&&o.filter(function(o){0<=e.indexOf(o.job)&&(o.com_pendencia=!0)}),d.historico_entrega_vendas=o}).error(function(o,t){s.erro_portal(o,t)})},d.get_clientes=function(){l({url:c.base_url+"/cliente/lista",method:"POST"}).success(function(o,t){d.clientes=o}).error(function(o,t){d.clientes=[],s.erro_portal(o,t)})},d.get_projetos=function(o){if(o!=[]){var t=s.get_ids(o);l({url:c.base_url+"/cliente_cliente",method:"POST",data:t}).success(function(o,t){o.filter(function(o){d.projetos.push(o)})}).error(function(o,t){d.projetos=[],s.erro_portal(o,t)})}},d.check_ano=!0,d.check_trimestre=!0,d.mostra_atendimento=!0,d.lista_margem_contribuicao=function(o){var t=_.cloneDeep(o);t.id_cliente=s.get_ids(t.clientes),delete t.clientes,l({url:c.base_url+"/relatorio/financeiro/margem_contribuicao",method:"POST",data:t}).success(function(o,t){d.relatorio_margem=o}).error(function(o,t){s.erro_portal(o,t)})},d.relatorio_demografico=function(){l({url:c.base_url+"/relatorio/demografico",method:"GET"}).success(function(o,t){o.porcentagem_homens=parseFloat(100*o.total_homens/o.total_doutores).toFixed(1),o.porcentagem_mulheres=parseFloat(100*o.total_mulheres/o.total_doutores).toFixed(1),o.porcentagem_pcd=parseFloat(100*o.total_pcd/o.total_doutores).toFixed(1),d.demografico=o;var e=document.getElementById("grafico").getContext("2d"),a=(new Chart(e,{type:"bar",data:{labels:["# Supporters","# Candidatos","# Cidades","# Estados","# Homens","# Mulheres","# PCD"],datasets:[{label:"Quantidades Totais",data:[o.total_doutores,o.total_candidatos,o.total_cidades,o.total_estados,o.total_homens,o.total_mulheres,o.total_pcd],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}),document.getElementById("grafico2").getContext("2d")),r=(new Chart(a,{type:"pie",data:{labels:["% Homens","% Mulheres"],datasets:[{label:"Proporção Homem Mulheres",data:[o.porcentagem_homens,o.porcentagem_mulheres],backgroundColor:["rgba(75, 192, 192, 0.2)","rgba(255, 99, 132, 0.2)"],hoverBackgroundColor:["rgba(75, 192, 192, 1)","rgba(255, 99, 132, 0.2)"]}]},options:{responsive:!0,tooltips:{enabled:!1,custom:s.custom_tooltip("%")}}}),document.getElementById("grafico3").getContext("2d"));new Chart(r,{type:"pie",data:{labels:["% PCD","% PSD"],datasets:[{label:"Proporção Pessoas Com Deficiência / Pessoas Sem Deficiência",data:[o.porcentagem_pcd,100-o.porcentagem_pcd],backgroundColor:["rgba(75, 192, 192, 0.2)","rgba(255, 99, 132, 0.2)"],hoverBackgroundColor:["rgba(75, 192, 192, 1)","rgba(255, 99, 132, 0.2)"]}]},options:{responsive:!0,tooltips:{enabled:!1,custom:s.custom_tooltip("%")}}})}).error(function(o,t){d.demografico={},s.erro_portal(o,t)})},d.gera_divulgacao_jobs=function(o){var t=s.otimiza_filtro(o);l({url:c.base_url+"/relatorio/divulgacao_jobs",method:"POST",data:t}).success(function(o,t){d.relatorio_divulgacao_consolidado={jobs_total:0,jobs_divulgados:0,jobs_direta:0},o.forEach(function(o){d.relatorio_divulgacao_consolidado.jobs_total+=o.total_jobs,d.relatorio_divulgacao_consolidado.jobs_divulgados+=o.total_divulgado,d.relatorio_divulgacao_consolidado.jobs_direta+=o.total_jobs}),d.relatorio_divulgacao=o}).error(function(o,t){d.relatorio_divulgacao=o,s.erro_portal(o,t)})},d.gera_relatorio=function(o,t,e){s.seta_gravar(!0),d.reseta_relatorio();var a,r=_.cloneDeep(o);if(r.periodo_selecionado&&_.extend(r,s.get_inicio_fim(r.periodo_selecionado)),r.data_inicio&&(r.data_inicio=moment(r.data_inicio).format("YYYY-MM-DD")),r.data_fim&&(r.data_fim=moment(r.data_fim).format("YYYY-MM-DD")),r.status){for(var i=[],n=0;n<r.status.length;n++)i.push(r.status[n].valor);delete r.status,r.status=i}a=_.isEmpty(r)?"":"?"+$.param(r),l({url:c.base_url+"/relatorio"+t+a,method:"GET"}).success(function(o,t){s.seta_gravar(!1),e&&e(o),d.relatorio=o}).error(function(o,t){s.seta_gravar(!1),d.relatorio=[],s.erro_portal(o,t)})},d.gera_relatorio_post=function(o,t,e){var a=_.cloneDeep(o);if(a.periodo_selecionado&&(_.extend(a,s.get_inicio_fim(a.periodo_selecionado)),delete a.periodo_selecionado),a.data_inicio&&(a.data_inicio=moment(a.data_inicio).format("YYYY-MM-DD")),a.data_fim&&(a.data_fim=moment(a.data_fim).format("YYYY-MM-DD")),a.status){for(var r=[],i=0;i<a.status.length;i++)r.push(a.status[i].valor);delete a.status,a.status=r}if(a.tipo_servico){for(r=[],i=0;i<a.tipo_servico.length;i++)r.push(a.tipo_servico[i].nome1);delete a.tipo_servico,a.tipo_servico=r}a.id_cliente||delete a.id_cliente,(a.qtd_doutor<0||null==a.qtd_doutor)&&delete a.qtd_doutor,a.minimo_doutor||delete a.minimo_doutor,a.populacao_minima||delete a.populacao_minima,l({url:c.base_url+"/relatorio"+t,method:"POST",data:a}).success(function(o,t){e&&e(o),d.relatorio=o,$("#btn-gera-csv").prop("disabled",!1)}).error(function(o,t){d.relatorio=[],s.erro_portal(o,t)})},d.relatorio_analise_jobs=function(o,t,e){var a=_.cloneDeep(o);a.tipo_data&&(a.data_inicio&&(a["data_"+a.tipo_data+"_inicial"]=moment(a.data_inicio).format("YYYY-MM-DD")),a.data_fim&&(a["data_"+a.tipo_data+"_final"]=moment(a.data_fim).format("YYYY-MM-DD"))),delete a.data_inicio,delete a.data_fim,d.gera_relatorio_post(a,t,e)},d.gera_csv_analise_job=function(t,o){var e,a="ID Job, Código Cliente, Contato Supporter, Nome Supporter, Cliente, cliente do Cliente, GD, Tipo serviço, Status, Local, Atend, Abertura, Atendimento, Fechamento\n",r=_createForOfIteratorHelper(d.relatorio);try{for(r.s();!(e=r.n()).done;){t=e.value,Object.keys(t).forEach(function(o){t[o]=t[o]||" "}),a+=t.id_job+","+t.codigo_chamado_cliente+","+t.contato_doutor+","+t.nome_doutor+","+t.nome_cliente+","+t.nome_cliente_cliente+","+t.nome_gestor+","+t.nome_tipo_servico+","+t.status_job+","+t.cidade+","+t.total_atendimentos_job+","+t.dh_abertura+","+t.dh_atendimento+","+t.dh_fechamento+"\n"}}catch(o){r.e(o)}finally{r.f()}return encodeURIComponent(a)},d.gera_csv_financeiro=function(t){var o,e="ID, Nome, Emaill, CPF, Razao Social, CNPJ, Banco, Titular da Conta, Tipo, Código, Agência, DV, Conta, Operação, Valor\n",a=_createForOfIteratorHelper(d.relatorio.pagamentos);try{for(a.s();!(o=a.n()).done;){t=o.value,Object.keys(t).forEach(function(o){t[o]=t[o]||" "});var r=t.cpf.replace(/(.{3})(.{3})(.{3})(.{1,2})/,"$1.$2.$3-$4"),i=t.cnpj.replace(/(.{2})(.{3})(.{3})(.{4})(.{1,2})/,"$1.$2.$3/$4-$5"),n=t.conta_banco.replace(/\B(?=(\d{3})+(?!\d))/g,"."),l=t.total_pagamento.toFixed(2).replace(".",".").replace(/(\d)(?=(\d{3})+\,)/g,"$1.");e+=t.id_doutor+","+t.nome_doutor+","+t.email_doutor+","+r+","+t.razao_social+","+i+","+t.nome_banco+","+t.titular_conta+","+t.tipo_conta+","+t.codigo_banco+","+t.agencia_banco+","+t.dv_agencia_banco+","+n+"-"+t.dv_conta_banco+","+t.operacao_conta+","+l+"\n"}}catch(o){a.e(o)}finally{a.f()}return encodeURIComponent(e)},d.gera_relatorio_otimizado=function(o,t,e){l({url:c.base_url+"/relatorio"+t,method:"POST",data:s.otimiza_filtro(o)}).success(function(o,t){e&&e(o),d.relatorio=o}).error(function(o,t){d.relatorio=[],s.erro_portal(o,t)})},d.lista_cliente=function(){l({url:c.base_url+"/cliente/lista",method:"POST"}).success(function(o,t){o.splice(0,0,{id:void 0,nome_cliente:"SELECIONE"}),d.clientes=o}).error(function(o,t){d.clientes=[],s.erro_portal(o,t)})},d.lista_tipo_servico=function(){l({url:c.base_url+"/tipo_servico/distinto",method:"GET"}).success(function(o,t){o.splice(0,0,{nome1:void 0,nome2:"SELECIONE"}),d.tipos_servicos=o}).error(function(o,t){d.tipos_servicos=[],s.erro_portal(o,t)})},d.detalha_faturamento_antigo_novo=function(o){l({url:c.base_url+"/relatorio/financeiro/fechamento_antigo/"+o,method:"GET"}).success(function(o,t){d.faturamento_antigo_novo=o}).error(function(o,t){d.faturamento_antigo_novo={},s.erro_portal(o,t)})},d.lista_gestor=function(e){l({url:c.base_url+"/funcionario/lista",method:"POST",data:{id_grupo:3}}).success(function(o,t){e||o.splice(0,0,{id:void 0,nome:"SELECIONE"}),d.gestor_demanda=o}).error(function(o,t){d.gestor_demanda=[],s.erro_portal(o,t)})},d.lista_cidade_brasil=function(o){l({url:c.base_url+"/cidade_brasil",method:"POST",data:{estado:o}}).success(function(o,t){o.splice(0,0,{id:void 0,cidade:"SELECIONE"}),d.cidade_brasil=o}).error(function(o,t){s.erro_portal(o,t),d.cidade_brasil=[]})},d.lista_busca_doutor=function(o){var t=s.otimiza_filtro(o);l({url:c.base_url+"/doutor/lista",method:"POST",data:t}).success(function(o,t){d.doutores=o}).error(function(o,t){d.doutores=[],s.erro_portal(o,t)})},d.seleciona_doutor=function(o){o.selecionado?(o.selecionado=!1,d.filtros.id_doutor=null,d.filtro_otimizado.id_doutor=null,d.doutor_selecionado=""):(d.doutores.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,d.filtros.id_doutor=o.id,d.filtro_otimizado.id_doutor=o.id,d.doutor_selecionado=o.nome)},d.lista_busca_cliente=function(o){var t=s.otimiza_filtro(o);l({url:c.base_url+"/cliente/lista",method:"POST",data:t}).success(function(o,t){d.clientes=o}).error(function(o,t){d.clientes=[],s.adiciona_historico("Cliente Inativo ou não encontrado. Não é possível cadastrar jobs.",t)})},d.seleciona_cliente=function(o){o.selecionado?(o.selecionado=!1,d.filtros.id_cliente=null,d.cliente_selecionado=""):(d.clientes.filter(function(o){return o.selecionado=!1}),o.selecionado=!0,d.filtros.id_cliente=o.id,d.cliente_selecionado=o.nome_cliente)},"/relatorio/operacao/atendimento/supporter"==e.current.originalPath&&(d.lista_tipo_servico(),d.lista_cliente()),"/relatorio/operacao/analise_job"==e.current.originalPath&&(d.lista_tipo_servico(),d.lista_gestor()),e.current.originalPath,"/relatorio/margem_contribuicao"==e.current.originalPath&&d.get_clientes(),"/relatorio/demografico"==e.current.originalPath&&d.relatorio_demografico(),"/relatorio/financeiro/previsao_pagamento"==e.current.originalPath&&d.gera_relatorio("","/financeiro/previsao_pagamento",function(o){d.total_pagamentos_programados=0,d.total_pagamentos_atrasados=0,d.total_pagamentos_pendentes=0,d.total_pagamentos=0;var t,e,a,r,i,n,l,s,c=document.getElementById("grafico").getContext("2d");new Chart(c,{type:"bar",data:{labels:(l=o,s=[],l.forEach(function(o){s.push(inverte_data(o.dt_previsao_pagamento,"-","/"))}),s),datasets:[{label:"Programados",data:(i=o,n=[],i.forEach(function(o){n.push(o.total_pagamento),d.total_pagamentos_programados+=o.total_pagamento,d.total_pagamentos+=o.total_pagamento}),n),backgroundColor:"blue",stack:"background"},{label:"Projeção",data:(a=o,r=[],a.forEach(function(o){r.push(o.total_pendente),d.total_pagamentos_pendentes+=o.total_pendente,d.total_pagamentos+=o.total_pendente}),r),backgroundColor:"yellow",stack:"background"},{label:"Atrasados",data:(t=o,e=[],t.forEach(function(o){e.push(o.atrasados),d.total_pagamentos_atrasados+=o.atrasados,d.total_pagamentos+=o.atrasados}),e),backgroundColor:"red",stack:"background"}]},options:{scales:{yAxes:[{stacked:!0,ticks:{beginAtZero:!0}}],xAxes:[{stacked:!0}]},legend:{position:"bottom"}}})})}]);
"use strict";app.controller("sso",["$scope","$routeParams","$rootScope","$window",function(o,s,r,a){var i=r.usuario_logado.url+"/portal/sso/discourse?sso="+s.sso+"&sig="+s.sig;a.location.href=i}]);
"use strict";app.controller("tipo_servico",["$scope","$rootScope","$http","$location","config","$route","$routeParams",function(r,e,s,o,c,i,t){r.tipo_servicos=[],r.especialidades=[],r.limpa_filtros=function(){r.filtros={}},r.init_tipo_servico=function(){r.tipo_servico={}},r.lista=function(o){var i=e.otimiza_filtro(o);s({url:c.base_url+"/tipo_servico/lista",method:"POST",data:i}).success(function(o,i){r.tipo_servicos=o}).error(function(o,i){r.tipo_servicos=[],e.erro_portal(o,i)})},r.adiciona=function(o){s({url:c.base_url+"/tipo_servico",method:"POST",data:o}).success(function(o,i){e.adiciona_historico(o,i),r.init_tipo_servico()}).error(function(o,i){e.erro_portal(o,i)})},r.get=function(o){s({url:c.base_url+"/tipo_servico/"+o,method:"GET"}).success(function(o,i){r.tipo_servico=o}).error(function(o,i){e.erro_portal(o,i)})},r.altera=function(t){s({url:c.base_url+"/tipo_servico/"+t.id,method:"PUT",data:t}).success(function(o,i){e.adiciona_historico(o,i),r.get(t.id)}).error(function(o,i){e.erro_portal(o,i)})},r.desativa=function(o){var i=o.id_tipo_servico;s({url:c.base_url+"/tipo_servico/"+i,method:"DELETE"}).success(function(o,i){e.adiciona_historico(o,i),r.lista(r.filtros)}).error(function(o,i){e.erro_portal(o,i)})},r.ativa=function(o){s({url:c.base_url+"/tipo_servico/"+o+"/status",method:"PUT"}).success(function(o,i){e.adiciona_historico(o,i),r.lista(r.filtros)}).error(function(o,i){e.erro_portal(o,i)})},r.lista_especialidade=function(t){s({url:c.base_url+"/especialidade/lista",method:"POST"}).success(function(o,i){t&&o.splice(0,0,{id:void 0,nome:"SELECIONE"}),r.especialidades=o}).error(function(o,i){r.especialidades=[],e.erro_portal(o,i)})},r.lista_base_custo=function(t){s({url:c.base_url+"/base_custo/lista",method:"POST"}).success(function(o,i){t&&o.splice(0,0,{id:void 0,nome:"SELECIONE"}),r.bases_custo=o}).error(function(o,i){e.erro_portal(o,i)})},r.reseta_duracao_alocacao=function(){"atendimento"==r.tipo_servico.tipo&&(r.tipo_servico.duracao_alocacao=1,r.tipo_servico.duracao_folga="00:00")},r.reseta_valor_deslocamento=function(){0<=["variavel","zero"].indexOf(r.tipo_servico.tipo_deslocamento)&&(r.tipo_servico.valor_deslocamento_fixo=0)},r.lista_base_custo(!0),r.lista_especialidade(!0),r.init_tipo_servico(),"/tipo_servico/:id_tipo_servico"==i.current.originalPath&&r.get(t.id_tipo_servico)}]);
"use strict";app.controller("usuario",["$scope","$rootScope","$http","$location","config","$routeParams","$route",function(i,s,t,o,u,a,r){i.usuarios=[],i.init=function(){i.usuario2={nome:null,login:null}},i.lista=function(o){var a=s.otimiza_filtro(o);t({url:u.base_url+"/usuario/lista",method:"POST",data:a}).success(function(o,a){i.usuarios=o}).error(function(o,a){s.erro_portal(o,a)})},i.adiciona=function(o){t({url:u.base_url+"/usuario",method:"POST",data:o}).success(function(o,a){s.adiciona_historico(o,a),i.usuario2={}}).error(function(o,a){s.erro_portal(o,a)})},i.detalha=function(o){t({url:u.base_url+"/usuario/"+o,method:"GET"}).success(function(o,a){i.usuario2=o}).error(function(o,a){s.erro_portal(o,a)})},i.altera=function(r){t({url:u.base_url+"/usuario/"+r.id,method:"PUT",data:r}).success(function(o,a){s.adiciona_historico(o,a),i.detalha(r.id)}).error(function(o,a){s.erro_portal(o,a)})},i.desativa=function(o){var a=o.id_usuario;t({url:u.base_url+"/usuario/"+a,method:"DELETE"}).success(function(o,a){s.adiciona_historico(o,a),i.lista()}).error(function(o,a){s.erro_portal(o,a)})},i.ativa=function(o){t({url:u.base_url+"/usuario/"+o+"/status",method:"PUT"}).success(function(o,a){s.adiciona_historico(o,a),i.lista()}).error(function(o,a){s.erro_portal(o,a)})},i.altera_senha=function(r){r.nova_senha==r.confirma_nova_senha?(s.seta_gravar(!0),delete r.confirma_nova_senha,t({url:u.base_url+"/usuario/senha",method:"PUT",data:r}).success(function(o,a){s.seta_gravar(!1),s.adiciona_historico(o,a),r={}}).error(function(o,a){s.seta_gravar(!1),s.erro_portal(o,a)})):s.adiciona_historico(data,403)},i.reseta_senha=function(o){o.nova_senha==o.confirma_nova_senha?(o.token=i.token,t({url:u.base_url+"/usuario/reseta_senha",method:"POST",data:o}).success(function(o,a){s.mostra_mensagem("sucesso",o.msg,[{url_destino:"https://nssupport.netsupport.com.br",titulo:"Login"}])}).error(function(o,a){s.mostra_mensagem("erro",o.msg),i.usuario2={}})):s.adiciona_historico("As senhas não são iguais.",403)},"/usuario/:id_usuario"==r.current.originalPath&&i.detalha(a.id_usuario),"/usuario/reseta_senha/:token"==r.current.originalPath&&(i.token=a.token)}]);
//# sourceMappingURL=app.js.map
